<html>
<head>
  <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=harmony:egal&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="http://wiki.ecmascript.org/feed.php?mode=list&amp;ns=harmony" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=harmony:egal&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=harmony:egal&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="robots" content="noindex,nofollow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />
</head>
<body>
<div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=harmony:egal&amp;do=export_html.html#object.is_x_y" class="toc">Object.is(x, y)</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=harmony:egal&amp;do=export_html.html#is_and_isnt_operators" class="toc">is and isnt operators</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=harmony:egal&amp;do=export_html.html#rationale" class="toc">Rationale</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=harmony:egal&amp;do=export_html.html#open_issues" class="toc">Open Issues</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=harmony:egal&amp;do=export_html.html#references" class="toc">References</a></span></li>
</ul>
</div>
</div>

<p>
 This page is obsoleted by specification language in the latest <a href="doku.php%3Fid=harmony:specification_drafts.html" class="wikilink1" title="harmony:specification_drafts" onclick="return svchk()" onkeypress="return svchk()">specification drafts</a> for ES6. <code>Object.is</code> is in ES6, but <code>is</code> and <code>isnt</code> operators were deferred by TC39 (possibly forever, mainly on the theory of YAGNI).
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2013/12/23 04:12</em>
</p>

<a name="object.is_x_y"></a><h1>Object.is(x, y)</h1>
<div class="level1">

<p>
 An egal function simply makes available the internal SameValue function from section 9.12 of the ES5 spec. If two values are egal, then they are not observably distinguishable. Egal can be <a href="http://code.google.com/searchframe#wBZsFl6bRv8/trunk/src/com/google/caja/ses/repairES5.js" class="urlextern" target="_blank" title="http://code.google.com/searchframe#wBZsFl6bRv8/trunk/src/com/google/caja/ses/repairES5.js" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">coded</a> as <code>Object.is</code> in ES5 as follows:
</p>
<pre class="code javascript">Object.<span class="me1">defineProperty</span><span class="br0">&#40;</span>Object, <span class="st0">'is'</span>, <span class="br0">&#123;</span>
  value: <span class="kw2">function</span><span class="br0">&#40;</span>x, y<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>x === y<span class="br0">&#41;</span> <span class="br0">&#123;</span>
      <span class="co1">// 0 === -0, but they are not identical</span>
      <span class="kw1">return</span> x !== <span class="nu0">0</span> || <span class="nu0">1</span> <span class="re0">/ x === <span class="nu0">1</span> /</span> y;
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// NaN !== NaN, but they are identical.</span>
    <span class="co1">// NaNs are the only non-reflexive value, i.e., if x !== x,</span>
    <span class="co1">// then x is a NaN.</span>
    <span class="co1">// isNaN is broken: it converts its argument to number, so</span>
    <span class="co1">// isNaN(&quot;foo&quot;) =&gt; true</span>
    <span class="kw1">return</span> x !== x &amp;&amp; y !== y;
  <span class="br0">&#125;</span>,
  configurable: <span class="kw2">true</span>,
  enumerable: <span class="kw2">false</span>,
  writable: <span class="kw2">true</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span>;</pre>
<p>
New collection operations that look up values based on equality should use egal rather than <code>===</code>. It was an unfortunate price of legacy compatibility that ES5&rsquo;s <code>Array.prototype.indexOf</code> and <code>lastIndexOf</code> look up by <code>===</code> rather than egal. The result is that a <code>NaN</code> in an array cannot be found. In the absence of legacy compatibility constraints, we will avoid repeating this mistake.
</p>

<p>
The above implementation produces the same results as the ES 5 SamveValue Algorithm (9.12).  The actual specification should be expressed in terms of SameValue to make it clear that this is the same test as used at other places in the specification.
</p>

</div>
<!-- SECTION [304-1836] -->
<a name="is_and_isnt_operators"></a><h1>is and isnt operators</h1>
<div class="level1">

<p>
 The following restricted-production right-hand sides are added to <em>EqualityExpression</em>, and with the necessary changes, to <em>EqualityExpressionNoIn</em>:
</p>
<pre class="code">
EqualityExpression :
    . . .
    EqualityExpression [no LineTerminator here] is RelationalExpression
    EqualityExpression [no LineTerminator here] isnt RelationalExpression
</pre>

<p>
Thus, <code>is</code> and <code>isnt</code> are contextual keywords, not reserved in Harmony. No well-formed program can be affected by this change, due to the <em>[no LineTerminator here]</em> restriction.
</p>

<p>
The expression <code>x is y</code> is equivalent to the desugared expression <code>Object.is(x, y)</code> using the original value of <code>Object.is</code>.
</p>

<p>
The expression <code>x isnt y</code> is equivalent to the desugared expression <code>!Object.is(x, y)</code> using the original value of <code>Object.is</code>.
</p>

</div>
<!-- SECTION [1837-2672] -->
<a name="rationale"></a><h1>Rationale</h1>
<div class="level1">

<p>
 We achieved consensus to promote egal from strawman to proposal at the November 2010 meeting. The proposal now contains concrete syntax and naming. Rationale: 
</p>
<ul>
<li class="level1"><div class="li"> <code>Object.is(x, y)</code> as above, to match the operator <code>is</code>.</div>
</li>
<li class="level1"><div class="li"> <code>eq</code> is not a word, smells of FORTRAN, and has an ugly inverse name <code>neq</code>.</div>
</li>
<li class="level1"><div class="li"> Operators for usability are important (see the decimal discussion).</div>
</li>
<li class="level1"><div class="li"> Inverse operator for usability too, to avoid the <code>if (!(obj instanceof Constructor)) ...</code> awkwardness.</div>
</li>
<li class="level1"><div class="li"> A quadruple = (<code>====</code>) operator is an equal sign too far</div>
</li>
<li class="level1"><div class="li"> Aside from geek cred, there is no usability or teaching win in using the name <code>egal</code>.</div>
</li>
<li class="level1"><div class="li"> <code>identical</code> is too long for an operator, and the <code>Object</code> name should match.</div>
</li>
</ul>

</div>
<!-- SECTION [2673-3426] -->
<a name="open_issues"></a><h1>Open Issues</h1>
<div class="level1">
<ul>
<li class="level1"><div class="li"> Should there be an <code>Object.isnt</code> method?</div>
</li>
<li class="level1"><div class="li"> Given the operators, do we need the <code>Object</code> methods?</div>
</li>
</ul>

<p>
 Comments welcome.
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2011/05/11 20:03</em>
</p>

<p>
My thoughts on how to resolve these: 
</p>
<ul>
<li class="level1"><div class="li"> Yes, we should have an <code>Object.isnt</code> method too. See next bullet.</div>
</li>
<li class="level1"><div class="li"> Yes, methods are good for version-free/downrev (<acronym title="JavaScript">JS</acronym>-in-reality) script usage guarded by method-detection.</div>
</li>
</ul>

<p>
  &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2011/05/31 20:55</em>
</p>

</div>
<!-- SECTION [3427-3928] -->
<a name="references"></a><h1>References</h1>
<div class="level1">

<p>
 Henry Baker&rsquo;s <a href="http://home.pipeline.com/~hbaker1/ObjectIdentity.html" class="urlextern" target="_blank" title="http://home.pipeline.com/~hbaker1/ObjectIdentity.html" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">Equal Rights for Functional Objects  or, The More Things Change, The More They Are the Same</a>
</p>

</div>
<!-- SECTION [3929-] -->
<!-- cachefile /usr/local/www/es-lang.org/wiki/data/cache/3/3ff1ec41e699c951821957c79b75f86b.xhtml used -->
</body>
</html>
