<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <title>meetings:minutes_jul_19_2007 [ES Wiki]</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=meetings:minutes_jul_19_2007&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=meetings" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=meetings:minutes_jul_19_2007&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=meetings:minutes_jul_19_2007&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="date" content="2007-07-23T16:41:23+0000" />
  <meta name="robots" content="index,follow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />

  <link rel="shortcut icon" href="lib/images/favicon.ico" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/layout.css" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/design.css" />

  
  <link rel="stylesheet" media="print" type="text/css" href="lib/tpl/default/print.css" />

  <!--[if gte IE 5]>
  <style type="text/css">
    /* that IE 5+ conditional comment makes this only visible in IE 5+ */
    /* IE bugfix for transparent PNGs */
    //DISABLED   img { behavior: url("/lib/scripts/pngbehavior.htc"); }
  </style>
  <![endif]-->

  </head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="doku.php%3Fid=meetings:minutes_jul_19_2007&amp;do=backlink.html" onclick="return svchk()" onkeypress="return svchk()">meetings:minutes_jul_19_2007</a>]]
      </div>
      <div class="logo">
        <a href="doku.php%3Fid=.html" onclick="return svchk()" onkeypress="return svchk()" name="top" accesskey="h" title="[ALT+H]">ES Wiki</a>      </div>
    </div>
  
    
    <div class="bar" id="bar_top">
      <div class="bar-left" id="bar_topleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="meetings:minutes_jul_19_2007" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="meetings:minutes_jul_19_2007" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
  
      <div class="bar-right" id="bar_topright">
        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="recent" /><input type="hidden" name="id" value="" /><input type="submit" value="Recent changes" class="button" title="ALT+R" accesskey="r" /></form>        <form action="doku.php%3Fid=.html" accept-charset="utf-8" class="search" name="search" onsubmit="return svchk()"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch_in" accesskey="f" name="id" class="edit" onkeyup="ajax_qsearch.call('qsearch_in','qsearch_out')" /><input type="submit" value="Search" class="button" /><div id="qsearch_out" class="ajax_qsearch" onclick="this.style.display='none'"></div></form>&nbsp;
      </div>
    </div>

        <div class="breadcrumbs">
      Trace: <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_aug_21_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_aug_21_2007">minutes_aug_21_2007</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_aug_16_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_aug_16_2007">minutes_aug_16_2007</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_jul_31_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_jul_31_2007">minutes_jul_31_2007</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_jul_24_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_jul_24_2007">minutes_jul_24_2007</a> <span class="bcsep">&raquo;</span> <span class="curid"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_jul_19_2007">minutes_jul_19_2007</a></span>          </div>
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#meeting_19_20_july_2007_at_yahoo" class="toc">Meeting 19 &amp; 20 July 2007, at Yahoo!</a></span><ul class="toc">
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#attendees" class="toc">Attendees</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#agenda" class="toc">Agenda</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#notes" class="toc">Notes</a></span><ul class="toc">
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#arrays" class="toc">arrays</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#json" class="toc">JSON</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#various_date_tickets" class="toc">Various Date tickets</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#type_issues" class="toc">Type issues</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#type_issues_continued" class="toc">Type Issues (continued)</a></span></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<a name="meeting_19_20_july_2007_at_yahoo"></a><h1>Meeting 19 &amp; 20 July 2007, at Yahoo!</h1>
<div class="level1">
<pre class="code"> Yahoo! Inc.
 Building E
 700 First Avenue
 Sunnyvale, CA 94089</pre>

<p>
 <a href="http://maps.yahoo.com/#mvt=m&amp;q1=700+First+Avenue%2C+Sunnyvale%2C+CA&amp;trf=0&amp;lon=-122.024953&amp;lat=37.416118&amp;mag=3" class="urlextern" target="_blank" title="http://maps.yahoo.com/#mvt=m&amp;q1=700+First+Avenue%2C+Sunnyvale%2C+CA&amp;trf=0&amp;lon=-122.024953&amp;lat=37.416118&amp;mag=3" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">http://maps.yahoo.com/#mvt=m&amp;q1=700+First+Avenue%2C+Sunnyvale%2C+CA&amp;trf=0&amp;lon=-122.024953&amp;lat=37.416118&amp;mag=3</a>
</p>

<p>
Dinner 6:30 Thursday at Kabul (<a href="http://www.kabulrestaurant.net/" class="urlextern" target="_blank" title="http://www.kabulrestaurant.net/" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">http://www.kabulrestaurant.net/</a>). Please RSVP to crock@yahoo-inc.com
</p>

</div>

<a name="attendees"></a><h2>Attendees</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Douglas Crockford, Yahoo!</div>
</li>
<li class="level1"><div class="li"> Lars T Hansen, Adobe</div>
</li>
<li class="level1"><div class="li"> Francis Cheng, Adobe</div>
</li>
<li class="level1"><div class="li"> Jeff Dyer, Adobe</div>
</li>
<li class="level1"><div class="li"> Allen Wirfs-Brock, Microsoft</div>
</li>
<li class="level1"><div class="li"> Pratap Lakshman, Microsoft</div>
</li>
<li class="level1"><div class="li"> Chris Pine, Opera</div>
</li>
<li class="level1"><div class="li"> Cormac Flanagan, UCSC</div>
</li>
<li class="level1"><div class="li"> Brendan Eich, Mozilla</div>
</li>
</ul>

</div>

<a name="agenda"></a><h2>Agenda</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> [Lars] Arrays (<a href="http://bugs.ecmascript-lang.org/ticket/66" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/66" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">66</a>, <a href="http://bugs.ecmascript-lang.org/ticket/68" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/68" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">68</a>, <a href="http://bugs.ecmascript-lang.org/ticket/69" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/69" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">69</a>, <a href="http://bugs.ecmascript-lang.org/ticket/120" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/120" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">120</a>).  See <a href="doku.php%3Fid=proposals:arrays.html" class="wikilink1" title="proposals:arrays" onclick="return svchk()" onkeypress="return svchk()">the arrays proposal page</a>.</div>
</li>
<li class="level1"><div class="li"> <a href="doku.php%3Fid=proposals:json_encoding_and_decoding.html" class="wikilink1" title="proposals:json_encoding_and_decoding" onclick="return svchk()" onkeypress="return svchk()">JSON</a>, notably its interaction with namespaces, if any, and any lingering discussion about APIs.  Please create tickets if necessary.</div>
</li>
<li class="level1"><div class="li"> [Lars] Various Date tickets (<a href="http://bugs.ecmascript-lang.org/ticket/129" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/129" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">129</a>, <a href="http://bugs.ecmascript-lang.org/ticket/130" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/130" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">130</a>, <a href="http://bugs.ecmascript-lang.org/ticket/131" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/131" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">131</a>, <a href="http://bugs.ecmascript-lang.org/ticket/133" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/133" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">133</a>, <a href="http://bugs.ecmascript-lang.org/ticket/134" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/134" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">134</a>, <a href="http://bugs.ecmascript-lang.org/ticket/135" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/135" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">135</a>, <a href="http://bugs.ecmascript-lang.org/ticket/136" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/136" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">136</a>). See also <a href="doku.php%3Fid=proposals:date_and_time.html" class="wikilink1" title="proposals:date_and_time" onclick="return svchk()" onkeypress="return svchk()">the date and time proposal</a>.</div>
</li>
<li class="level1"><div class="li"> [Cormac] Tickets <a href="http://bugs.ecmascript-lang.org/ticket/96" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/96" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">96</a>, <a href="http://bugs.ecmascript-lang.org/ticket/120" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/120" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">120</a>, <a href="http://bugs.ecmascript-lang.org/ticket/121" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/121" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">121</a>, <a href="http://bugs.ecmascript-lang.org/ticket/122" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/122" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">122</a>, <a href="http://bugs.ecmascript-lang.org/ticket/127" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/127" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">127</a> on various type system issues.</div>
</li>
<li class="level1"><div class="li"> [Lars] Dict.  See <a href="doku.php%3Fid=proposals:dictionary.html" class="wikilink1" title="proposals:dictionary" onclick="return svchk()" onkeypress="return svchk()">the dictionary proposal page</a>.</div>
</li>
<li class="level1"><div class="li"> [Francis] Which version of <a href="doku.php%3Fid=proposals:update_unicode.html" class="wikilink1" title="proposals:update_unicode" onclick="return svchk()" onkeypress="return svchk()">Unicode</a> are we planning to support? Latest seems to be <a href="http://unicode.org/versions/Unicode5.0.0/" class="urlextern" target="_blank" title="http://unicode.org/versions/Unicode5.0.0/" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">Unicode 5.0.0</a>.</div>
</li>
<li class="level1"><div class="li"> Graydon&rsquo;s <a href="http://bugs.ecmascript-lang.org/ticket/113" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/113" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">ticket 113</a> about <code>int</code> and similar types converting from <code>*</code>.</div>
</li>
<li class="level1"><div class="li"> Go through other <a href="http://bugs.ecmascript-lang.org/report/3" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/report/3" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">active tickets by milestone</a>.</div>
</li>
<li class="level1"><div class="li"> Are monotyped and non-monotyped arrays compatible? Has implications for cost of compatibility checks.</div>
</li>
</ul>

</div>

<a name="notes"></a><h2>Notes</h2>
<div class="level2">

</div>

<a name="arrays"></a><h3>arrays</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Idea is to keep changes simple. Add a typed array, called &lsquo;array&rsquo; vs. &lsquo;Array&rsquo;, that has additional semantics. Namely, allow for dense arrays and eliminate the prototype.</div>
</li>
<li class="level1"><div class="li"> Specifying two or more types (tuple) creates a fixed length array. There is a read-only fixture named &lsquo;fixed&rsquo; in the array class, which is writable if one type (or *) is specified. Example is [i, x] = [int, string] is a tuple of fixed length 2. If you do []:[int], you get a array that is not fixed length.</div>
</li>
<li class="level1"><div class="li"> Jason&rsquo;s syntax suggestion is to go with int[] instead of [int], which allows you to have a single-typed tuple. On the other hand, a one-tuple is not useful.</div>
</li>
<li class="level1"><div class="li"> Error messages: If you index below zero or beyond length, you get an exception (regardless of the value of fixed)</div>
</li>
<li class="level1"><div class="li"> A = [1, x]:[int, string], then A[0] is type int.</div>
</li>
<li class="level1"><div class="li"> Might be helpful to have a separate AST node to distinguish single versus multiple tuple.</div>
</li>
<li class="level1"><div class="li"> Complexity budget analysis. Do we want this added complexity. Folks are already using Array to do things that would be much simpler to do with (small-cap) array. This shifts the burden to lang implementors (and us). This would also resolve a number of open questions about our structural type system.</div>
</li>
<li class="level1"><div class="li"> Open issues (see <a href="doku.php%3Fid=proposals:arrays.html#open_issues" class="wikilink1" title="proposals:arrays" onclick="return svchk()" onkeypress="return svchk()">array proposal page</a> for all open issues). What about the generic methods from Array? All Array methods should be able transferred to array, perhaps optimized. On the other hand, should it be called &lsquo;array&rsquo; at all? Could make it nameless, or call it vector. The array class will be final and nondynamic. Argument for &lsquo;array&rsquo; is that it is consistent with the &lsquo;string&rsquo; and &lsquo;String&rsquo; classes.</div>
</li>
<li class="level1"><div class="li"> BE brings up issue about default sort comparison is string comparison. This causes slowdown when sorting numbers, and is especially noticeable in benchmark tests. Making default sort type aware would be desirable. BE will add this to the proposal page.</div>
</li>
<li class="level1"><div class="li"> CF brings up asymmetry. [int, string, int] &lt;: [int,string]. However, [int, string] is not &lt;: [int], but the following is true [int, string] &lt;: [*].</div>
</li>
<li class="level1"><div class="li"> LTH: what about [int, string] &lt;: Array. AWB brings up that subtype relationship is not clear. CF thinks that it&rsquo;s clear that there is not a subtype relationship.</div>
</li>
<li class="level1"><div class="li"> BE: So if we say that subtype relationship doesn&rsquo;t exist, there should not be inheritance? LTH says this is an open issue.</div>
</li>
<li class="level1"><div class="li"> JD: Bothered by inconsistency of [int] meaning something so different from [int,string].</div>
</li>
<li class="level1"><div class="li"> So how will sort work with array. Say you call sort() on [int, string, int]. Could be a runtime error?</div>
</li>
<li class="level1"><div class="li"> Asymmetry between adding/deleting elements? Why is that necessary? LTH will update the proposal to clarify the meaning.</div>
</li>
<li class="level1"><div class="li"> Will this class have a prototype object? This is an open issue. Last meeting we talked about having a shared prototype for array and Array.</div>
</li>
<li class="level1"><div class="li"> naming: array vs. vector. Several TG1 members favor vector because it reduces confusion with Array. BE is less enthusiastic because in common usage, vector means monotyped array, not multi-typed tuple.</div>
</li>
</ul>

</div>

<a name="json"></a><h3>JSON</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> namespaced enumerable properties.</div>
<ul>
<li class="level3"><div class="li"> Could use :: but servers might not like it. DC: JSON wants to be lang neutral.</div>
</li>
<li class="level3"><div class="li"> BE: What if we just throw an error. DC: That, or just give people an opportunity to filter the names out. </div>
</li>
<li class="level3"><div class="li"> BE: Could skip namespaces.</div>
</li>
<li class="level3"><div class="li"> RESOLVED: JSON encoding will skip namespaces.</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Date syntax. People expect <acronym title="International Organization for Standardization">ISO</acronym> format.</div>
</li>
<li class="level2"><div class="li"> SAX-like non-blocking/incremental <acronym title="Application Programming Interface">API</acronym> (discussion deferred)</div>
</li>
<li class="level2"><div class="li"> toJSON. We are only doing toJSONString methods.</div>
</li>
</ul>

</div>

<a name="various_date_tickets"></a><h3>Various Date tickets</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> <a href="http://bugs.ecmascript-lang.org/ticket/129" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/129" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">129</a>, RESOLVED: approved and assigned.</div>
</li>
<li class="level2"><div class="li"> <a href="http://bugs.ecmascript-lang.org/ticket/130" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/130" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">130</a>, RESOLVED: approved and assigned.</div>
</li>
<li class="level2"><div class="li"> PL: asks about nanoage rationale. LTH: Early request from discussion list. AWB: Why not just add a Timer class? BE: we&rsquo;re trying to restrict spec to basic functionality, not adding full libraries.</div>
</li>
<li class="level2"><div class="li"> <a href="http://bugs.ecmascript-lang.org/ticket/131" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/131" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">131</a>, This ticket tracks specific incompatibilities with various date formats.</div>
</li>
<li class="level2"><div class="li"> <a href="http://bugs.ecmascript-lang.org/ticket/133" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/133" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">133</a>, RESOLVED: approved and assigned.</div>
</li>
<li class="level2"><div class="li"> <a href="http://bugs.ecmascript-lang.org/ticket/134" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/134" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">134</a>, RESOLVED: approved and assigned.</div>
</li>
<li class="level2"><div class="li"> <a href="http://bugs.ecmascript-lang.org/ticket/135" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/135" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">135</a>, RESOLVED: remove restriction. Approved and assigned.</div>
</li>
<li class="level2"><div class="li"> <a href="http://bugs.ecmascript-lang.org/ticket/136" class="urlextern" target="_blank" title="http://bugs.ecmascript-lang.org/ticket/136" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">136</a>  RESOLVED: remove restriction. Approved and assigned.</div>
</li>
</ul>

</div>

<a name="type_issues"></a><h3>Type issues</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> Type system issues</div>
</li>
</ul>

<p>
 Type annotations on properties specified in structural object type only checks for compatible types when assignment with structural type happens, but does not otherwise constrain type of property.
</p>
<pre class="code javascript">type I = <span class="br0">&#123;</span>getIter:<span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span>: J<span class="br0">&#125;</span>
type J = <span class="br0">&#123;</span>next, <span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span>: *<span class="br0">&#125;</span>
&nbsp;
Array.<span class="me1">prototype</span>.<span class="me1">getIter</span> = <span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span>: J <span class="br0">&#123;</span><span class="kw2">var</span> self = <span class="kw1">this</span>; <span class="kw2">var</span> i= <span class="nu0">0</span>;
                                      <span class="kw1">return</span> <span class="br0">&#123;</span>next: <span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="kw1">return</span> <span class="br0">&#40;</span>i &lt; self.<span class="me1">length</span><span class="br0">&#41;</span>
                                                                        ? self<span class="br0">&#91;</span>i++<span class="br0">&#93;</span>
                                                                        : undefined <span class="br0">&#125;</span>
                                              <span class="br0">&#125;</span>
                                      <span class="br0">&#125;</span>
&nbsp;
a = <span class="br0">&#91;</span><span class="nu0">0</span>, <span class="nu0">1</span>, <span class="nu0">2</span>, <span class="nu0">5</span>, <span class="nu0">4</span><span class="br0">&#93;</span>
<span class="kw1">for</span> <span class="br0">&#40;</span>let i <span class="kw1">in</span> a<span class="br0">&#41;</span>
&nbsp;
<span class="br0">&#40;</span>a to I<span class="br0">&#41;</span>.<span class="me1">getIter</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">is</span> J</pre>
<p>
LTH:  
</p>
<pre class="code javascript"><span class="kw1">if</span> <span class="br0">&#40;</span>x <span class="kw1">is</span> <span class="br0">&#123;</span> equals:<span class="kw2">function</span><span class="br0">&#40;</span>k<span class="br0">&#41;</span>:boolean <span class="br0">&#125;</span> <span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw2">var</span> x : <span class="br0">&#123;</span>y:A<span class="br0">&#125;</span> = <span class="br0">&#123;</span>y : <span class="kw2">new</span> B<span class="br0">&#125;</span></pre>
<p>
LTH: given assignment, meaning of y&rsquo;s type annotation means only that B must be compatible with A, but it does not mean that there is a type constraint on y when accessed later.
</p>

<p>
BE:
</p>
<pre class="code javascript">x.<span class="me1">y</span> = <span class="kw2">new</span> C <span class="co1">// (where C !&lt;: A and C! ~~&gt;A and this is not known to Strict mode) OK</span>
<span class="kw3">print</span> <span class="br0">&#40;</span>x.<span class="me1">y</span><span class="br0">&#41;</span>  <span class="co1">// RB (Read Barrier)</span>
x = <span class="br0">&#123;</span>y: <span class="kw2">new</span> C<span class="br0">&#125;</span> <span class="co1">// BAD </span>
&nbsp;</pre>
<p>
LTH: We should come up with a set of use cases.
</p>

<p>
Use cases:
</p>

<p>
 1. There exists a method in this object... (need to figure out when and where; get a contains?)
</p>

<p>
 2. Shape testing, eg.  
</p>
<pre class="code javascript">  <span class="kw1">switch</span> type <span class="br0">&#40;</span>v<span class="br0">&#41;</span> 
&nbsp;
    <span class="kw1">case</span> <span class="br0">&#40;</span><span class="br0">&#123;</span>p:int,
           q:<span class="br0">&#123;</span>r:string,
              s:boolean<span class="br0">&#125;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>...<span class="br0">&#125;</span>
    <span class="kw2">default</span> <span class="br0">&#123;</span>...<span class="br0">&#125;</span>
&nbsp;</pre>
<p>
JD example: 
</p>
<pre class="code javascript">type MULTINAME =
   <span class="br0">&#123;</span> nss:
&nbsp;
<span class="br0">&#91;</span><span class="br0">&#91;</span><span class="kw2">NAMESPACE</span><span class="br0">&#93;</span><span class="br0">&#93;</span>
     , id: string <span class="br0">&#125;</span>
<span class="kw2">function</span> lookup<span class="br0">&#40;</span>mname:MULTINAME<span class="br0">&#41;</span>...</pre>
<p>
 <strong>Friday, July 20</strong>
</p>

</div>

<a name="type_issues_continued"></a><h3>Type Issues (continued)</h3>
<div class="level3">

<p>
 Take the following function:
</p>
<pre class="code">
function f (p : {x:int} ) {
    return g(p);
}

f({})
</pre>

<p>
What happens when f is called?
</p>
<ul>
<li class="level1"><div class="li"> current plan is that no error occurs because parameter is compatible with untyped object</div>
</li>
<li class="level1"><div class="li"> JD wants an error in this case.</div>
</li>
</ul>

<p>
 CF: What if x is a getter?
</p>
<pre class="code">f ( {get x():* {return &quot;x&quot;} } )
f ( {get x():string {return &quot;x&quot;} } )</pre>

<p>
<strong>USE CASES:</strong>
</p>
<ol>
<li class="level1"><div class="li"> There is a method...</div>
</li>
<li class="level1"><div class="li"> shape testing</div>
</li>
<li class="level1"><div class="li"> Typed interfaces, untyped code</div>
</li>
<li class="level1"><div class="li"> Avoid performance traps</div>
</li>
<li class="level1"><div class="li"> Typo finding in the callee (by restriction) (analogy 2/ &lsquo;reformed with&rsquo;)</div>
</li>
<li class="level1"><div class="li"> f({...});  f( new C )</div>
</li>
<li class="level1"><div class="li"> Check reads &amp; writes deeply</div>
</li>
</ol>

<p>
Important issue is that comprehensive type verification could be very costly wrt performance.
</p>

<p>
What some implementors do is targeted (or ad hoc) type verification to avoid performance hit but still provide some measure of type checking.
</p>

<p>
AWB: another use case is tooling or IDE support, eg. Microsoft Intellisense.
</p>

<p>
 CF: I see 3 design options, though there may be more
</p>
<ol>
<li class="level1"><div class="li"> No structural object types</div>
</li>
<li class="level1"><div class="li"> Structural object types but no &lsquo;deep&rsquo; checking on untyped objects (note: no check on entry for untyped objects)</div>
</li>
<li class="level1"><div class="li"> Structural object types and &lsquo;deep&rsquo; checking</div>
</li>
</ol>

<p>
 LTH : time dimension is not included in above options, on storage and on access. use case 5 is not covered by any of these 3 options.
</p>

<p>
BE : other dimensions to consider
</p>
<ul>
<li class="level1"><div class="li"> time</div>
</li>
<li class="level1"><div class="li"> strict/standard</div>
</li>
<li class="level1"><div class="li"> deep</div>
</li>
<li class="level1"><div class="li"> wide</div>
</li>
</ul>

<p>
 LTH: One of the main use cases suggested by use case 3 is the interaction between existing prototype code and new typed code.
</p>

<p>
PL: read barrier may be required to safely interop with untyped code that could possibly mutate the type on a value.
</p>

<p>
CF: A related issue is if you pass in an untyped array when the formal parameter calls for a typed array, do we check the entire array?
</p>

<p>
LTH: structural objects will usually be smaller than arrays, because generally used as ad hoc interfaces, so the overhead is less of a factor than it is with arrays. We should add this, however, as a topic for further discussion.
</p>

<p>
LTH: Here&rsquo;s a proposal, we solve use cases 1-4 in standard mode, and use case 5 in strict mode. Check type when you write, not when you read. 
</p>

<p>
CP: Rationale is that you are catching the error earlier.
</p>

<p>
CF: One issue with this proposal is that it would be nice to have check on read when concurrent modification occurs.
</p>

<p>
LTH: I&rsquo;m arguing that you are talking about a research issue, and we don&rsquo;t have the luxury to consider it given our time frame.
</p>

<p>
CF: Is there any way to leave some wiggle room in the spec so that an implementor could opt to include checks on read.
</p>

<p>
BE: Could lead to interoperability problems
</p>

<p>
JD: What I&rsquo;d like to have is a type system that guarantees a type on read. I&rsquo;d rather defer than have a weak guarantee.
</p>

<p>
LTH: Another way of looking at my proposal is that given
</p>
<pre class="code">
function f (p : { x:int } ) {
    p.x // not type checking here
}
</pre>

<p>
The formal parameter is saying something only about the structural object p, namely that there is an object p that has a property x of type int. Consequently, we only type check when we write a value to p.x as we do when we bind the argument value to p when f() is called. We are not saying anything about the property x itself.
</p>

<p>
JD: So is this future proof with the possibility that we can one day solve this research problem.
</p>

<p>
BE: I&rsquo;m more concerned with the present than the future. We may find that there is no use case for solving the research problem.
</p>

<p>
LTH: The MochiKit use case:
</p>
<pre class="code">type ArrayLike = { slice: function (...): *, length: uint }

f ( x: ArrayLike)
</pre>

<p>
BE: better done using array structural types, probably.
</p>

<p>
PL: the type checker will enforce type invariance in the following case:   
</p>
<pre class="code">
function f(p: { x : int} ) {
  g(p);
}
 
f( { } )
</pre>

<p>
 <strong> BREAK FOR LUNCH </strong>
</p>

<p>
CF: We could restrict deep checking to function entry and exit.
</p>

<p>
BE: why do that if it&rsquo;s a small difference to support the same meaning for other uses of type annotation syntax? 
</p>
<hr noshade="noshade" size="1" />

<p>
Array questions relating to runtime types and conversions:
</p>

<p>
LTH:
</p>
<pre class="code">
fun f (xs: [int]) {
    
}

f (new [double]) // makes no sense
f ([1, 2, 3 ])   // makes no sense

g (xs:Array) {...}  // makes sense
g (new [int] )      // makes sense
g (new [*] )        // makes sense
</pre>

<p>
Brendan argued that <code>f([1,2,3])</code> makes a lot of sense because the syntax is coveted. It may be more desired for tuples than homogeneous arrays. We ended up talking about whether it could be supported (some open source implementations optimize <code>Array</code> for the dense, natural-property-order case already into something like a <code>vector</code>). Not clear where this ended up, but it may &ldquo;make sense&rdquo; yet.  &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2007/07/20 18:06</em> 
</p>
<hr noshade="noshade" size="1" />

<p>
Lars has written up his proposal in the clarification namespace as <a href="doku.php%3Fid=clarification:runtime_types_and_conversions.html#solution_9write_barrier_with_deep_checking" class="wikilink1" title="clarification:runtime_types_and_conversions" onclick="return svchk()" onkeypress="return svchk()">Solution 9 Write Barrier with deep checking</a> 
</p>
<hr noshade="noshade" size="1" />

<p>
Discussion about merging solution 9 into solution 8 &ndash; needs to be captured properly.  Essentially, solution-9 like checking at function interfaces (covers the use case), but solution-8 like checking elsewhere. 
</p>
<hr noshade="noshade" size="1" />

<p>
Cormac: In some sense, solution 9 is more about contracts than types.
</p>

<p>
That is an interesting point, and in some sense it sounds like maybe we are moving towards contracts for structural annotations and types for nominal annotations.
</p>

<p>
A further observation: structural object type annotations on interfaces, nominally-typed or untyped object instances passed and returned, complement one another:
</p>
<ul>
<li class="level1"><div class="li"> We expect (use case 3) much client code to remain untyped, forever.</div>
</li>
<li class="level1"><div class="li"> We know of nominal native and AS3 types today, and expect some nominal ES4 library object types tomorrow.</div>
</li>
<li class="level1"><div class="li"> If you have structural type annotations but nominal actual objects, the invariants preserved by the nominal type system reinforce solution 9 making it equivalent to solution 8 for this combination.</div>
</li>
<li class="level1"><div class="li"> If you have typed object initialisers (we don&rsquo;t expect a lot of these, but the syntax is there), ditto by virtue of the write barrier.</div>
</li>
<li class="level1"><div class="li"> If you have (legacy or not) untyped object instances flowing through the write barrier at interface boundaries, you&rsquo;re at least better off in terms of type checking than today&rsquo;s untyped world, where e.g. MochiKit must do shape testing with a few method and property probes (see isArrayLike, isDateLike in MochiKit.Base).</div>
</li>
<li class="level1"><div class="li"> If you don&rsquo;t want the cost of shape-checking (deep type checking) at the interface boundaries, don&rsquo;t use type annotations there, or provide typed library objects (factories) and promote them as better-performing than untyped objects. People use what&rsquo;s faster (see Array.prototype.join being used instead of += for string concatenation).</div>
</li>
</ul>

<p>
 &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2007/07/20 17:44</em>
</p>

<p>
<strong>Decision</strong>: Solution 9, possibly with some extra syntax to allow the user to specify that a check should be done (Allen&rsquo;s suggestion, something like <code>verify x</code>; Lars&rsquo;s solution, something like <code>x=x</code>)..
</p>
<hr noshade="noshade" size="1" />

<p>
More type tickets:  
</p>
<ul>
<li class="level1"><div class="li"> Ticket 96: resolved; moved to RefImpl.</div>
</li>
<li class="level1"><div class="li"> Ticket 121: resolved; moved to RefImpl.</div>
</li>
<li class="level1"><div class="li"> Ticket 127: remains open, Cormac/Dave/Jason to discuss it.</div>
</li>
</ul>

<p>
 Self types proposal:
</p>

<p>
BE: &ldquo;this&rdquo; is not a good type name, people get confused and it is not parallel to the meaning of <code>this</code> in object initialisers (the value syntax; <code>this</code> means the global object for global code, or the function&rsquo;s receiver object for function code). Cormac&rsquo;s <code>Self</code> or <code>self</code> lexical binding within object structural types seems best (I vote for <code>self</code>).
</p>

<p>
There may be a grand unified theory of self typing that heals the rift between bound-<code>this</code> class methods and unbound-<code>this</code> functions, but it&rsquo;s not in sight. The case for <code>this:self</code> is there, but weaker than the case for <code>arg:self</code> for <code>equals</code> methods, and <code>function():self</code> for <code>clone</code> and <code>iterator::get</code> methods. Cormac to explore in micro.sml.
</p>

</div>

<!-- no cachefile used, but created -->
    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
      <div class="doc">
        meetings/minutes_jul_19_2007.txt &middot; Last modified: 2007/07/23 16:41 by fcheng      </div>
    </div>

   
    <div class="bar" id="bar_bottom">
      <div class="bar-left" id="bar_bottomleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="meetings:minutes_jul_19_2007" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="meetings:minutes_jul_19_2007" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
      <div class="bar-right" id="bar_bottomright">
                        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="login" /><input type="hidden" name="id" value="meetings:minutes_jul_19_2007" /><input type="submit" value="Login" class="button" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="index" /><input type="hidden" name="id" value="meetings:minutes_jul_19_2007" /><input type="submit" value="Index" class="button" title="ALT+X" accesskey="x" /></form>        <a href="doku.php%3Fid=meetings:minutes_jul_19_2007.html#top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" /></a>&nbsp;
      </div>
    </div>

  </div>

</div>

<div align="center" class="footerinc">
  <a target="_blank" href="feed.php" title="Recent changes RSS feed"><img src="lib/tpl/default/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="license" title="Creative Commons License"><img src="lib/tpl/default/images/button-cc.gif" width="80" height="15" alt="Creative Commons License" border="0" /></a>

  <a target="_blank" href="https://www.paypal.com/xclick/business=andi%40splitbrain.org&amp;item_name=DokuWiki+Donation&amp;no_shipping=1&amp;no_note=1&amp;tax=0&amp;currency_code=EUR&amp;lc=US" title="Donate"><img src="lib/tpl/default/images/button-donate.gif" alt="Donate" border="0" /></a>

  <a target="_blank" href="http://www.php.net" title="Powered by PHP"><img src="lib/tpl/default/images/button-php.gif" width="80" height="15" alt="Powered by PHP" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="lib/tpl/default/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="lib/tpl/default/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="lib/tpl/default/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>



<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->
</div>

<img src="lib/exe/indexer.php%3Fid=meetings%253Aminutes_jul_19_2007&amp;1454275520" width="1" height="1" alt=""  /></body>
</html>
