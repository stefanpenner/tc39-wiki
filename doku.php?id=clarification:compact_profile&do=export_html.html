<html>
<head>
  <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=clarification:compact_profile&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=clarification" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=clarification:compact_profile&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=clarification:compact_profile&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="robots" content="noindex,nofollow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />
</head>
<body>
<div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=clarification:compact_profile&amp;do=export_html.html#motivation" class="toc">Motivation</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=clarification:compact_profile&amp;do=export_html.html#prior_work" class="toc">Prior work</a></span><ul class="toc">
<li class="level2"><span class="li"><a href="doku.php%3Fid=clarification:compact_profile&amp;do=export_html.html#ecmascript_3rd_edition_compact_profile" class="toc">ECMAScript 3rd Edition Compact Profile</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=clarification:compact_profile&amp;do=export_html.html#open_mobile_alliance_ecmascript_mobile_profile" class="toc">Open Mobile Alliance &quot;ECMAScript Mobile Profile&quot;</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=clarification:compact_profile&amp;do=export_html.html#how_useful_is_3rd_edition_compact_profile" class="toc">How useful is 3rd Edition Compact Profile?</a></span></li>
</ul>
</li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=clarification:compact_profile&amp;do=export_html.html#compact_profile_for_4th_edition" class="toc">Compact Profile for 4th Edition</a></span></li>
</ul>
</div>
</div>

<a name="motivation"></a><h1>Motivation</h1>
<div class="level1">

<p>
 A compact profile is motivated by the need to run ECMAScript programs on very small machines, with these constraining factors: 
</p>
<ul>
<li class="level1"><div class="li"> memory: maybe a few hundreds of kilobytes of RAM available to the scripting engine</div>
</li>
<li class="level1"><div class="li"> footprint: there is constrained space for the code of the engine (including built-in libraries)</div>
</li>
<li class="level1"><div class="li"> performance: these are devices in the range of 100MHz-400MHz with small caches and slow memories</div>
</li>
</ul>

<p>
 A compact profile only makes sense if it is <strong>useful</strong>: It must support enough of the language to meet the needs of the programmers.  This is difficult, because programmers tend not to read specs, nor to allow themselves to be constrained by needs they have not seen or customers they have not met.  They will tend to use all facilities available.
</p>

</div>
<!-- SECTION [1-792] -->
<a name="prior_work"></a><h1>Prior work</h1>
<div class="level1">

</div>
<!-- SECTION [793-818] -->
<a name="ecmascript_3rd_edition_compact_profile"></a><h2>ECMAScript 3rd Edition Compact Profile</h2>
<div class="level2">

<p>
 Edition 3 defined a compact profile (ECMA-327) that addressed these concerns by defining a subset language that left out the <code>eval</code> operator and the <code>Function</code> constructor (thus obviating the need for compiling ECMAScript code on the device itself, thereby saving memory for the compilation, footprint for the compiler, and the time to compile the code) and defined system objects as read-only (thus allowing them to be shared between different document contexts).  In addition the <code>with</code> statement did not have to supported, and along with the absence of <code>eval</code> this would allow scope chains to be represented more efficiently.
</p>

</div>
<!-- SECTION [819-1508] -->
<a name="open_mobile_alliance_ecmascript_mobile_profile"></a><h2>Open Mobile Alliance &quot;ECMAScript Mobile Profile&quot;</h2>
<div class="level2">

<p>
 This is ECMAScript Compact Profile with the addition of versioning properties on some objects, among other things: in other words, an extended subset of ECMAScript 3rd edition.
</p>

</div>
<!-- SECTION [1509-1748] -->
<a name="how_useful_is_3rd_edition_compact_profile"></a><h2>How useful is 3rd Edition Compact Profile?</h2>
<div class="level2">

<p>
 It&rsquo;s not useful in practice on the public web.  Opera has been looking at the demographics in the scripts on the web.  With the caveat that I don&rsquo;t know entirely how representative the following numbers are, I note that of a population of scripts from 420000 web pages:
</p>
<ul>
<li class="level1"><div class="li"> 21% use <code>eval</code></div>
</li>
<li class="level1"><div class="li"> 18% use <code>with</code></div>
</li>
<li class="level1"><div class="li"> 22% use <code>arguments</code></div>
</li>
<li class="level1"><div class="li"> 11% use exception handling</div>
</li>
</ul>

<p>
A reasonable conclusion would be that a large fraction of the web would not work in a browser supporting only Compact Profile.
</p>

<p>
We&rsquo;ve instead chosen to implement the full language, and optimize the implementation heavily.  This is costly but it works in practice, in 3rd Edition.
</p>

</div>
<!-- SECTION [1749-2454] -->
<a name="compact_profile_for_4th_edition"></a><h1>Compact Profile for 4th Edition</h1>
<div class="level1">

<p>
 Leaving aside for the moment whether we should have a compact profile, here are some initial thoughts about what we could/should do for 4th edition.
</p>

<p>
From the programmer&rsquo;s point of view, language or library subsetting is a poor choice, and he will submit to using a subset only if he knows his target platform.  Most authors for the web cannot be expected to follow this discipline.
</p>

<p>
From the implementor&rsquo;s point of view the following aspects of language and library are no good because they make the implementation complex or reduce the number of choices: 
</p>
<ul>
<li class="level1"><div class="li"> Supporting multiple incompatible language dialects and libraries</div>
</li>
<li class="level1"><div class="li"> Large standard libraries</div>
</li>
<li class="level1"><div class="li"> A rich, non-orthogonal language</div>
</li>
<li class="level1"><div class="li"> Language features requiring run-time interpretation</div>
</li>
<li class="level1"><div class="li"> Language features requiring full ASTs to be built (3rd edition plus E4X can be compiled building trees for only the expressions)</div>
</li>
<li class="level1"><div class="li"> Language features requiring the use of expensive implementation techniques (unbounded lookahead, multi-pass compilation, real-time garbage collection, ...)</div>
</li>
</ul>

<p>
 Apart from avoiding the above issues, here are some techniques that can be applied to 4th edition: 
</p>
<ul>
<li class="level1"><div class="li"> The proposed dynamic/static split is a promising idea (see <a href="doku.php%3Fid=proposals:strict_and_standard_modes.html" class="wikilink1" title="proposals:strict_and_standard_modes" onclick="return svchk()" onkeypress="return svchk()">strict and standard modes</a>).</div>
</li>
<li class="level1"><div class="li"> Optional / add-on libraries clearly marked as such and set apart in an appendix may work better than library subsets.  We&rsquo;ve discussed this in the context of introspection facilities.</div>
</li>
<li class="level1"><div class="li"> We could consider a standard representation for compiled programs, so that on-line compilation becomes less necessary.</div>
</li>
<li class="level1"><div class="li"> We should avoid implementation artifacts in the language.</div>
</li>
<li class="level1"><div class="li"> We might consider allowing for a Unicode subset if this allows Unicode support in the implementation (chiefly tables?) to be significantly smaller.</div>
</li>
</ul>

<p>
 Some things we could do but which I think are probably non-starters: 
</p>
<ul>
<li class="level1"><div class="li"> We could work to remove dynamic scoping (see the <a href="doku.php%3Fid=clarification:lexical_scope.html" class="wikilink1" title="clarification:lexical_scope" onclick="return svchk()" onkeypress="return svchk()">lexical scope</a> and <a href="doku.php%3Fid=proposals:with-bound_variables.html" class="wikilink1" title="proposals:with-bound_variables" onclick="return svchk()" onkeypress="return svchk()">with-bound variables</a> proposals)</div>
</li>
</ul>

</div>
<!-- SECTION [2455-] -->
<!-- cachefile /usr/local/www/es-lang.org/wiki/data/cache/c/cacd2cef78aab571f7b7046a0bfc7a1f.xhtml used -->
</body>
</html>
