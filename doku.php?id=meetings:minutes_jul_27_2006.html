<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <title>meetings:minutes_jul_27_2006 [ES Wiki]</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=meetings:minutes_jul_27_2006&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=meetings" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=meetings:minutes_jul_27_2006&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=meetings:minutes_jul_27_2006&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="date" content="2006-09-21T16:31:09+0000" />
  <meta name="robots" content="index,follow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />

  <link rel="shortcut icon" href="lib/images/favicon.ico" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/layout.css" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/design.css" />

  
  <link rel="stylesheet" media="print" type="text/css" href="lib/tpl/default/print.css" />

  <!--[if gte IE 5]>
  <style type="text/css">
    /* that IE 5+ conditional comment makes this only visible in IE 5+ */
    /* IE bugfix for transparent PNGs */
    //DISABLED   img { behavior: url("/lib/scripts/pngbehavior.htc"); }
  </style>
  <![endif]-->

  </head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="doku.php%3Fid=meetings:minutes_jul_27_2006&amp;do=backlink.html" onclick="return svchk()" onkeypress="return svchk()">meetings:minutes_jul_27_2006</a>]]
      </div>
      <div class="logo">
        <a href="doku.php%3Fid=.html" onclick="return svchk()" onkeypress="return svchk()" name="top" accesskey="h" title="[ALT+H]">ES Wiki</a>      </div>
    </div>
  
    
    <div class="bar" id="bar_top">
      <div class="bar-left" id="bar_topleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="meetings:minutes_jul_27_2006" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="meetings:minutes_jul_27_2006" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
  
      <div class="bar-right" id="bar_topright">
        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="recent" /><input type="hidden" name="id" value="" /><input type="submit" value="Recent changes" class="button" title="ALT+R" accesskey="r" /></form>        <form action="doku.php%3Fid=.html" accept-charset="utf-8" class="search" name="search" onsubmit="return svchk()"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch_in" accesskey="f" name="id" class="edit" onkeyup="ajax_qsearch.call('qsearch_in','qsearch_out')" /><input type="submit" value="Search" class="button" /><div id="qsearch_out" class="ajax_qsearch" onclick="this.style.display='none'"></div></form>&nbsp;
      </div>
    </div>

        <div class="breadcrumbs">
      Trace: <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_sep_13_2006.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_sep_13_2006">minutes_sep_13_2006</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_sep_06_2006.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_sep_06_2006">minutes_sep_06_2006</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_aug_30_2006.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_aug_30_2006">minutes_aug_30_2006</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_aug_23_2006.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_aug_23_2006">minutes_aug_23_2006</a> <span class="bcsep">&raquo;</span> <span class="curid"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_jul_27_2006">minutes_jul_27_2006</a></span>          </div>
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#minutes_from_group_meeting_july_27-28_oslo_norway" class="toc">Minutes from group meeting July 27-28, Oslo, Norway</a></span><ul class="toc">
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#present" class="toc">Present</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#agenda" class="toc">Agenda</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#summary_27_july" class="toc">Summary 27 July</a></span><ul class="toc">
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#yahoo_s_position" class="toc">Yahoo!s position</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#microsoft_s_position" class="toc">Microsoft's position</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#conversion_of_structured_types" class="toc">Conversion of structured types</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#object_field_covariance" class="toc">Object field covariance</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#date_literals" class="toc">Date literals</a></span></li>
</ul>
</li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#summary_28_july" class="toc">Summary 28 July</a></span><ul class="toc">
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#non-nullability" class="toc">Non-nullability</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#mini-proposalnamespaces_as_capabilities" class="toc">Mini-proposal: Namespaces as capabilities</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#multiple_compilation_units" class="toc">Multiple compilation units</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#modules" class="toc">Modules</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#eval" class="toc">Eval</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#iteratorsgenerators" class="toc">Iterators/generators</a></span></li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#proposal_walkthrough" class="toc">Proposal walkthrough</a></span><ul class="toc">
<li class="level4"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#reaffirmed_after_brief_discussion" class="toc">Reaffirmed after brief discussion</a></span></li>
<li class="level4"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#new_some_not_yet_on_the_wiki" class="toc">New (some not yet on the wiki)</a></span></li>
<li class="level4"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#promoted_not_yet_finished" class="toc">Promoted, not yet finished</a></span></li>
<li class="level4"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#proposed" class="toc">Proposed</a></span></li>
<li class="level4"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#open" class="toc">Open</a></span></li>
<li class="level4"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#demoted" class="toc">Demoted</a></span></li>
<li class="level4"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#misc" class="toc">Misc</a></span></li>
</ul>
</li>
<li class="level3"><span class="li"><a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#meeting_schedule" class="toc">Meeting schedule</a></span></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<a name="minutes_from_group_meeting_july_27-28_oslo_norway"></a><h1>Minutes from group meeting July 27-28, Oslo, Norway</h1>
<div class="level1">

</div>

<a name="present"></a><h2>Present</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Doug Crockford, Yahoo!</div>
</li>
<li class="level1"><div class="li"> Cormac Flanagan, UC Santa Cruz</div>
</li>
<li class="level1"><div class="li"> Brendan Eich, Mozilla</div>
</li>
<li class="level1"><div class="li"> Jeff Dyer, Adobe</div>
</li>
<li class="level1"><div class="li"> Dave Herman, Northeastern University</div>
</li>
<li class="level1"><div class="li"> Graydon Hoare, Mozilla</div>
</li>
<li class="level1"><div class="li"> Pratap Lakshman, Microsoft</div>
</li>
<li class="level1"><div class="li"> Lars Hansen, Opera</div>
</li>
<li class="level1"><div class="li"> Michael Daumling, Adobe</div>
</li>
<li class="level1"><div class="li"> Charles McCathie-Nevile, Opera</div>
</li>
<li class="level1"><div class="li"> Chris Pine, Opera</div>
</li>
</ul>

</div>

<a name="agenda"></a><h2>Agenda</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Introduction from Yahoo! and Microsoft</div>
</li>
<li class="level1"><div class="li"> (Auto-)conversion of structured types </div>
<ul>
<li class="level2"><div class="li"> the perceived benefit of mixed typed/untyped code</div>
</li>
<li class="level2"><div class="li"> problems that might occur, esp covariance on mutation</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Date literal</div>
<ul>
<li class="level2"><div class="li"> good enough?</div>
</li>
<li class="level2"><div class="li"> ambiguities?</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Multiple compilation units &ndash; go over it again</div>
</li>
<li class="level1"><div class="li"> Go through the proposals again, make sure we&rsquo;re still in agreement</div>
</li>
<li class="level1"><div class="li"> Non-nullability by default</div>
</li>
<li class="level1"><div class="li"> &ldquo;Modules&rdquo;</div>
<ul>
<li class="level2"><div class="li"> Package loading</div>
</li>
<li class="level2"><div class="li"> Advanced visibility control and optimization of imports</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Next f2f date?  </div>
<ul>
<li class="level2"><div class="li"> We talked previously about meeting at Adobe in Newton, MA (Boston area)</div>
</li>
<li class="level2"><div class="li"> ICFP is in Portland, OR on 18-20 September</div>
</li>
<li class="level2"><div class="li"> TC39 meeting is in Portland in October</div>
</li>
</ul>
</li>
</ul>

</div>

<a name="summary_27_july"></a><h2>Summary 27 July</h2>
<div class="level2">

</div>

<a name="yahoo_s_position"></a><h3>Yahoo!s position</h3>
<div class="level3">

<p>
 Yahoo very big user of ECMAScript.  
</p>

<p>
Various ideas surveyed in company: 
</p>
<ul>
<li class="level1"><div class="li"> Flash group: &ldquo;Whatever Adobe is doing is right.&rdquo;</div>
</li>
<li class="level1"><div class="li"> <acronym title="Hypertext Preprocessor">PHP</acronym> group: &ldquo;why not $ on every var?&rdquo;</div>
</li>
<li class="level1"><div class="li"> Java group: &ldquo;may they burn forever&rdquo;</div>
</li>
<li class="level1"><div class="li"> <acronym title="JavaScript">JS</acronym> group: &ldquo;please don&rsquo;t mess it up&rdquo;</div>
</li>
</ul>

<p>
 Backwards compatibility hard &amp; important, some 3rd Ed features just now becoming usable (because of dropping support for very old browsers).  Using new features is very hard (e4x as example), and some features don&rsquo;t add anything (e4x again).  These kinds of features of no/little value to Yahoo!.
</p>

<p>
Security the biggest and hardest problem they&rsquo;re facing, and would tolerate backwards incompatibilities / syntax errors for features of this magnitude.  (Mashups, ads, eval.)
</p>

<p>
Yahoo!s position is that creating a new language would be of value (and supporting it in the SCRIPT tag).
</p>

<p>
Discussion on version parameter on type attribute of SCRIPT: <acronym title="Internet Explorer 6">IE6</acronym> ignores it, hard to use, but there is a standard for it now.  The problem is browsers already deployed.  Do we want to / need to fix this?
</p>

<p>
Doug: unclear that features like classes are a benefit even long-term, <acronym title="JavaScript">JS</acronym>-like-Java programs tend to be larger and hairier than idiomatic <acronym title="JavaScript">JS</acronym>.
</p>

<p>
Jeff: would be positive to have feedback on the proposed features from eg Yahoo!.
</p>

<p>
Brendan: TG1 is in fairly good agreement on what goes in, we just need to get it sound.  We have to worry about finding incompatibilities in the spec.
</p>

</div>

<a name="microsoft_s_position"></a><h3>Microsoft's position</h3>
<div class="level3">

<p>
 Two scripting engines: a C++ engine for JScript used by Windows and MSIE, and a C# engine used by JScript.NET.  <em>Any</em> JScript program is a legal JScript.NET program and they are compatible (by the definition of passing a compatibility test suite).  Currently not possible to use only one, because the CLR is not available everywhere, and MSIE can&rsquo;t depend on that (yet).  If they can do a stripped-down CLR for MSIE they will ditch the C++ engine.
</p>

<p>
A lot of script code is being written at Microsoft, with Atlas.  live.com is massively scripted.
</p>

<p>
Priority 0 is backwards compatibility.  <em>Only</em> for security fixes will backwards compatibility be broken.
</p>

<p>
ECMAScript 4 will not make it into MSIE 7 or Windows Vista.  But they are keen to get it into products shipping after that.
</p>

</div>

<a name="conversion_of_structured_types"></a><h3>Conversion of structured types</h3>
<div class="level3">

<p>
 It&rsquo;s possible we need some sort of conversion of structured types to support mixed typed and untyped code.
</p>

<p>
It&rsquo;s possible to annotate structure literals with types so that they can be passed to typed code.  But it&rsquo;s unclear how tractable this is, since literals may be created in many places, in legacy code, or in code with other constraints.
</p>

<p>
Lars: my main concern is that we have no data, that we&rsquo;re arguing for a use case that has not been demonstrated to exist.
</p>

<p>
Brendan: my feeling is that there will be some conversion trouble, there will be an interesting class of programs that&rsquo;s excluded by &ldquo;rule 4&rdquo;.  Dyer: disagree that typed literals is sufficient to solve real problems.
</p>

<p>
The consequence of &ldquo;rule 8&rdquo; is that <em>every</em> field access (not just write) in typed code can throw an exception, since the access through a proxy must fetch a value of the type of that field in the proxy.
</p>

<p>
Having an explicit conversion is &ldquo;nice&rdquo;, but what is the meaning of the conversion?  Copying is also &ldquo;nice&rdquo;, but deep copy has problems.  Graydon: anything but copy-on-write is problematic (?).
</p>

<p>
Cormac: does getters and setters get us into problem anyway?  Brendan: they tend not to throw.
</p>

<p>
Jeff: Concerned about explicit conversion &ndash; you still have to change code that you do not have access to.
</p>

<p>
Dave: applying typing to eg the <acronym title="Document Object Model">DOM</acronym> hierarchy will break all existing (untyped) code that works with the <acronym title="Document Object Model">DOM</acronym> code without some sort of workaround.  Lars: do we get one wrapper/proxy per <acronym title="Document Object Model">DOM</acronym> method per tuple of actual parameters, ie, a big space issue?
</p>

<p>
Pratap: concerned about performance implications of mixing untyped/typed because a lot of conversion.  Brendan: yes, if performance is poor then people will just not use it.  Dave: a tight loop across a proxied object could be bad.
</p>

<p>
&ldquo;Rule 8&rdquo;, which adds runtime checks &ldquo;whereever necessary&rdquo; may be efficiently implementable through storing a bit in every slot (or in the pointer from that slot) that says that the type on the slot is different from the type of the thing it references, and a read barrier is needed to see if the type in the slot in the object is of the correct type for the variable / context.
</p>

<p>
Dave fixes solution 4 and Graydon writes up solution 8 in more detail with discussion of implementation choices; there is general consensus toward solution 8 because it appears to be efficiently implementable.
</p>

<p>
Clarifying example: 
</p>
<pre class="code">  var x : { i : int } = { i : 10 }  // conversion from untyped to typed
  var y = x
  delete y.i                        // not an error, y is untyped
  var z = x                         // no error here
  print(x.i)                        // error here</pre>

<p>
 Cormac&rsquo;s matrix: 
</p>
<pre class="code">                         untyped r/w     typed r/w
      
    obj from untyped                     read check
      code, not type     &quot;no&quot; checks     that slot gives
      on slot                            value of right type
     
    obj from typed       write check
      code, type on      that value is   &quot;no&quot; checks
      slot               of right type</pre>

<p>
 There is initially a run-time test to find out if your object came from typed or untyped code, so that is implied.  Brendan: you want a single fast check to get to the fourth quadrant.
</p>

</div>

<a name="object_field_covariance"></a><h3>Object field covariance</h3>
<div class="level3">

<p>
 Are object fields covariant?
</p>

<p>
Suppose FastTCPSocket &lt;: TCPSocket. 
</p>
<pre class="code">  type T = { x : TCPSocket }
  type U = { x : FastTCPSocket }</pre>

<p>
 Is U &lt;: T?  If so (says Cormac), we need other kinds of barriers or checks: the x field of a U can only hold a FastTCPSocket, so a function taking a T needs to check that stores into its parameter actually store FastTCPSocket or its subtypes.  The check is there already, though it needs to be a subtype check, which may not be very fast.
</p>

<p>
Brendan: how does this fit with JSON?  Any other use cases for this?
</p>

<p>
Graydon: there is the versioning problem.  Consider: 
</p>
<pre class="code">  { x: { a: 10 }, y: { p: 10 } }
  { x: { a: 10, b: 20 }, y: { p: 10 } }</pre>

<p>
 Here the only thing that&rsquo;s happened is that a field has been added (protocol upgrade, say).  So without covariant structural subtyping we&rsquo;ll have problems here.
</p>

<p>
We agree we need this.
</p>

<p>
(Another solution is const fields in structures, but there&rsquo;s no agreement on this.)
</p>

</div>

<a name="date_literals"></a><h3>Date literals</h3>
<div class="level3">

<p>
 There seem to be very little justification for date literals per se, so there&rsquo;s tentative(?) agreement to drop that proposal.
</p>

<p>
But there also seems to be agreement about fixing Date.parse() by defining a literal format it is known to understand, and for defining eg Date.toISOString() to produce a string on this format always.  The format would be an <acronym title="International Organization for Standardization">ISO</acronym> time string, probably not unlike what the date literal proposal has currently.
</p>

<p>
Graydon: what resolution?  Brendan: milliseconds.
</p>

<p>
But we could do a separate proposal for nanotime (or better).
</p>

<p>
Doug: could have a variation on the Date constructor that takes a structure with fields like &ldquo;month&rdquo;, &ldquo;day&rdquo;, etc with defaults taken from the current date.  This would fix the problem with <code>Date.parse(&rdquo;9/11&rdquo;)</code>, for example.  Brendan: It&rsquo;s not backwards compatible, though. 
</p>
<hr noshade="noshade" size="1" />

<p>
 Doug elaborated his proposal by adding a test for <code>Object.prototype.toString</code> being overridden, either replaced in <code>Object.prototype</code> or shadowed in the object or a nearer prototype: if <code>toString</code> is overridden on the single object argument to the Date constructor, then it should be called per ECMA-262 Edition 3 15.9.3.2 <code>new Date(value)</code>; otherwise, we know the default conversion to primitive will call <code>Object.prototype.toString</code>, which will produce a string guaranteed not to parse as a date, and we should instead look for <code>month</code>, etc. properties in the object.
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2006/08/03 18:27</em>
</p>

<p>
Brendan: let&rsquo;s see if we can define the parser more rigorously based on what we know about how people write dates on the web.
</p>

<p>
Charles: use <acronym title="World Wide Web Consortium">W3C</acronym> dates (rather restrictive) rather than full <acronym title="International Organization for Standardization">ISO</acronym> dates.
</p>

</div>

<a name="summary_28_july"></a><h2>Summary 28 July</h2>
<div class="level2">

<p>
 (Not present: Charles McCathie-Nevile.)
</p>

</div>

<a name="non-nullability"></a><h3>Non-nullability</h3>
<div class="level3">

<p>
 Brendan/Jeff: want non-nullable types by default.
</p>

<p>
Lars: disagree, makes instance initialization too hard in practice.  Any pointer field that can&rsquo;t be given a constant initializer will end up being defined nullable because it won&rsquo;t be initialized until the constructor.
</p>

<p>
Brendan: Tucker argued that you can handle initialization through definite assignment analysis, but we don&rsquo;t want to impose that.
</p>

<p>
Dave: given that we require the C++ style initializers for non-nullable fields it seems like a tall order to require the majority of fields to be initialized that way.
</p>

<p>
Graydon: disagree, seems just fine to me.  The language &ldquo;nice&rdquo; <a href="http://nice.sourceforge.net/" class="urlextern" target="_blank" title="http://nice.sourceforge.net/" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">http://nice.sourceforge.net/</a> has more interesting constructor semantics, where the last action in the construction sequence is always a call to a generated constructor that takes arguments for all fields of the class and initializes them.
</p>

<p>
Interaction of structural types and non-nullability?  Brendan: Array and Object and Function are nullable, and structural types are mapped to these, so structural types are nullable by default.
</p>

<p>
Jeff: null are lightweight default values, with non-nullable as default we force people to write heavyweight default values.
</p>

<p>
Jeff: who wants non-nullable types?  Ajax people who now write executable assertions in their code will probably be happy.
</p>

<p>
Brendan on whether function types is nullable or not: 
</p>
<pre class="code">  var f = Function.&lt;A,B,C,R&gt;(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;return a+b*c&quot;);
  type F = function (A,B,C) : R;
  let g : F = function (a:A,b:B,c:C):R { return a+b*c };</pre>

<p>
 One view is that the value of g in 3rd Ed has a nullable type; the other view is that 3rd Ed does not have types at all so the issue does not arise, and clearly a function value is never null.  By this view, any structural type could be said to be non-nullable (the type of the object always describes an object).
</p>

<p>
In the end: types are nullable by default.
</p>

<p>
Looks like type expression syntax needs to evolve a little to be able to express non-nullable structural types conveniently.  Today this requires two type definitions because <code>!</code> and <code>?</code> can only be applied to type names.  Dave thinks we should be able to write e.g. 
</p>
<pre class="code">  type F = (function (int) : int)!;   // otherwise ! would bind to the second int
  type G = {&quot;a&quot;: double, &quot;b&quot;: int}!;  // no ambiguity</pre>

</div>

<a name="mini-proposalnamespaces_as_capabilities"></a><h3>Mini-proposal: Namespaces as capabilities</h3>
<div class="level3">

<p>
 Graydon: Proposal for extending namespace system into simple system of revokable capabilities: 
</p>
<pre class="code">  namespace ns;
  ns var x = 27;
  var c = new Namespace(ns);  // make a revokable copy of ns</pre>

<p>
 The client obtains c and uses it to access properties: 
</p>
<pre class="code">  x.c::foo</pre>

<p>
 Now later I can do 
</p>
<pre class="code">  c.revoke()</pre>

<p>
 to kill c, and make it impossible for the client to obtain properties in that namespace.  
</p>

<p>
Discussion: Revocation does not kill values previously extracted, notably bound methods, so it&rsquo;s a somewhat limited security mechanism.  You could make revokable namespaces wrap bound methods when they are extracted so that they are affected by revocation, but then they are not really namespaces any more.
</p>

<p>
Also a possibility to use stack-based security: pushing the namespace on the stack while performing an operation.  Graydon to elaborate.
</p>

</div>

<a name="multiple_compilation_units"></a><h3>Multiple compilation units</h3>
<div class="level3">

<p>
 Do we want something structured like AppDomains, class loaders?  ActionScript has multiple global environments, one per compilation unit.  A possibility is to give <code>eval</code> a second argument that is the environment object it should use as its outermost rib: 
</p>
<pre class="code">  eval( &quot;...&quot;, new Sandbox(...) )
  eval( &quot;...&quot;, { ... } )</pre>
<pre class="code">  some_window.eval(&quot;...&quot;) == eval(&quot;...&quot;, some_window)</pre>

<p>
 Doug: possible to put types in that object that the typechecker (and the code loaded in that context) will use?
</p>

<p>
Brendan: must be careful about sharing type objects between environments because their prototypes are mutable, for one thing.  But desirable.  GreaseMonkey already does some of this, it injects privileged functions into the sandbox for user scripts.  Brendan will try to write some of this up.
</p>

</div>

<a name="modules"></a><h3>Modules</h3>
<div class="level3">

<p>
 Two things: naming and loading.
</p>

<p>
Naming: Javaesque <acronym title="Domain Name Server">DNS</acronym> naming (ie p.q.r.useful means something), or content hashing (ie package name is 40-bit hash, say).
</p>

<p>
Jeff: import cannot affect loading.  There must exist some separate loading mechanism, something that says ahead of time to load the imported package.  Could happen during the definition phase when the package is referenced.  Consider example:
</p>

<p>
Fragment 1: 
</p>
<pre class="code">import p.q.T;
var x : T = ...</pre>

<p>
Fragment 2: 
</p>
<pre class="code">package p.q {
  public type T = ...
}</pre>

<p>
 With a verification phase, F2 must be loaded when F1 is verified.  Without that, it need not be loaded until F1 is executed.
</p>

<p>
Agreed: the parser throws an error if an imported package is not available at the point of import (aids early error detection, and is pretty much required for some sort of name resolution anyway).  
</p>

<p>
Agreed: Making imported packages actually available is the responsibility of the host environment.  (Typical browser scenario: a script writes a script tag that loads one version or another of package named <code>p.q</code>; a subsequent script then imports <code>p.q</code>.  Browser vendors might agree on improvements to SCRIPT, but not under the auspices of this group.)
</p>

<p>
Agreed: we axe the <code>include</code> directive from the language, packages are better both semantically and from a performance point of view.
</p>

</div>

<a name="eval"></a><h3>Eval</h3>
<div class="level3">

<p>
 Various cases: 
</p>
<pre class="code">eval(s)        // ok
window.eval(s) // ok
eval           // throws EvalError
o.eval(s)      // throws EvalError for some random o</pre>

<p>
 In practice this is good enough.
</p>

<p>
Brendan: Proposal for ES4: o.eval(s) throws Evalerror unless o is a global object.
</p>

<p>
Another proposal: If we do allow <code>eval(s, o)</code> then <code>o</code> becomes the outermost object in the scope chain for the evaluation.
</p>

<p>
(Lars will write up these as a &ldquo;Resurrected eval&rdquo; proposal.)
</p>

<p>
Brendan: SpiderMonkey allows <code>o.eval(s)</code> for arbitrary o, this means <code>with (o) eval(s)</code>, but it&rsquo;s Mozilla&rsquo;s problem.
</p>

<p>
Agreed(?): Define <code>intrinsic::global</code> to get the global object (or the &ldquo;current global object&rdquo; in systems that have more than one).
</p>

</div>

<a name="iteratorsgenerators"></a><h3>Iterators/generators</h3>
<div class="level3">

<p>
 Example of generator: 
</p>
<pre class="code"> function count(n) {
    for ( let i=0 ; i &lt; n ; i++ )
       yield i
 }
 g = count(10);
 g.next() -&gt; 0
 g.next() -&gt; 1
 ...
 g.next() -&gt; 9
 g.next() -&gt; throws StopIteration</pre>

<p>
 Here StopIteration is a singleton whose [[Class]]==&rdquo;StopIteration&rdquo; and whose [[Prototype]] is Object.prototype.
</p>

<p>
A function containing <code>yield</code> returns a generator object when called (no <code>return</code> statement is allowed).  This is an object with the following methods: 
</p>
<pre class="code"> g.next()
 g.send(v)
 g.throw(e)
 g.close()</pre>

<p>
 Example 
</p>
<pre class="code"> function toy() {
    print(yield 1)
    print(yield 2)
    print((yield 3) + (yield 4))
 }
 t = toy()
 t.next() -&gt; 1
 t.send(10) prints 10 
            -&gt; 2
 t.send(11) prints 11
            -&gt; 3
 t.send(12) -&gt; 4
 t.send(13) prints 25
            throws StopIteration</pre>

<p>
 On the use of close(): 
</p>
<pre class="code"> function foo() {
    try {
       yield commit();
    }
    finally {
       cleanup();
    }
 }
 g = foo();
 g.next();
 g.close();</pre>

<p>
 If the program does not call close(), the GC must &ndash; so we must have some sort of finalization (weak pointers / guardians, at a minimum).
</p>

<p>
Generators are parameterized structural types: 
</p>
<pre class="code">  type Generator.&lt;I,O&gt; = {
         next:  function () : I,
         send:  function (O) : I,
         close: function () : void
       }</pre>

<p>
 On the topic of iterators.  Consider an enumeration: 
</p>
<pre class="code"> for ( i in o )</pre>

<p>
 The situation is that: 
</p>
<ul>
<li class="level1"><div class="li"> real world wants property creation order (except maybe for arrays?)</div>
</li>
<li class="level1"><div class="li"> ecma says impl. dep. order</div>
</li>
<li class="level1"><div class="li"> shadowing must be handled</div>
</li>
<li class="level1"><div class="li"> delete coherence required</div>
</li>
</ul>

<p>
 Now suppose <code>it</code> is an iterator, ie <code>it &lt;: { &ldquo;next&rdquo; : function () : * }</code> 
</p>
<pre class="code">for ( i in it )</pre>

<p>
 Here we get: 
</p>
<ul>
<li class="level1"><div class="li"> call it.next() until StopIteration is called</div>
</li>
</ul>

<p>
 You can call <code>Iterator</code> on <code>o</code> 
</p>
<pre class="code">it = Iterator(o)</pre>

<p>
 This may return o if it is an iterator already or the result of something like <code>o.intrinsic::iterator()</code>. 
</p>
<hr noshade="noshade" size="1" />

<p>
 To correct my misstatement: <code>for (i in o)</code> always calls <code>Iterator(o)</code> to get or create an iterator for <code>o</code>, which will be <code>o</code> itself if it is an iterator object.  So there&rsquo;s no backward compatibility problem: ES4 introduces intrinsic and defines intrinsic::iterator in Object.prototype.  This is the &ldquo;iterator getter&rdquo; method delegated to by <code>Iterator</code>.  Custom iterator getters defined on more derived prototypes, or on individual objects, give custom value iteration instead of ECMA-compatible property enumeration.  More in <a href="doku.php%3Fid=proposals:iterators_and_generators.html" class="wikilink1" title="proposals:iterators_and_generators" onclick="return svchk()" onkeypress="return svchk()">iterators and generators</a> shortly.
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2006/08/03 18:16</em>
</p>

<p>
(Extensive discussion not recorded, but in the end there&rsquo;s substantial doubt about whether this proposal pays for itself.)
</p>

</div>

<a name="proposal_walkthrough"></a><h3>Proposal walkthrough</h3>
<div class="level3">

<p>
 (Everything not noted was reaffirmed without discussion)
</p>

</div>

<a name="reaffirmed_after_brief_discussion"></a><h4>Reaffirmed after brief discussion</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Type parameters: seem OK</div>
</li>
<li class="level1"><div class="li"> Nullability: C++ type initializers OK; punctuation is <code>: initializers</code></div>
</li>
<li class="level1"><div class="li"> Enumerability: Brendan thinks it may be a hack but hard to object</div>
</li>
</ul>

</div>

<a name="new_some_not_yet_on_the_wiki"></a><h4>New (some not yet on the wiki)</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> (Mid-level) intrinsic::global</div>
</li>
<li class="level1"><div class="li"> (Mid-level) security wrappers</div>
</li>
<li class="level1"><div class="li"> (Mid-level) resurrected eval</div>
</li>
<li class="level1"><div class="li"> (Surface) array comprehensions (split from slice/splice)</div>
</li>
</ul>

</div>

<a name="promoted_not_yet_finished"></a><h4>Promoted, not yet finished</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> &ldquo;Date and time&rdquo;, absorbs &ldquo;Date literals&rdquo;</div>
</li>
</ul>

</div>

<a name="proposed"></a><h4>Proposed</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> (Pratap) Non-type-safe formatting library</div>
</li>
</ul>

</div>

<a name="open"></a><h4>Open</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Typing of initializers: a little debate (unresolved): is a full type expression allowed or just name?</div>
</li>
<li class="level1"><div class="li"> Numbers: proposal open, needs more discussion</div>
</li>
<li class="level1"><div class="li"> Type refinements: blame assignment is definitely out, an implementation needs to appear for this to live.  Dave: perhaps just an assertion mechanism would do</div>
</li>
<li class="level1"><div class="li"> Syntax for type expressions: add postfix <code>!</code> and <code>?</code> on type expressions</div>
</li>
<li class="level1"><div class="li"> Iterators and generators: significant turmoil.  No agreement.</div>
</li>
<li class="level1"><div class="li"> Slice/splice: do we want these?</div>
</li>
<li class="level1"><div class="li"> JSON library</div>
</li>
</ul>

</div>

<a name="demoted"></a><h4>Demoted</h4>
<div class="level4">
<ul>
<li class="level1"><div class="li"> Date literals are out, but will be folded into &ldquo;Date and time&rdquo;</div>
</li>
</ul>

</div>

<a name="misc"></a><h4>Misc</h4>
<div class="level4">

<p>
 Implemented proposals should be marked as such with appropriate emoticon
</p>

<p>
Things generally won&rsquo;t be written up in the spec until they&rsquo;re implemented (though there may be exceptions).
</p>

</div>

<a name="meeting_schedule"></a><h3>Meeting schedule</h3>
<div class="level3">

<p>
 Mozilla, Mt View, CA &ndash; September 21/22
</p>

<p>
Adobe, Newton MA &ndash; October 19/20
</p>

<p>
Yahoo!, Sunnyvale &ndash; November 16/17 &ndash; maybe interface with WebAPI group
</p>

<p>
Soft deadline in September and much harder deadline in October for implementations. 
</p>

</div>

<!-- no cachefile used, but created -->
    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
      <div class="doc">
        meetings/minutes_jul_27_2006.txt &middot; Last modified: 2006/09/21 16:31 by lth      </div>
    </div>

   
    <div class="bar" id="bar_bottom">
      <div class="bar-left" id="bar_bottomleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="meetings:minutes_jul_27_2006" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="meetings:minutes_jul_27_2006" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
      <div class="bar-right" id="bar_bottomright">
                        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="login" /><input type="hidden" name="id" value="meetings:minutes_jul_27_2006" /><input type="submit" value="Login" class="button" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="index" /><input type="hidden" name="id" value="meetings:minutes_jul_27_2006" /><input type="submit" value="Index" class="button" title="ALT+X" accesskey="x" /></form>        <a href="doku.php%3Fid=meetings:minutes_jul_27_2006.html#top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" /></a>&nbsp;
      </div>
    </div>

  </div>

</div>

<div align="center" class="footerinc">
  <a target="_blank" href="feed.php" title="Recent changes RSS feed"><img src="lib/tpl/default/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="license" title="Creative Commons License"><img src="lib/tpl/default/images/button-cc.gif" width="80" height="15" alt="Creative Commons License" border="0" /></a>

  <a target="_blank" href="https://www.paypal.com/xclick/business=andi%40splitbrain.org&amp;item_name=DokuWiki+Donation&amp;no_shipping=1&amp;no_note=1&amp;tax=0&amp;currency_code=EUR&amp;lc=US" title="Donate"><img src="lib/tpl/default/images/button-donate.gif" alt="Donate" border="0" /></a>

  <a target="_blank" href="http://www.php.net" title="Powered by PHP"><img src="lib/tpl/default/images/button-php.gif" width="80" height="15" alt="Powered by PHP" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="lib/tpl/default/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="lib/tpl/default/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="lib/tpl/default/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>



<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->
</div>

<img src="lib/exe/indexer.php%3Fid=meetings%253Aminutes_jul_27_2006&amp;1454275533" width="1" height="1" alt=""  /></body>
</html>
