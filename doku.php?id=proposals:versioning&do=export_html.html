<html>
<head>
  <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=proposals:versioning&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=proposals" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=proposals:versioning&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="robots" content="noindex,nofollow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />
</head>
<body>
<div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#versioning" class="toc">Versioning</a></span><ul class="toc">
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#media_type" class="toc">Media Type</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#default_scripting_language" class="toc">Default Scripting Language</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#script_tag_behavior" class="toc">Script Tag Behavior</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#dynamic_version_detection" class="toc">Dynamic Version Detection</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#language_attribute" class="toc">Language Attribute</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#accept" class="toc">Accept</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:versioning&amp;do=export_html.html#modifications_of_global_bindings" class="toc">Modifications of Global Bindings</a></span></li>
</ul>
</li>
</ul>
</div>
</div>

<p>
(See also <a href="doku.php%3Fid=discussion:versioning.html" class="wikilink1" title="discussion:versioning" onclick="return svchk()" onkeypress="return svchk()">the versioning discussion</a>.)
</p>

<a name="versioning"></a><h1>Versioning</h1>
<div class="level1">

</div>
<!-- SECTION [70-95] -->
<a name="media_type"></a><h2>Media Type</h2>
<div class="level2">

<p>
 ES4 shall define normative values for the <code>version</code> parameter described in <a href="http://www.ietf.org/rfc/rfc4329.txt" class="urlextern" target="_blank" title="http://www.ietf.org/rfc/rfc4329.txt" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">RFC 4329</a> as optional for the <code>application/javascript</code> and <code>application/ecmascript</code> Internet media types. From RFC 4329 section 3: 
</p>
<blockquote>
   Updates of this document may introduce new optional parameters;   implementations MUST consider the impact of such an update.  For the   application/ecmascript media type, implementations MUST NOT process   content labeled with a &ldquo;version&rdquo; parameter as if no such parameter   had been specified; this is typically achieved by treating the   content as unsupported.  This error handling behavior allows   extending the definition of the media type for content that cannot be   processed by implementations of [ECMA].</blockquote>

<p>
 User agents implementing ES3.1 and ES4 MUST follow RFC 4329 by processing a <code>version</code> parameter for <code>application/ecmascript</code>, not ignoring it. For <code>application/ecmascript</code>, the <code>version</code> value <code>4</code> corresponds to ECMAScript 4.  The <code>version</code> value <code>3.1</code> corresponds to ECMAScript 3.1. An example string containing the full type with version is <code>&ldquo;application/ecmascript;version=4&rdquo;</code>. Content with other explicit <code>version</code> values including <code>1</code>, <code>2</code>, <code>3</code>, and <code>4.0</code> are not specified, and if sent to a peer implementing ES4 MAY be handled as unsupported content.
</p>

<p>
For the <code>application/javascript</code> type, the <code>version</code> values already in use are <code>1.0</code>, <code>1.1</code>, <code>1.2</code>, <code>1.3</code>, <code>1.4</code>, <code>1.5</code>, <code>1.6</code>, and <code>1.7</code> (note that these are not specified by RFC 4329 or by any ECMA specification). Implementations of ES4 MUST process content of type <code>application/javascript</code> with <code>version</code> equal to <code>2</code> the same as they would <code>application/ecmascript</code> with <code>version</code> equal to <code>4</code>.
</p>

</div>
<!-- SECTION [96-1922] -->
<a name="default_scripting_language"></a><h2>Default Scripting Language</h2>
<div class="level2">

<p>
 The document&rsquo;s default scripting language is used for all script that does not have an explicit language and version specified (e.g. event handlers, javascript: URLs, and script embedded in cascading stylesheets).
</p>

<p>
User agents are free to choose any default scripting language. It is expected that most current user agents will default to ES3.
</p>

<p>
The <a href="http://www.w3.org/TR/html401/interact/scripts.html#h-18.2.2.1" class="urlextern" target="_blank" title="http://www.w3.org/TR/html401/interact/scripts.html#h-18.2.2.1" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">Content-Script-Type</a> directive overrides the default script version in a document. It can be specified as an <acronym title="Hyper Text Transfer Protocol">HTTP</acronym> header or meta tag.
</p>
<pre class="code html4strict"><span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/meta.html"><span class="kw2">&lt;meta</span></a> <span class="kw3">http-equiv</span>=<span class="st0">"Content-Script-Type"</span> <span class="kw3">content</span>=<span class="st0">"application/ecmascript;version=4"</span><span class="kw2">&gt;</span></a></pre>
</div>
<!-- SECTION [1923-2623] -->
<a name="script_tag_behavior"></a><h2>Script Tag Behavior</h2>
<div class="level2">

<p>
 The language and language version for a script tag is determined by the server-specified Content-Type header. If the server-specified Content-Type header does not specify a language version or the script is inline, a more specific type attribute on the script tag&rsquo;s can be used to select the language and version. If neither the Content-Type header nor the type attribute specifies a version, and the script is interpreted using the document&rsquo;s default scripting language version. 
</p>

<p>
Examples:
</p>
<pre class="code html4strict"><span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script&gt;</span></a>
  // The document's default scripting language version is used
<span class="sc2"><span class="kw2">&lt;/script&gt;</span>
&nbsp;
<span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script</span></a> <span class="kw3">type</span>=<span class="st0">"text/javascript"</span><span class="kw2">&gt;</span></a>
  // The document's default scripting language version is used
<span class="sc2"><span class="kw2">&lt;/script&gt;</span>
&nbsp;
<span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script</span></a> <span class="kw3">type</span>=<span class="st0">"application/ecmascript;version=4"</span><span class="kw2">&gt;</span></a>
  // This script is interpreted as ES4.
<span class="sc2"><span class="kw2">&lt;/script&gt;</span>
&nbsp;
<span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script</span></a> <span class="kw3">src</span>=<span class="st0">"code.js"</span><span class="kw2">&gt;</span></a>
<span class="sc2"><span class="coMULTI">&lt;!-- 
  HTTP Content-Type is used to select the language and language version.
  If the Content-Type does not specify a language, the document's default language is used.
  If the Content-Type does matches the document's default language but does not specify a version, the document's default language version is used.
--&gt;</span>
<span class="sc2"><span class="kw2">&lt;/script&gt;</span>
&nbsp;
<span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script</span></a> <span class="kw3">type</span>=<span class="st0">"application/ecmascript;version=4"</span> <span class="kw3">src</span>=<span class="st0">"code.js"</span><span class="kw2">&gt;</span></a>
<span class="sc2"><span class="coMULTI">&lt;!-- 
  HTTP Content-Type is used to select the language and language version.
  If the Content-Type does not specify a language, ES4 is used.
  If the Content-Type specifies ECMAScript (or JavaScript) but no version, ES4 is used.
--&gt;</span>
<span class="sc2"><span class="kw2">&lt;/script&gt;</span></pre>
</div>
<!-- SECTION [2624-4124] -->
<a name="dynamic_version_detection"></a><h2>Dynamic Version Detection</h2>
<div class="level2">

<p>
 ES4 implementations MUST define a new global ReadOnly and DontDelete property <code>__MAX_ECMASCRIPT_VERSION__</code>, whose value is a string reflecting the maximum ECMA-262 version supported by the user agent&rsquo;s ES implementation.
</p>

<p>
Thus in order to operate with old and new user agents, an <acronym title="HyperText Markup Language">HTML</acronym> file may contain:
</p>
<pre class="code html4strict"><span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script</span></a> <span class="kw3">type</span>=<span class="st0">"text/javascript"</span><span class="kw2">&gt;</span></a>
  if (this.__MAX_ECMASCRIPT_VERSION__ &gt;= 4)
    document.writeln(&quot;<span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script</span></a> <span class="kw3">type</span>=<span class="st0">'application/ecmascript;version=4'</span> <span class="kw3">src</span>=<span class="st0">'es4-code.js'</span><span class="kw2">&gt;</span></a><span class="sc2"><span class="kw2">&lt;</span></a>\/script&gt;&quot;);
  else
    document.writeln(&quot;<span class="sc2"><a target="_blank"  href="http://december.com/html/4/element/script.html"><span class="kw2">&lt;script</span></a> <span class="kw3">type</span>=<span class="st0">'text/javascript'</span> <span class="kw3">src</span>=<span class="st0">'es3-code.js'</span><span class="kw2">&gt;</span></a><span class="sc2"><span class="kw2">&lt;</span></a>\/script&gt;&quot;);
<span class="sc2"><span class="kw2">&lt;/script&gt;</span></pre>
<p>
This example is specific to a Web browser user agent, but similar examples can be given for other kinds of user agents.
</p>

</div>
<!-- SECTION [4125-4895] -->
<a name="language_attribute"></a><h2>Language Attribute</h2>
<div class="level2">

<p>
 The Language attribute of the script tag is deprecated.
</p>

</div>
<!-- SECTION [4896-4984] -->
<a name="accept"></a><h2>Accept</h2>
<div class="level2">

<p>
 The <acronym title="Hyper Text Transfer Protocol">HTTP</acronym>/1.1 specification allows user agents to send an <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1" class="urlextern" target="_blank" title="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">Accept</a> header containing compatible versions of ECMAScript in preference order. Servers may use this header to decide which language to reply with. 
</p>
<pre class="code">
GET /code.js HTTP/1.1
Accept: application/ecmascript;version=4, application/ecmascript, */*
</pre>

</div>
<!-- SECTION [4985-5386] -->
<a name="modifications_of_global_bindings"></a><h2>Modifications of Global Bindings</h2>
<div class="level2">

<p>
 Changing global object bindings is incompatible with ES4. 
</p>

<p>
If ES3 or ES3.1 code tries to overwrite these bindings before any ES4 code has executed in the current document, these bindings are changed, but further ES4 scripts will not execute in that document.
</p>

<p>
If ES3 or ES3.1 code tries to overwrite these bindings after any ES4 code has executed in the current document, the bindings will be treated as readonly and the attempt to change them will fail silently.
</p>

</div>
<!-- SECTION [5387-] -->
<!-- cachefile /usr/local/www/es-lang.org/wiki/data/cache/a/a3db57489717220d180041045f74bf56.xhtml used -->
</body>
</html>
