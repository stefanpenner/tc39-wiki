<html>
<head>
  <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=conventions:isarraylike&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=conventions" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=conventions:isarraylike&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=conventions:isarraylike&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="robots" content="noindex,nofollow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />
</head>
<body>

<p>
Further discussion of this topic on es-discuss has convinced its original proposer, MarkM, that there is no coherent general convention for isArrayLike that can be rescued and reconciled with existing practice. Accordingly, I have stopped editing this page. If someone does believe that attempting a coherent proposal would still be productive, they should please edit this page accordingly. <em>&mdash;MarkM 1/9/2010 10:48am PDT</em>
</p>

<a name="isarraylike_obj_any_boolean"></a><h1>isArrayLike(obj :any) :boolean</h1>
<div class="level1">

<p>
 This <a href="https://mail.mozilla.org/pipermail/es-discuss/2009-December/010255.html" class="urlextern" target="_blank" title="https://mail.mozilla.org/pipermail/es-discuss/2009-December/010255.html" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">es-discuss thread</a> documents a variety of conventions currently in use to determine if an object should be array-like. The following proposed predicate has the virtues that it 
</p>
<ul>
<li class="level1"><div class="li"> admits native arrays, arguments objects, and (perhaps inappropriately) String wrapper objects,</div>
</li>
<li class="level1"><div class="li"> admits those host objects that are typically considered array-like by other legacy array-like tests (is this true?),</div>
</li>
<li class="level1"><div class="li"> does not admit any other legacy ES3R non-host objects (to prevent false positives),</div>
</li>
<li class="level1"><div class="li"> allows ES5 programmers to easily define new array-like non-array objects,</div>
</li>
<li class="level1"><div class="li"> takes bounded-by-constant time (i.e., no iteration) under the assumption that inheritance chains have bounded depth,</div>
</li>
<li class="level1"><div class="li"> is a reasonably compatible compromise with the existing notions of array-like in legacy libraries as represented by the thread cited above.</div>
</li>
</ul>
<pre class="code javascript"><span class="kw2">function</span> isArrayLike<span class="br0">&#40;</span>obj<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">return</span> !!<span class="br0">&#40;</span>obj &amp;&amp;
            <span class="kw1">typeof</span> obj === <span class="st0">'object'</span> &amp;&amp; 
            <span class="st0">'length'</span> <span class="kw1">in</span> obj &amp;&amp; 
            !<span class="br0">&#40;</span><span class="br0">&#123;</span><span class="br0">&#125;</span>.<span class="me1">propertyIsEnumerable</span>.<span class="me1">call</span><span class="br0">&#40;</span>obj, <span class="st0">'length'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
<span class="br0">&#125;</span></pre>
</div>
<!-- SECTION [429-1599] -->
<a name="issues"></a><h2>Issues</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> It may be better for the above predicate to reject String wrapper objects, such as by adding a </div>
</li>
</ul>
<pre class="code javascript"><span class="br0">&#40;</span><span class="br0">&#123;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>.<span class="me1">toString</span>.<span class="me1">call</span><span class="br0">&#40;</span>obj<span class="br0">&#41;</span> !== <span class="st0">'[object String]'</span></pre>
<p>
 conjunct.
</p>
<ul>
<li class="level1"><div class="li"> Although the above code cannot cause side effects on ES3R or ES5 when <code>obj</code> is a non-host object, it can cause side effects when <code>obj</code> is a <a href="doku.php%3Fid=strawman:proxies.html" class="wikilink1" title="strawman:proxies" onclick="return svchk()" onkeypress="return svchk()">proxy</a>. This is necessary to allow proxies to emulate array-like objects adequately to pass the above predicate.</div>
</li>
<li class="level1"><div class="li"> Unfortunately, the <code>propertyIsEnumerable</code> test above, despite the name, <a href="https://mail.mozilla.org/pipermail/es-discuss/2009-December/010381.html" class="urlextern" target="_blank" title="https://mail.mozilla.org/pipermail/es-discuss/2009-December/010381.html" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">actually tests whether a property is both enumerable and own</a>. This means the above predicate will reject objects that inherit a non-enumerable length property. I can think of no reliable and portable ES3R test which tests only property enumerability, except by running a for-in loop and testing the output. Doing so would kill the bounded-by-constant time virtue.</div>
</li>
</ul>

</div>
<!-- SECTION [1600-] -->
<!-- cachefile /usr/local/www/es-lang.org/wiki/data/cache/7/72e5bbe10759b78a871f42bef936b99c.xhtml used -->
</body>
</html>
