<html>
<head>
  <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="http://wiki.ecmascript.org/feed.php?mode=list&amp;ns=spec" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="robots" content="noindex,nofollow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />
</head>
<body>
<div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#global_object" class="toc">Global object</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#class_objects" class="toc">Class objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#object_objects" class="toc">Object objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#function_objects" class="toc">Function objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#array_objects" class="toc">Array objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#string_objects" class="toc">String objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#boolean_objects" class="toc">Boolean objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#number_objects" class="toc">Number objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#math_object" class="toc">Math object</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#date_objects" class="toc">Date objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#error_objects" class="toc">Error objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#meta-objects" class="toc">Meta-objects</a></span></li>
<li class="level1"><span class="li"><a href="doku.php%3Fid=spec:chapter_19_native_objects&amp;do=export_html.html#regexp_objects" class="toc">RegExp objects</a></span></li>
</ul>
</div>
</div>

<p>
The form and function of the native objects is the same as Ecmascript ed. 3 except that all prototype properties are also implemented as class methods. Prototype properties that are functions are implemented as regular methods. Prototype properties that are variables are implemented as a pair of get and set methods that forward state to the prototype property.
</p>

<p>
<strong>PROPOSAL</strong> &mdash; Please see the <a href="doku.php%3Fid=proposals:builtin_classes.html" class="wikilink1" title="proposals:builtin_classes" onclick="return svchk()" onkeypress="return svchk()">Builtin classes proposal page</a> for more information.
</p>

<a name="global_object"></a><h1>Global object</h1>
<div class="level1">
<pre class="code javascript">&nbsp;
<span class="kw2">package</span>
<span class="br0">&#123;</span>
    <span class="co1">// 15.1.1.1 NaN</span>
    <span class="co1">// 15.1.1.2 Infinity</span>
    <span class="co1">// 15.1.1.3 undefined</span>
    <span class="co1">// {DE,DD,RO} -- change from ECMA-262, which has them as {DE,DD}</span>
    ECMA4 <span class="kw2">const</span> NaN = <span class="nu0">0</span>.<span class="nu0">0</span>/<span class="nu0">0</span>.<span class="nu0">0</span>;
    ECMA4 <span class="kw2">const</span> Infinity = <span class="nu0">1</span>.<span class="nu0">0</span>/<span class="nu0">0</span>.<span class="nu0">0</span>;
    ECMA4 <span class="kw2">const</span> undefined = <span class="kw1">void</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span>;
    
    <span class="co1">// @todo: &quot;dynamic function&quot; is probably redundant at the top level, but is useful for clarity</span>
    
    <span class="co1">// 15.1.2.1 eval (x)</span>
    ECMA4 native <span class="kw2">function</span> <span class="kw1">eval</span><span class="br0">&#40;</span>x<span class="br0">&#41;</span>;
&nbsp;
    <span class="co1">// 15.1.2.2 parseInt (string , radix)</span>
    ECMA4 native <span class="kw2">function</span> parseInt<span class="br0">&#40;</span>string:String, radix:Number<span class="br0">&#41;</span>;
&nbsp;
    <span class="co1">// 15.1.2.3 parseFloat (string)</span>
    ECMA4 native <span class="kw2">function</span> parseFloat<span class="br0">&#40;</span>string:String<span class="br0">&#41;</span>;
&nbsp;
    <span class="co1">// 15.1.2.4 isNaN (number)</span>
    ECMA4 native <span class="kw2">function</span> isNaN<span class="br0">&#40;</span>number:*<span class="br0">&#41;</span>:Boolean;
&nbsp;
    <span class="co1">// 15.1.2.4 isFinite (number)</span>
    ECMA4 native <span class="kw2">function</span> isFinite<span class="br0">&#40;</span>number:*<span class="br0">&#41;</span>:Boolean;
    
    <span class="co1">// 15.1.3.1 decodeURI (encodedURI)</span>
    ECMA4 native <span class="kw2">function</span> <span class="kw1">decodeURI</span><span class="br0">&#40;</span>encodedURI<span class="br0">&#41;</span>;
&nbsp;
    <span class="co1">// 15.1.3.2 decodeURIComponent (encodedURIComponent)</span>
    ECMA4 native <span class="kw2">function</span> decodeURIComponent<span class="br0">&#40;</span>encodedURIComponent<span class="br0">&#41;</span>;
    
    <span class="co1">// 15.1.3.3 encodeURI (uri)</span>
    ECMA4 native <span class="kw2">function</span> <span class="kw1">encodeURI</span><span class="br0">&#40;</span>uri<span class="br0">&#41;</span>;
    
    <span class="co1">// 15.1.3.4 encodeURIComponent (uriComponent)</span>
    ECMA4 native <span class="kw2">function</span> encodeURIComponent<span class="br0">&#40;</span>uriComponent<span class="br0">&#41;</span>;
&nbsp;
&nbsp;
    <span class="kw2">var</span> NaN = ECMA4::NaN;
    <span class="kw2">var</span> Infinity = ECMA4::Infinity;
    <span class="kw2">var</span> undefined = ECMA4::undefined;
&nbsp;
    <span class="kw2">var</span> <span class="kw1">eval</span> = ECMA4::<span class="kw1">eval</span>;
    <span class="kw2">var</span> parseInt = ECMA4::parseInt;
    <span class="kw2">var</span> parseFloat = ECMA4::parseFloat;
    <span class="kw2">var</span> isNaN = ECMA4::isNaN;
    <span class="kw2">var</span> isFinite = ECMA4::isFinite;
    <span class="kw2">var</span> <span class="kw1">decodeURI</span> = ECMA4::<span class="kw1">decodeURI</span>;
    <span class="kw2">var</span> decodeURIComponent = ECMA4::decodeURIComponent;
    <span class="kw2">var</span> <span class="kw1">encodeURI</span> = ECMA4::<span class="kw1">encodeURI</span>;
    <span class="kw2">var</span> encodeURIComponent = ECMA4::encodeURIComponent;
<span class="br0">&#125;</span></pre>
<p>
<strong>PROPOSAL</strong> &mdash; A global, non-deletable, non-alterable function intrinsic::hashcode(o:*):uint shall exist in every implementation.  Please see the <a href="doku.php%3Fid=proposals:hashcodes.html" class="wikilink1" title="proposals:hashcodes" onclick="return svchk()" onkeypress="return svchk()">hashcodes proposals page</a> for more information.
</p>

<p>
<strong>PROPOSAL</strong> &mdash; The expression 
</p>
<pre class="code">
    intrinsic::global
</pre>

<p>
 evaluates to a reference to the global object in effect for the calling code.  Please see the <a href="doku.php%3Fid=proposals:globals.html" class="wikilink1" title="proposals:globals" onclick="return svchk()" onkeypress="return svchk()">globals proposals page</a> for more information.
</p>

</div>
<!-- SECTION [480-2658] -->
<a name="class_objects"></a><h1>Class objects</h1>
<div class="level1">
<pre class="code javascript"><span class="kw2">package</span>
<span class="br0">&#123;</span>
    <span class="coMULTI">/* Metaclasses.
&nbsp;
       The class &quot;Class&quot; is the base class for the class metaobjects
       that are defined as the result of defining new classes, ie, the
       object that results from defining some class C is an instance
       of an internal class that directly subclasses Class.
&nbsp;
       Suppose C is defined like this:
&nbsp;
           class C
           {
               function C(a,b,c) {
                   ....
               }
           }
&nbsp;
       Let [C] denote the metaclass of C.  A class definition C
       results in the system effectively defining the class [C] as the
       following; see below for more information:
&nbsp;
           class [C] extends Class 
           {
               intrinsic function construct(a,b,c) : C!
               {
                   const o : C! = super.construct(C);  // allocate and initialize; see below
                   const x : * = o.C(o, a, b, c);      // call the constructor
                   return (x is Object) ? x to C! : o;
               }
&nbsp;
               // Static methods defined on C appear as instance methods here
&nbsp;
               // Probably much information about C
           }
&nbsp;
           const C : [C] = new [C];
&nbsp;
       where the last &quot;new&quot; is &quot;logical new&quot;; use your imagination.
&nbsp;
       (Note the use of &quot;super&quot; as scope resolution in that method.  A
       consequence of its existence is that super must be allowed in a
       similar role in static class methods in user defined classes.)
&nbsp;
       If C contains a &quot;static instrinsic construct()&quot; then that
       method replaces (without &quot;static&quot;) the generated construct
       function shown above (this follows from normal rules), and the
       only constraints on it is that it must return an object of type
       C (or a subclass of C).  It need not allocate storage.  If it
       does allocate storage, it must follow the protocol shown above,
       however.
&nbsp;
       Observe that the signature of the generated construct method reflects 
       the signature of the programmer-defined constructor.
&nbsp;
       The expression &quot;new C(e, ...)&quot; is expanded by the compiler as
       &quot;C.intrinsic::construct(e,...)&quot;.
&nbsp;
&nbsp;
       Security note.
&nbsp;
       It seems fairly clear that class &quot;Class&quot; should *not* be
       accessible to user programs; we don't want people to go around
       creating metaclasses willy-nilly. */</span>
&nbsp;
    <span class="kw2">class</span> Class
    <span class="br0">&#123;</span>
        <span class="coMULTI">/* Becomes available as Object.prototype, Boolean.prototype,
           and so on */</span>
&nbsp;
        <span class="kw2">const</span> prototype;
&nbsp;
        <span class="coMULTI">/* Magic: Instantiation.
&nbsp;
           The &quot;intrinsic construct(classobj)&quot; method of the Class
           metaclass does the following.
&nbsp;
           - allocates an instance o of a particular class (eg, &quot;C&quot;) based
             on information in the classobj
           - sets the [[Class]] of o to reflect the name of the class
           - sets the [[Prototype]] of o from classobj.prototype
           - sets o.prototype to a fresh Object instance, provided the
             Object class has been initialized.  Otherwise, it sets 
             o.prototype to null.
           - sets the constructor field of o.prototype (if not null) to
             classobj.
           - initializes fields of o to their defaults, using information
             from the classobj
           - returns o.
&nbsp;
           construct() does not call the new object's user-defined
           constructor, the client must do that.  */</span>
&nbsp;
        native intrinsic <span class="kw2">function</span> construct<span class="br0">&#40;</span>classobj : <span class="kw2">Class</span>!<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">private</span> <span class="kw2">var</span> classname : String;
        
        intrinsic <span class="kw2">function</span> getClass<span class="br0">&#40;</span><span class="br0">&#41;</span> : String! <span class="br0">&#123;</span> <span class="kw1">return</span> classname; <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* More fields here common to all metaclasses, but these are
           implementation dependent. */</span>
&nbsp;
        <span class="co1">// ...</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;</pre>
</div>
<!-- SECTION [2659-6452] -->
<a name="object_objects"></a><h1>Object objects</h1>
<div class="level1">
<pre class="code javascript">    dynamic <span class="kw2">class</span> Object 
    <span class="br0">&#123;</span>       
        <span class="kw2">use</span> <span class="kw2">namespace</span> intrinsic;
        <span class="kw2">use</span> strict;
&nbsp;
        <span class="coMULTI">/* E262-3 15.2.1.1: The Object constructor called as a function */</span>
        intrinsic static <span class="kw2">function</span> invoke<span class="br0">&#40;</span>value<span class="br0">&#41;</span>
            ToObject<span class="br0">&#40;</span>value<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.2.2.1: The Object constructor. */</span>
        <span class="coMULTI">/* magic */</span> object <span class="kw2">function</span> Object<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.2.4.2: Object.prototype.toString */</span>
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            <span class="st0">"[object "</span> + magic::getClassName<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span> + <span class="st0">"]"</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.2.4.3: Object.prototype.toLocaleString */</span>
        prototype <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toLocaleString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            <span class="st0">"[object "</span> + magic::getClassName<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span> + <span class="st0">"]"</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.2.4.4:  Object.prototype.valueOf */</span>
        prototype <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">valueOf</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="br0">&#41;</span> : Object!
            <span class="kw1">this</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.2.4.5:  Object.prototype.hasOwnProperty */</span>
        prototype <span class="kw2">function</span> hasOwnProperty<span class="br0">&#40;</span>V<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">hasOwnProperty</span><span class="br0">&#40;</span>V<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> hasOwnProperty<span class="br0">&#40;</span>V : string<span class="br0">&#41;</span> : Boolean 
            magic::hasOwnProperty<span class="br0">&#40;</span><span class="kw1">this</span>, V<span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* E262-3 15.2.4.6:  Object.prototype.isPrototypeOf */</span>
        prototype <span class="kw2">function</span> isPrototypeOf<span class="br0">&#40;</span>V<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">isPrototypeOf</span><span class="br0">&#40;</span>V<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> isPrototypeOf<span class="br0">&#40;</span>V<span class="br0">&#41;</span> : Boolean <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>!<span class="br0">&#40;</span>V <span class="kw1">is</span> Object<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">return</span> <span class="kw2">false</span>;
&nbsp;
            let VO : Object = V to Object;
            <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                VO = magic::getPrototype<span class="br0">&#40;</span>VO<span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>VO === <span class="kw2">null</span><span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="kw2">false</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>VO === <span class="kw1">this</span><span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="kw2">true</span>;
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-3 15.2.4.7: Object.prototype.propertyIsEnumerable (V) */</span>
        prototype <span class="kw2">function</span> propertyIsEnumerable<span class="br0">&#40;</span>V, E=undefined<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">propertyIsEnumerable</span><span class="br0">&#40;</span>V, E<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 draft proposals:enumerability */</span>
        intrinsic <span class="kw2">function</span> propertyIsEnumerable<span class="br0">&#40;</span>V : string, E=undefined<span class="br0">&#41;</span> : Boolean <span class="br0">&#123;</span>
            let O : Object = <span class="kw1">this</span>;
            <span class="kw1">while</span> <span class="br0">&#40;</span>O !== <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>O.<span class="me1">hasOwnProperty</span><span class="br0">&#40;</span>V<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    let old : Boolean = !magic::getPropertyIsDontEnum<span class="br0">&#40;</span>O, V<span class="br0">&#41;</span>;
                    <span class="kw1">if</span> <span class="br0">&#40;</span>!magic::getPropertyIsDontDelete<span class="br0">&#40;</span>O, V<span class="br0">&#41;</span><span class="br0">&#41;</span>
                        <span class="kw1">if</span> <span class="br0">&#40;</span>E <span class="kw1">is</span> Boolean<span class="br0">&#41;</span>
                            magic::setPropertyIsDontEnum<span class="br0">&#40;</span>O, V, !E<span class="br0">&#41;</span>;
                    <span class="kw1">return</span> old;
                <span class="br0">&#125;</span>
                O = magic::getPrototype<span class="br0">&#40;</span>O<span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-4 draft proposals:json_encoding_and_decoding */</span>
        prototype <span class="kw2">function</span> toJSONString<span class="br0">&#40;</span><span class="br0">&#41;</span> 
            <span class="kw1">this</span>.<span class="me1">toJSONString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toJSONString<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span> : string
            JSON.<span class="me1">emit</span>.<span class="me1">apply</span><span class="br0">&#40;</span><span class="kw2">null</span>, args.<span class="me1">unshift</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
    <span class="br0">&#125;</span></pre>
<p>
<strong>PROPOSAL</strong> &mdash; Please see the <a href="doku.php%3Fid=proposals:enumerability.html" class="wikilink1" title="proposals:enumerability" onclick="return svchk()" onkeypress="return svchk()">Enumerability proposal page</a> for more information.
</p>

<p>
The enumerability proposal adds a second parameter to the <code>propertyIsEnumerable()</code> method that provides write access to a property&rsquo;s internal <code>DontEnum</code> attribute.
</p>

</div>
<!-- SECTION [6453-9671] -->
<a name="function_objects"></a><h1>Function objects</h1>
<div class="level1">
<pre class="code javascript">    dynamic <span class="kw2">class</span> <span class="kw2">Function</span>
    <span class="br0">&#123;</span>       
        <span class="kw2">use</span> <span class="kw2">namespace</span> intrinsic;
        <span class="kw2">use</span> strict;
&nbsp;
        <span class="coMULTI">/* E262-3 15.3.1.1: The Function constructor.  This
           initializes the field &quot;source&quot; in the constructed object.
         */</span>
        <span class="coMULTI">/* magic */</span> native <span class="kw2">function</span> Function<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.3.1: The Function Constructor Called as a Function */</span>
        intrinsic static <span class="kw2">function</span> invoke<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>
            <span class="kw2">Function</span>.<span class="me1">construct</span>.<span class="me1">apply</span><span class="br0">&#40;</span><span class="kw2">null</span>, args<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 10.X / 13.X: function invocation.
&nbsp;
           This method is never called.  The Function constructor
           marks instances of Function specially, and recognizes these
           instances in the implementation of function calling.  The
           intrinsic invoke method is defined here to prevent
           subclasses of Function to override it.
&nbsp;
           Other parts of the class hierarchy may however create
           intrinsic invoke methods that will be considered by the
           function calling machinery. 
        */</span>
        intrinsic <span class="kw2">function</span> invoke<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">throw</span> <span class="kw2">new</span> Error<span class="br0">&#40;</span><span class="st0">"Implementation error"</span><span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* XXX: The prototype object behaves like a function (and
           system magic makes its classname be &quot;Function&quot;, though it's
           not an instance of the Function class).  So here we install
           some things in the prototype that ensures that the object
           behaves like a function in some trivial ways.
         */</span>
        prototype intrinsic <span class="kw2">function</span> invoke<span class="br0">&#40;</span><span class="br0">&#41;</span>
            undefined;
&nbsp;
        prototype <span class="kw2">var</span> source : string = <span class="st0">"function () { }"</span>;
&nbsp;
        prototype <span class="kw2">var</span> length : uint = <span class="nu0">0</span>;
&nbsp;
        <span class="coMULTI">/* XXX: Function.prototype.toString */</span>
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">source</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            source;
        
        <span class="coMULTI">/* E262-3 15.3.4.3: Function.prototype.apply */</span>
        prototype <span class="kw2">function</span> apply<span class="br0">&#40;</span>thisArg, argArray<span class="br0">&#41;</span>
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span><span class="kw1">this</span>, thisArg, argArray<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> apply<span class="br0">&#40;</span>thisArg, argArray<span class="br0">&#41;</span> : *
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span><span class="kw1">this</span>, thisArg, argArray<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 draft: &quot;apply&quot; and &quot;call&quot; are static methods on the
           Function object, and everyone eventually ends up in
           Function.apply().
&nbsp;
           Note ES4 bug fix: the arguments object is an 'Array', so the test
           for applicability of argArray is simpler than in ES3.
        */</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> apply<span class="br0">&#40;</span>fn : <span class="kw2">Function</span>!, thisArg, argArray<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>thisArg === undefined || thisArg === <span class="kw2">null</span><span class="br0">&#41;</span>
                thisArg = global;
            <span class="kw1">if</span> <span class="br0">&#40;</span>argArray === undefined || argArray === <span class="kw2">null</span><span class="br0">&#41;</span>
                argArray = <span class="br0">&#91;</span><span class="br0">&#93;</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>!<span class="br0">&#40;</span>argArray <span class="kw1">is</span> Array<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">throw</span> <span class="kw2">new</span> TypeError<span class="br0">&#40;</span><span class="st0">"argument array to 'apply' must be Array"</span><span class="br0">&#41;</span>;
            <span class="kw1">return</span> magic::apply<span class="br0">&#40;</span>fn, thisArg, argArray<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-3 15.3.4.4: Function.prototype.call.
&nbsp;
           Assuming a rest argument does not contribute to the
           &quot;length&quot; of the function, so the length of
           Function.prototype.call is 1, which is what we want. 
        */</span>
        prototype <span class="kw2">function</span> call<span class="br0">&#40;</span>thisObj, ...<span class="me1">args</span><span class="br0">&#41;</span>
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span><span class="kw1">this</span>, thisObj, args<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> call<span class="br0">&#40;</span>thisObj, ...<span class="me1">args</span>:Array<span class="br0">&#41;</span>:*
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span><span class="kw1">this</span>, thisObj, args<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 draft: &quot;apply&quot; and &quot;call&quot; are static methods on the
           Function object. */</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> call<span class="br0">&#40;</span>thisObj, ...<span class="me1">args</span>:Array<span class="br0">&#41;</span>:*
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span><span class="kw1">this</span>, thisObj, args<span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* E262-3 15.3.5.3: [[HasInstance]] */</span>
        intrinsic <span class="kw2">function</span> HasInstance<span class="br0">&#40;</span>V<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>!<span class="br0">&#40;</span>V <span class="kw1">is</span> Object<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">return</span> <span class="kw2">false</span>;
&nbsp;
            let O : Object = <span class="kw1">this</span>.<span class="me1">prototype</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>!<span class="br0">&#40;</span>O <span class="kw1">is</span> Object<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">throw</span> <span class="kw2">new</span> TypeError<span class="br0">&#40;</span><span class="st0">"[[HasInstance]]: prototype is not object"</span><span class="br0">&#41;</span>;
&nbsp;
            <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                V = magic::getPrototype<span class="br0">&#40;</span>V<span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>V === <span class="kw2">null</span><span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="kw2">false</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>O == V<span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="kw2">true</span>;
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">var</span> source : string;  <span class="coMULTI">/* Source code for decompilation, installed by the constructor */</span>
    <span class="br0">&#125;</span></pre>
</div>
<!-- SECTION [9672-13910] -->
<a name="array_objects"></a><h1>Array objects</h1>
<div class="level1">
<pre class="code javascript">    dynamic <span class="kw2">class</span> Array <span class="kw2">extends</span> Object
    <span class="br0">&#123;</span>
        <span class="kw2">use</span> <span class="kw2">namespace</span> intrinsic;
        <span class="kw2">use</span> strict;
&nbsp;
        <span class="co1">// 15.4.1 The Array Constructor Called as a Function</span>
        static intrinsic <span class="kw2">function</span> invoke<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="co1">// args is already an Array. just return it.</span>
            <span class="kw1">return</span> args;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// 15.4.2 The Array Constructor</span>
        <span class="co1">// 15.4.2.1 new Array( [ item0 [ , item1 [ , ... ] ] ] )</span>
        <span class="co1">// 15.4.2.2 new Array(len)</span>
        <span class="co1">//</span>
        <span class="co1">// Here we rely on magic or optimization, since the Array</span>
        <span class="co1">// constructor takes a variable number of arguments, which</span>
        <span class="co1">// itself requires an array to be constructed.</span>
        <span class="co1">//</span>
        <span class="co1">// Optimization gets around this by avoiding allocation of the</span>
        <span class="co1">// array if all references to args is in the form of</span>
        <span class="co1">// args.length and args[n].</span>
        <span class="co1">//</span>
        <span class="co1">// Magic would solve this by creating an array without</span>
        <span class="co1">// invoking the array constructor, ie, essentially making this</span>
        <span class="co1">// code pointless.</span>
&nbsp;
        <span class="kw2">function</span> Array<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let argslen:uint = uint<span class="br0">&#40;</span>args.<span class="me1">length</span><span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>argslen == <span class="nu0">1</span> &amp;&amp; <span class="br0">&#40;</span>args<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">is</span> Number<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                let dlen:Number = args<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>;
                let ulen:uint = uint<span class="br0">&#40;</span>dlen<span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>ulen != dlen<span class="br0">&#41;</span>
                    <span class="kw1">throw</span> <span class="kw2">new</span> RangeError;
                length = ulen;
            <span class="br0">&#125;</span>
            <span class="kw1">else</span> <span class="br0">&#123;</span>
                length = argslen;
                <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; argslen; i++<span class="br0">&#41;</span>
                    <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span> = args<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// 15.4.4 Properties of the Array Prototype Object</span>
        <span class="co1">// prototype.[[Prototype]] = prototype;</span>
        <span class="co1">// prototype.[[Class]] = &quot;Array&quot;;</span>
        prototype._length = <span class="nu0">0</span>;
&nbsp;
        <span class="co1">// 15.4.4.2 Array.prototype.toString ( )</span>
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="kw1">this</span>:Array<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">join</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span>:String
            <span class="kw1">this</span>.<span class="me1">join</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.3 Array.prototype.toLocaleString ( )</span>
        prototype <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="kw1">this</span>:Array<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toLocaleString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="br0">&#41;</span>:String <span class="br0">&#123;</span>
            let out:String = <span class="st0">""</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>, n:uint = a.<span class="me1">length</span>; i &lt; n; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>i != <span class="nu0">0</span><span class="br0">&#41;</span>
                    out += <span class="st0">","</span>;
                let x = a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>x != <span class="kw2">null</span><span class="br0">&#41;</span>
                    out += x.<span class="me1">toLocaleString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> out;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// 15.4.4.4 Array.prototype.concat ( [ item1 [ , item2 [ , â€¦ ] ] ] )</span>
        <span class="kw2">private</span> static <span class="kw2">function</span> concatHelper<span class="br0">&#40;</span>self, args<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let out:Array = <span class="kw2">new</span> Array;
            let outlen:uint = <span class="nu0">0</span>;
&nbsp;
            <span class="kw1">if</span> <span class="br0">&#40;</span>self <span class="kw1">is</span> Array<span class="br0">&#41;</span>
                args.<span class="me1">unshift</span><span class="br0">&#40;</span>self<span class="br0">&#41;</span>;
&nbsp;
            let argslen:uint = args.<span class="me1">length</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; argslen; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                let x = args<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>x <span class="kw1">is</span> Array<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    let xlen:uint = x._length;
                    <span class="kw1">for</span> <span class="br0">&#40;</span>let j:uint = <span class="nu0">0</span>; j &lt; xlen; j++<span class="br0">&#41;</span>
                        out<span class="br0">&#91;</span>outlen<span class="br0">&#93;</span> = x<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
                    outlen++;
                    <span class="kw1">continue</span>;
                <span class="br0">&#125;</span>
                out<span class="br0">&#91;</span>outlen++<span class="br0">&#93;</span> = x;
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">return</span> out;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> concat<span class="br0">&#40;</span>self, ...<span class="me1">args</span><span class="br0">&#41;</span>
            concatHelper<span class="br0">&#40;</span>self, args<span class="br0">&#41;</span>;
&nbsp;
        prototype <span class="kw2">function</span> concat<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>
            concatHelper<span class="br0">&#40;</span><span class="kw1">this</span>, args<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> concat<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>:Array
            concatHelper<span class="br0">&#40;</span><span class="kw1">this</span>, args<span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.5 Array.prototype.join (separator)</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> join<span class="br0">&#40;</span>self, sep = undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let s:String = <span class="br0">&#40;</span>sep === undefined<span class="br0">&#41;</span> ? <span class="st0">","</span> : String<span class="br0">&#40;</span>sep<span class="br0">&#41;</span>;
            let out:String = <span class="st0">""</span>;
            let len:uint = self.<span class="me1">length</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; len; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>i != <span class="nu0">0</span><span class="br0">&#41;</span>
                    out += s;
                let x = self<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>x != <span class="kw2">null</span><span class="br0">&#41;</span>
                    out += String<span class="br0">&#40;</span>x<span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> out;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> join<span class="br0">&#40;</span>sep = undefined<span class="br0">&#41;</span>
            Array.<span class="me1">join</span><span class="br0">&#40;</span><span class="kw1">this</span>, sep<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> join<span class="br0">&#40;</span>sep = undefined<span class="br0">&#41;</span>:String
            Array.<span class="me1">join</span><span class="br0">&#40;</span><span class="kw1">this</span>, sep<span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.6 Array.prototype.pop ( )</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> pop<span class="br0">&#40;</span>self<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let len:uint = self.<span class="me1">length</span>;
&nbsp;
            <span class="kw1">if</span> <span class="br0">&#40;</span>len != <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                let x = self<span class="br0">&#91;</span>--len<span class="br0">&#93;</span>;
                <span class="kw1">delete</span> self<span class="br0">&#91;</span>len<span class="br0">&#93;</span>;
                self.<span class="me1">length</span> = len;
                <span class="kw1">return</span> x;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> undefined;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> pop<span class="br0">&#40;</span><span class="br0">&#41;</span>
            Array.<span class="me1">pop</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> pop<span class="br0">&#40;</span><span class="br0">&#41;</span>:*
            Array.<span class="me1">pop</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.7 Array.prototype.push ( [ item1 [ , item2 [ , â€¦ ] ] ] )</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> pushHelper<span class="br0">&#40;</span>self, args<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let len:uint = self.<span class="me1">length</span>;
            let argslen:uint = args.<span class="me1">length</span>;
&nbsp;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; argslen; i++<span class="br0">&#41;</span>
                self<span class="br0">&#91;</span>len++<span class="br0">&#93;</span> = args<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            self.<span class="me1">length</span> = len;
            <span class="kw1">return</span> len;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> push<span class="br0">&#40;</span>self, ...<span class="me1">args</span><span class="br0">&#41;</span>
            Array.<span class="me1">pushHelper</span><span class="br0">&#40;</span><span class="kw1">this</span>, args<span class="br0">&#41;</span>;
&nbsp;
        prototype <span class="kw2">function</span> push<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>
            Array.<span class="me1">pushHelper</span><span class="br0">&#40;</span><span class="kw1">this</span>, args<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> push<span class="br0">&#40;</span>...<span class="me1">args</span>:Array<span class="br0">&#41;</span>:uint
            Array.<span class="me1">pushHelper</span><span class="br0">&#40;</span><span class="kw1">this</span>, args<span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.8 Array.prototype.reverse ( )</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> reverse<span class="br0">&#40;</span>self<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let i:uint = <span class="nu0">0</span>;
            let j:uint = self.<span class="me1">length</span>;
            let h:uint = j &gt;&gt;&gt; <span class="nu0">1</span>;
&nbsp;
            <span class="kw1">while</span> <span class="br0">&#40;</span>i &lt; h<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                --j;
                <span class="br0">&#91;</span>self<span class="br0">&#91;</span>i<span class="br0">&#93;</span>, self<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#93;</span> = <span class="br0">&#91;</span>self<span class="br0">&#91;</span>j<span class="br0">&#93;</span>, self<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
                i++;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> self;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> reverse<span class="br0">&#40;</span><span class="br0">&#41;</span>
            Array.<span class="me1">reverse</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> reverse<span class="br0">&#40;</span><span class="br0">&#41;</span>:Array
            Array.<span class="me1">reverse</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.9 Array.prototype.shift ( )</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> shift<span class="br0">&#40;</span>self<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let len:uint = self.<span class="me1">length</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>len == <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                self.<span class="me1">length</span> = <span class="nu0">0</span>;        <span class="co1">// ECMA-262 requires explicit set here</span>
                <span class="kw1">return</span> undefined;
            <span class="br0">&#125;</span>
&nbsp;
            <span class="co1">// Get the 0th element to return</span>
            let x = self<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>;
&nbsp;
            <span class="co1">// Move all of the elements down</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">1</span>; i &lt; len; i++<span class="br0">&#41;</span>
                self<span class="br0">&#91;</span>i-<span class="nu0">1</span><span class="br0">&#93;</span> = self<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            <span class="kw1">delete</span> self<span class="br0">&#91;</span>len - <span class="nu0">1</span><span class="br0">&#93;</span>;
            self.<span class="me1">length</span> = len - <span class="nu0">1</span>;
            <span class="kw1">return</span> x;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> shift<span class="br0">&#40;</span><span class="br0">&#41;</span>
            Array.<span class="me1">shift</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> shift<span class="br0">&#40;</span><span class="br0">&#41;</span>
            Array.<span class="me1">shift</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.10 Array.prototype.slice (start, end)</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> slice<span class="br0">&#40;</span>self, start, end<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>start === undefined<span class="br0">&#41;</span>
                start = <span class="nu0">0</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>end === undefined<span class="br0">&#41;</span>
                end = Infinity;
&nbsp;
            let len:uint = uint<span class="br0">&#40;</span>self.<span class="me1">length</span><span class="br0">&#41;</span>;
&nbsp;
            <span class="co1">// If a param is passed then the first one is start.</span>
            <span class="co1">// If no params are passed then start = 0.</span>
            let a:uint = clamp<span class="br0">&#40;</span>start, len<span class="br0">&#41;</span>;
            let b:uint = clamp<span class="br0">&#40;</span>end, len<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>b &lt; a<span class="br0">&#41;</span>
                b = a;
&nbsp;
            let out:Array = <span class="kw2">new</span> Array;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = a; i &lt; b; i++<span class="br0">&#41;</span>
                out.<span class="me1">push</span><span class="br0">&#40;</span>self<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
&nbsp;
            <span class="kw1">return</span> out;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> slice<span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>
            Array.<span class="me1">slice</span><span class="br0">&#40;</span><span class="kw1">this</span>, start, end<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> slice<span class="br0">&#40;</span>start:double = <span class="nu0">0</span>, end:double = Infinity<span class="br0">&#41;</span>:Array
            Array.<span class="me1">slice</span><span class="br0">&#40;</span><span class="kw1">this</span>, start, end<span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.11 Array.prototype.sort (comparefn)</span>
        <span class="co1">// INFORMATIVE: this is an implementation that meets the spec, but the spec</span>
        <span class="co1">// allows for different sort implementations (quicksort is not required)</span>
        type Comparator = <span class="kw2">function</span> <span class="br0">&#40;</span>x:*, y:*<span class="br0">&#41;</span>:double;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> sort<span class="br0">&#40;</span>self, comparefn<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let len:uint = self.<span class="me1">length</span>;
&nbsp;
            <span class="kw1">if</span> <span class="br0">&#40;</span>len &gt; <span class="nu0">1</span><span class="br0">&#41;</span>
                qsort<span class="br0">&#40;</span><span class="nu0">0</span>, len-<span class="nu0">1</span>, comparefn<span class="br0">&#41;</span>;
&nbsp;
            <span class="kw1">return</span> self;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> sort<span class="br0">&#40;</span>comparefn<span class="br0">&#41;</span>
            Array.<span class="me1">sort</span><span class="br0">&#40;</span><span class="kw1">this</span>, comparefn<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> sort<span class="br0">&#40;</span>comparefn:Comparator<span class="br0">&#41;</span>:Array
            Array.<span class="me1">sort</span><span class="br0">&#40;</span><span class="kw1">this</span>, comparefn<span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.12 Array.prototype.splice (start, deleteCount [ , item1 [ , item2 [ , â€¦ ] ] ] )</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> splice<span class="br0">&#40;</span>self, start, deleteCount<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let out:Array = <span class="kw2">new</span> Array<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
            let argslen:uint = uint<span class="br0">&#40;</span>args.<span class="me1">length</span><span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>argslen == <span class="nu0">0</span><span class="br0">&#41;</span>
                <span class="kw1">return</span> undefined;
&nbsp;
            let len:uint = self.<span class="me1">length</span>;
            let start:uint = clamp<span class="br0">&#40;</span>double<span class="br0">&#40;</span>args<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span>, len<span class="br0">&#41;</span>;
            let d_deleteCount:double = argslen &gt; <span class="nu0">1</span> ? double<span class="br0">&#40;</span>args<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span> : <span class="br0">&#40;</span>len - start<span class="br0">&#41;</span>;
            let deleteCount:uint = <span class="br0">&#40;</span>d_deleteCount &lt; <span class="nu0">0</span><span class="br0">&#41;</span> ? <span class="nu0">0</span> : uint<span class="br0">&#40;</span>d_deleteCount<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>deleteCount &gt; len - start<span class="br0">&#41;</span>
                deleteCount = len - start;
&nbsp;
            let end:uint = start + deleteCount;
&nbsp;
            <span class="co1">// Copy out the elements we are going to remove</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; deleteCount; i++<span class="br0">&#41;</span>
                out.<span class="me1">push</span><span class="br0">&#40;</span>self<span class="br0">&#91;</span>i + start<span class="br0">&#93;</span><span class="br0">&#41;</span>;
&nbsp;
            let insertCount:uint = <span class="br0">&#40;</span>argslen &gt; <span class="nu0">2</span><span class="br0">&#41;</span> ? <span class="br0">&#40;</span>argslen - <span class="nu0">2</span><span class="br0">&#41;</span> : <span class="nu0">0</span>;
            let l_shiftAmount:double = insertCount - deleteCount;
            let shiftAmount:uint;
&nbsp;
            <span class="co1">// delete items by shifting elements past end (of delete) by l_shiftAmount</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>l_shiftAmount &lt; <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="co1">// Shift the remaining elements down</span>
                shiftAmount = uint<span class="br0">&#40;</span>-l_shiftAmount<span class="br0">&#41;</span>;
&nbsp;
                <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = end; i &lt; len; i++<span class="br0">&#41;</span>
                    self<span class="br0">&#91;</span>i - shiftAmount<span class="br0">&#93;</span> = self<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
&nbsp;
                <span class="co1">// delete top elements here to match ECMAscript spec (generic object support)</span>
                <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = len - shiftAmount; i &lt; len; i++<span class="br0">&#41;</span>
                    <span class="kw1">delete</span> self<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">else</span> <span class="br0">&#123;</span>
                <span class="co1">// Shift the remaining elements up.</span>
                shiftAmount = uint<span class="br0">&#40;</span>l_shiftAmount<span class="br0">&#41;</span>;
&nbsp;
                <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = len; i &gt; end; <span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    --i;
                    self<span class="br0">&#91;</span>i + shiftAmount<span class="br0">&#93;</span> = self<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="co1">// Add the items to insert</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; insertCount; i++<span class="br0">&#41;</span>
                self<span class="br0">&#91;</span>start+i<span class="br0">&#93;</span> = args<span class="br0">&#91;</span>i + <span class="nu0">2</span><span class="br0">&#93;</span>;
&nbsp;
            <span class="co1">// shrink array if shiftAmount is negative</span>
            self.<span class="me1">length</span> = len + l_shiftAmount;
            <span class="kw1">return</span> out;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> splice<span class="br0">&#40;</span>start, deleteCount<span class="br0">&#41;</span>
            Array.<span class="me1">splice</span><span class="br0">&#40;</span><span class="kw1">this</span>, arguments<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> splice<span class="br0">&#40;</span>...<span class="me1">args</span>:Array<span class="br0">&#41;</span>:Array
            Array.<span class="me1">splice</span><span class="br0">&#40;</span><span class="kw1">this</span>, arguments<span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.4.4.13 Array.prototype.unshift ( [ item1 [ , item2 [ , â€¦ ] ] ] )</span>
        prototype <span class="kw2">function</span> unshift<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">unshift</span><span class="br0">&#40;</span><span class="kw1">this</span>, args<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> unshift<span class="br0">&#40;</span>...<span class="me1">args</span>:Array<span class="br0">&#41;</span>:uint <span class="br0">&#123;</span>
            let len:uint = <span class="kw1">this</span>.<span class="me1">length</span>;
            let argslen:uint = uint<span class="br0">&#40;</span>args.<span class="me1">length</span><span class="br0">&#41;</span>;
            let k:uint = len;
            <span class="kw1">while</span> <span class="br0">&#40;</span>k != <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                k--;
                let d:uint = k + argslen;
                <span class="kw1">if</span> <span class="br0">&#40;</span>k <span class="kw1">in</span> <span class="kw1">this</span><span class="br0">&#41;</span>
                    <span class="kw1">this</span><span class="br0">&#91;</span>d<span class="br0">&#93;</span> = <span class="kw1">this</span><span class="br0">&#91;</span>k<span class="br0">&#93;</span>;
                <span class="kw1">else</span>
                    <span class="kw1">delete</span> <span class="kw1">this</span><span class="br0">&#91;</span>d<span class="br0">&#93;</span>;
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; argslen; i++<span class="br0">&#41;</span>
                <span class="kw1">this</span><span class="br0">&#91;</span>k++<span class="br0">&#93;</span> = args<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
&nbsp;
            len += argslen;
            <span class="kw1">this</span>.<span class="me1">length</span> = len;
            <span class="kw1">return</span> len;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// 15.4.5.1 [[Put]] (P, V)</span>
        <span class="co1">// @todo: ensure that catchall-set for undeclared properties runs on every set</span>
        <span class="kw2">function</span> set *<span class="br0">&#40;</span>id, value<span class="br0">&#41;</span>:<span class="kw1">void</span> <span class="br0">&#123;</span>
            let oldLength:uint = <span class="kw1">this</span>.<span class="me1">length</span>;
            <span class="kw1">this</span>.<span class="me1">set</span><span class="br0">&#40;</span>id, value<span class="br0">&#41;</span>;
            let idAsDouble:double = double<span class="br0">&#40;</span>id<span class="br0">&#41;</span>;
            let idAsUint:uint = uint<span class="br0">&#40;</span>idAsDouble<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>idAsUint == idAsDouble &amp;&amp; idAsUint &gt;= oldLength<span class="br0">&#41;</span>
                <span class="kw1">this</span>.<span class="me1">length</span> = idAsUint+<span class="nu0">1</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// 15.4.5.2 length</span>
        <span class="kw2">private</span> <span class="kw2">var</span> _length:uint = <span class="nu0">0</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get length<span class="br0">&#40;</span><span class="br0">&#41;</span>:uint
            <span class="kw1">this</span>.<span class="me1">length</span>;
&nbsp;
        <span class="co1">// ECMA-262 requires a RangeError if non-ints are passed in,</span>
        <span class="co1">// so we must not type it as uint in the setter's signature</span>
        <span class="kw2">public</span> <span class="kw2">function</span> set length<span class="br0">&#40;</span>newLength:*<span class="br0">&#41;</span>:<span class="kw1">void</span> <span class="br0">&#123;</span>
            let oldLength:uint = length;
            let newLengthAsDouble:double = double<span class="br0">&#40;</span>newLength<span class="br0">&#41;</span>;
            let newLengthAsUint:uint = uint<span class="br0">&#40;</span>newLengthAsDouble<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>newLengthAsUint != newLengthAsDouble<span class="br0">&#41;</span>
                <span class="kw1">throw</span> <span class="kw2">new</span> RangeError<span class="br0">&#40;</span><span class="br0">&#41;</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = newLengthAsUint; i &lt; oldLength; ++i<span class="br0">&#41;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw1">this</span>.<span class="me1">hasOwnProperty</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="kw1">delete</span> <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            length = newLengthAsUint;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// --------------------------------------------------</span>
        <span class="co1">// private utility methods</span>
        <span class="co1">// --------------------------------------------------</span>
        <span class="kw2">private</span> static <span class="kw2">function</span> clamp<span class="br0">&#40;</span>intValue:double, len:uint<span class="br0">&#41;</span>:uint
        <span class="br0">&#123;</span>
            <span class="kw1">return</span> <span class="br0">&#40;</span>intValue &lt; <span class="nu0">0</span>.<span class="nu0">0</span><span class="br0">&#41;</span>
                 ? <span class="br0">&#40;</span>intValue + len &lt; <span class="nu0">0</span>.<span class="nu0">0</span><span class="br0">&#41;</span> ? <span class="nu0">0</span> : uint<span class="br0">&#40;</span>intValue + len<span class="br0">&#41;</span>
                 : <span class="br0">&#40;</span>intValue &gt; len<span class="br0">&#41;</span> ? len : uint<span class="br0">&#40;</span>intValue<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">private</span> <span class="kw2">function</span> compare<span class="br0">&#40;</span>j:uint, k:uint, comparefn:Comparator<span class="br0">&#41;</span>:double <span class="br0">&#123;</span>
            let x = <span class="kw1">this</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
            let y = <span class="kw1">this</span><span class="br0">&#91;</span>k<span class="br0">&#93;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>x === undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>y === undefined<span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="nu0">0</span>;
                <span class="kw1">return</span> <span class="nu0">1</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>y === undefined<span class="br0">&#41;</span>
                <span class="kw1">return</span> -<span class="nu0">1</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>comparefn === undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                x = x.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
                y = y.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>x &lt; y<span class="br0">&#41;</span> <span class="kw1">return</span> -<span class="nu0">1</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>x &gt; y<span class="br0">&#41;</span> <span class="kw1">return</span> <span class="nu0">1</span>;
                <span class="kw1">return</span> <span class="nu0">0</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> comparefn<span class="br0">&#40;</span>x, y<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// INFORMATIVE note: as noted above, this is a very simple recursive</span>
        <span class="co1">// implementation of Quicksort.  While it suffices for spec purposes,</span>
        <span class="co1">// it is not efficient enough for a real implementation, which</span>
        <span class="co1">// typically faces mostly-ordered inputs.  It is also not a stable</span>
        <span class="co1">// sort, which may be desirable but is not required by the spec</span>
&nbsp;
        <span class="kw2">private</span> <span class="kw2">function</span> qsort<span class="br0">&#40;</span>lo:uint, hi:uint, comparefn:Comparator<span class="br0">&#41;</span>:<span class="kw1">void</span> <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>lo &gt;= hi<span class="br0">&#41;</span>
                <span class="kw1">return</span>;
&nbsp;
            let size:uint  = <span class="br0">&#40;</span>hi - lo<span class="br0">&#41;</span> + <span class="nu0">1</span>;
            let pivot:uint = lo + <span class="br0">&#40;</span>size / <span class="nu0">2</span><span class="br0">&#41;</span>;
            let i:uint = lo;
            let j:uint = hi;
            <span class="kw1">while</span> <span class="br0">&#40;</span>i &lt;= j<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">while</span> <span class="br0">&#40;</span>compare<span class="br0">&#40;</span>i, pivot, comparefn<span class="br0">&#41;</span> &lt; <span class="nu0">0</span><span class="br0">&#41;</span>
                    ++i;
                <span class="kw1">while</span> <span class="br0">&#40;</span>compare<span class="br0">&#40;</span>j, pivot, comparefn<span class="br0">&#41;</span> &gt; <span class="nu0">0</span><span class="br0">&#41;</span>
                    --j;
                <span class="kw1">if</span> <span class="br0">&#40;</span>i &lt;= j<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    let temp = <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                    <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span> = <span class="kw1">this</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
                    <span class="kw1">this</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span> = temp;
                    ++i;
                    --j;
                <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw1">if</span> <span class="br0">&#40;</span>lo &lt; j<span class="br0">&#41;</span>
                qsort<span class="br0">&#40;</span>lo, j, comparefn<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>i &lt; hi<span class="br0">&#41;</span>
                qsort<span class="br0">&#40;</span>i, hi, comparefn<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">// Array &quot;extras&quot; from JS1.6 (@todo: and JS1.8 -- reduce/reduceRight)</span>
        <span class="co1">// See http://developer.mozilla.org/en/docs/New_in_JavaScript_1.6#Array_extras</span>
        <span class="co1">// The callback function typically takes (item, i, list) parameters</span>
        type Mapper  = <span class="kw2">function</span> <span class="br0">&#40;</span>_:*, _:uint, _:Object<span class="br0">&#41;</span>:*;
        type Eacher  = <span class="kw2">function</span> <span class="br0">&#40;</span>_:*, _:uint, _:Object<span class="br0">&#41;</span>:<span class="kw1">void</span>;
        type Checker = <span class="kw2">function</span> <span class="br0">&#40;</span>_:*, _:uint, _:Object<span class="br0">&#41;</span>:Boolean;
        type Reducer = <span class="kw2">function</span> <span class="br0">&#40;</span>_:*, _:*, _:uint, _:Object<span class="br0">&#41;</span>:*;
&nbsp;
        prototype <span class="kw2">function</span> map<span class="br0">&#40;</span>mapper, thisObj<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">map</span><span class="br0">&#40;</span>mapper, thisObj<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> map<span class="br0">&#40;</span>mapper:Mapper, thisObj:Object<span class="br0">&#41;</span>:Array <span class="br0">&#123;</span>
            let result:Array = <span class="br0">&#91;</span><span class="br0">&#93;</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; <span class="kw1">this</span>.<span class="me1">length</span>; i++<span class="br0">&#41;</span>
                result<span class="br0">&#91;</span>i<span class="br0">&#93;</span> = mapper.<span class="me1">call</span><span class="br0">&#40;</span>thisObj, <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>, i, <span class="kw1">this</span><span class="br0">&#41;</span>;
            <span class="kw1">return</span> result;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> filter<span class="br0">&#40;</span>checker, thisObj<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">filter</span><span class="br0">&#40;</span>checker, thisObj<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> filter<span class="br0">&#40;</span>checker:Checker, thisObj:Object<span class="br0">&#41;</span>:Array <span class="br0">&#123;</span>
            let result:Array = <span class="br0">&#91;</span><span class="br0">&#93;</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; <span class="kw1">this</span>.<span class="me1">length</span>; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                let <span class="kw1">item</span> = <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>checker.<span class="me1">call</span><span class="br0">&#40;</span>thisObj, <span class="kw1">item</span>, i, <span class="kw1">this</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                    result<span class="br0">&#91;</span>result.<span class="me1">length</span><span class="br0">&#93;</span> = <span class="kw1">item</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> result;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> every<span class="br0">&#40;</span>checker, thisObj<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">every</span><span class="br0">&#40;</span>checker, thisObj<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> every<span class="br0">&#40;</span>checker:Checker, thisObj:Object<span class="br0">&#41;</span>:Boolean <span class="br0">&#123;</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; <span class="kw1">this</span>.<span class="me1">length</span>; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>!checker.<span class="me1">call</span><span class="br0">&#40;</span>thisObj, <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>, i, <span class="kw1">this</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="kw2">false</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> <span class="kw2">true</span>;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> some<span class="br0">&#40;</span>checker, thisObj<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">some</span><span class="br0">&#40;</span>checker, thisObj<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> some<span class="br0">&#40;</span>checker:Checker, thisObj:Object<span class="br0">&#41;</span>:Boolean <span class="br0">&#123;</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span>let i:uint = <span class="nu0">0</span>; i &lt; <span class="kw1">this</span>.<span class="me1">length</span>; i++<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>checker.<span class="me1">call</span><span class="br0">&#40;</span>thisObj, <span class="kw1">this</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>, i, <span class="kw1">this</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="kw2">true</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> <span class="kw2">false</span>;
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span></pre>
</div>
<!-- SECTION [13911-30687] -->
<a name="string_objects"></a><h1>String objects</h1>
<div class="level1">
<pre class="code javascript"><span class="kw2">package</span>
<span class="br0">&#123;</span>
    <span class="kw2">use</span> <span class="kw2">namespace</span> intrinsic;
    <span class="kw2">use</span> strict;
&nbsp;
    <span class="coMULTI">/* The January 2007 meeting resolved that String is open and
       dynamic, and the implementations will just have to work a
       little harder.  Go ECMA!  */</span>
    dynamic <span class="kw2">class</span> String
    <span class="br0">&#123;</span>       
        <span class="coMULTI">/* E262-3 15.5.1: The String Constructor Called as a Function */</span>
        static intrinsic <span class="kw2">function</span> invoke<span class="br0">&#40;</span>value<span class="br0">&#41;</span>
            <span class="kw1">return</span> arguments.<span class="me1">length</span> === <span class="nu0">0</span> ? <span class="st0">""</span> : ToString<span class="br0">&#40;</span>value<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* 15.5.2 The String Constructor 
           Be careful to always return a new String object here, so don't
           optimize by returning the return value of 
         */</span>
        <span class="kw2">function</span> String<span class="br0">&#40;</span>v<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>arguments.<span class="me1">length</span> === <span class="nu0">0</span><span class="br0">&#41;</span>
                value = <span class="st0">""</span>;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>v <span class="kw1">instanceof</span> string<span class="br0">&#41;</span>
                value = v;
            <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>v <span class="kw1">instanceof</span> String<span class="br0">&#41;</span>
                value = v.<span class="me1">value</span>;
            <span class="kw1">else</span>
                value = ToString<span class="br0">&#40;</span>value<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">var</span> value : string = <span class="st0">""</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.3.2: String.fromCharCode
           E262-4 draft proposals:bug_fixes - FUNCTION.LENGTH
        */</span>
        <span class="kw2">public</span> static <span class="kw2">function</span> fromCharCode<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span>string.<span class="me1">fromCharCodeHelper</span>, <span class="kw2">null</span>, args<span class="br0">&#41;</span>;
&nbsp;
        intrinsic static <span class="kw2">function</span> fromCharCode<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span> : double
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span>string.<span class="me1">fromCharCodeHelper</span>, <span class="kw2">null</span>, args<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.2: String.prototype.toString */</span>
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="kw1">this</span> : String<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span> : String
            value;
        
        <span class="coMULTI">/* E262-3 15.5.4.3: String.prototype.valueOf */</span>
        prototype <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="kw1">this</span> : String<span class="br0">&#41;</span>
            <span class="kw1">this</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="br0">&#41;</span> : Object
            <span class="kw1">this</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.4: String.prototype.charAt
           E262-4 draft proposals:static_generics
        */</span>
        prototype <span class="kw2">function</span> charAt<span class="br0">&#40;</span>pos<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">charAt</span><span class="br0">&#40;</span>pos<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> charAt<span class="br0">&#40;</span>self, pos<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">charAt</span><span class="br0">&#40;</span>pos<span class="br0">&#41;</span>;
            
        intrinsic <span class="kw2">function</span> charAt<span class="br0">&#40;</span>pos: double = <span class="nu0">0</span><span class="br0">&#41;</span> : String
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">charAt</span><span class="br0">&#40;</span>pos<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.5: String.prototype.charCodeAt
           E262-4 draft proposals:static_generics
        */</span>
        prototype <span class="kw2">function</span> charCodeAt<span class="br0">&#40;</span>pos<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">charCodeAt</span><span class="br0">&#40;</span>pos<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> charCodeAt<span class="br0">&#40;</span>self, pos<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">charCodeAt</span><span class="br0">&#40;</span>pos<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> charCodeAt<span class="br0">&#40;</span>pos: double = <span class="nu0">0</span><span class="br0">&#41;</span> : double
            value.<span class="me1">charCodeAt</span><span class="br0">&#40;</span>pos<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.6: String.prototype.concat.
           E262-4 draft proposals:static_generics
           E262-4 draft proposals:bug_fixes - FUNCTION.LENGTH
         */</span>
        prototype <span class="kw2">function</span> concat<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span>string.<span class="me1">concat</span>, ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>, args<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> concat<span class="br0">&#40;</span>self, ...<span class="me1">args</span><span class="br0">&#41;</span>
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span>string.<span class="me1">concat</span>, ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>, args<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> concat<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span> : String
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span>string.<span class="me1">concat</span>, value, args<span class="br0">&#41;</span>;
&nbsp;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.7: String.prototype.indexOf
           E262-4 draft proposals:static_generics
           E262-4 draft proposals:bug_fixes - FUNCTION.LENGTH
        */</span>
        prototype <span class="kw2">function</span> indexOf<span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> indexOf<span class="br0">&#40;</span>self, searchString, position<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">indexOf</span><span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> indexOf<span class="br0">&#40;</span>searchString: String!, position: double = <span class="nu0">0</span>.<span class="nu0">0</span><span class="br0">&#41;</span> : double 
            value.<span class="me1">indexOf</span><span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.8: String.prototype.lastIndexOf
           E262-4 draft proposals:static_generics
           E262-4 draft proposals:bug_fixes - FUNCTION.LENGTH
        */</span>
        prototype <span class="kw2">function</span> lastIndexOf<span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">lastIndexOf</span><span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> lastIndexOf<span class="br0">&#40;</span>self, searchString, position<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">lastIndexOf</span><span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> lastIndexOf<span class="br0">&#40;</span>searchString: String!, position: double<span class="br0">&#41;</span> : double 
            value.<span class="me1">lastIndexOf</span><span class="br0">&#40;</span>searchString, position<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.9: String.prototype.localeCompare 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> localeCompare<span class="br0">&#40;</span>that<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">localeCompare</span><span class="br0">&#40;</span>that<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> localeCompare<span class="br0">&#40;</span>self, that<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">localeCompare</span><span class="br0">&#40;</span>that<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> localeCompare<span class="br0">&#40;</span>that : String!<span class="br0">&#41;</span> : double
            value.<span class="me1">localeCompare</span><span class="br0">&#40;</span>that<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.10: String.prototype.match
           E262-4 draft proposals:static_generics
        */</span>
        prototype <span class="kw2">function</span> match<span class="br0">&#40;</span>regexp<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">match</span><span class="br0">&#40;</span>regexp<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> match<span class="br0">&#40;</span>self, regexp<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">match</span><span class="br0">&#40;</span>regexp<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> match<span class="br0">&#40;</span>r<span class="br0">&#41;</span> : Array 
            value.<span class="me1">match</span><span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.11: String.prototype.replace 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> replace<span class="br0">&#40;</span>searchValue, replaceValue<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">replace</span><span class="br0">&#40;</span>searchValue, replaceValue<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> replace<span class="br0">&#40;</span>self, searchValue, replaceValue<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">replace</span><span class="br0">&#40;</span>searchValue, replaceValue<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> replace<span class="br0">&#40;</span>s, r<span class="br0">&#41;</span> : String
            value.<span class="me1">replace</span><span class="br0">&#40;</span>searchValue, replaceValue<span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* E262-3 15.5.4.12: String.prototype.search 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> search<span class="br0">&#40;</span>regexp<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">search</span><span class="br0">&#40;</span>regexp<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> search<span class="br0">&#40;</span>self, regexp<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">search</span><span class="br0">&#40;</span>regexp<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> search<span class="br0">&#40;</span>r<span class="br0">&#41;</span> : double 
            value.<span class="me1">search</span><span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.13: String.prototype.slice 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> slice<span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">slice</span><span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> slice<span class="br0">&#40;</span>self, start, end<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">slice</span><span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> slice<span class="br0">&#40;</span>s, e<span class="br0">&#41;</span> : Array
            value.<span class="me1">slice</span><span class="br0">&#40;</span>s, e<span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* ES262-3 15.5.4.14: String.prototype.split
           E262-4 draft proposals:static_generics
        */</span>
        prototype <span class="kw2">function</span> split<span class="br0">&#40;</span>separator, limit<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">split</span><span class="br0">&#40;</span>separator, limit<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> split<span class="br0">&#40;</span>self, separator, limit<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">split</span><span class="br0">&#40;</span>separator, limit<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> split<span class="br0">&#40;</span>separator, limit<span class="br0">&#41;</span> : Array
            value.<span class="me1">split</span><span class="br0">&#40;</span>separator, limit<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.15: String.prototype.substring
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> substring<span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">substring</span><span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> substring<span class="br0">&#40;</span>self, start, end<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">substring</span><span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>
&nbsp;
        intrinsic <span class="kw2">function</span> substring<span class="br0">&#40;</span>start: double, end: double<span class="br0">&#41;</span> : string
            value.<span class="me1">substring</span><span class="br0">&#40;</span>start, end<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.16: String.prototype.toLowerCase 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> toLowerCase<span class="br0">&#40;</span><span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> toLowerCase<span class="br0">&#40;</span>selft<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toLowerCase<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            value.<span class="me1">toLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.17: String.prototype.toLocaleLowerCase 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> toLocaleLowerCase<span class="br0">&#40;</span><span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">toLocaleLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> prototype <span class="kw2">function</span> toLocaleLowerCase<span class="br0">&#40;</span>self<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">toLocaleLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toLocaleLowerCase<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            value.<span class="me1">toLocaleLowerCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.18: String.prototype.toUpperCase 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> toUpperCase<span class="br0">&#40;</span><span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">toUpperCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> toUpperCase<span class="br0">&#40;</span>self<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">toUpperCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toUpperCase<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            value.<span class="me1">toUpperCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.4.19: String.prototype.toLocaleUpperCase 
           E262-4 draft proposals:static_generics
         */</span>
        prototype <span class="kw2">function</span> toLocaleUpperCase<span class="br0">&#40;</span><span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">toLocaleUpperCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> toLocaleUpperCase<span class="br0">&#40;</span>self<span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span>self<span class="br0">&#41;</span>.<span class="me1">toLocaleUpperCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toLocaleUpperCase<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            value.<span class="me1">toLocaleUpperCase</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 draft proposals:json_encoding_and_decoding */</span>
        prototype <span class="kw2">function</span> parseJSON<span class="br0">&#40;</span><span class="br0">&#41;</span> 
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">parseJSON</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> parseJSON<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>
            <span class="kw2">Function</span>.<span class="me1">apply</span><span class="br0">&#40;</span>string.<span class="me1">parseJSON</span>, value, args<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 draft proposals:string.prototype.trim */</span>
        prototype <span class="kw2">function</span> trim<span class="br0">&#40;</span><span class="br0">&#41;</span>
            ToString<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">trim</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> trim<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            value.<span class="me1">trim</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.5.5.1: length. */</span>
        <span class="kw2">public</span> <span class="kw2">function</span> get length<span class="br0">&#40;</span><span class="br0">&#41;</span> : uint
            magic::stringLength<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>;
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>
<!-- SECTION [30688-40099] -->
<a name="boolean_objects"></a><h1>Boolean objects</h1>
<div class="level1">
<pre class="code javascript"><span class="kw2">package</span>
<span class="br0">&#123;</span>
    <span class="coMULTI">/* Notionally, the boolean constants &quot;true&quot; and &quot;false&quot; reference
       instances of the Boolean class.  These two instances are
       necessarily magically constructed.
&nbsp;
       The Boolean constructor returns one of these instances, so
       there are never more than two Boolean instances in the system.
&nbsp;
       The Boolean class is final and non-dynamic because most
       implementations will in fact represent Boolean objects not
       using objects, but using some magic tagged value, of which
       there will be only two, one for &quot;true&quot; and the other for
       &quot;false&quot;.
     */</span>
    final <span class="kw2">class</span> Boolean! <span class="kw2">extends</span> Object
    <span class="br0">&#123;</span>       
        <span class="coMULTI">/* E262-3 15.6.1: The Boolean Constructor Called as a Function. */</span>
        static intrinsic <span class="kw2">function</span> invoke<span class="br0">&#40;</span>value<span class="br0">&#41;</span> : Boolean
            value ? <span class="kw2">true</span> : <span class="kw2">false</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.6.2.1: The Boolean Constructor. */</span>
        <span class="kw2">function</span> Boolean<span class="br0">&#40;</span>value<span class="br0">&#41;</span>
            value ? <span class="kw2">true</span> : <span class="kw2">false</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.6.4.2: Boolean.prototype.toString.  */</span>
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="kw1">this</span> : Boolean<span class="br0">&#41;</span> 
            <span class="kw1">this</span>.<span class="me1">intrinsic</span>::toString<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 draft ch 19 */</span>
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span> : String
            <span class="kw1">this</span> === <span class="kw2">true</span> ? <span class="st0">"true"</span> : <span class="st0">"false"</span>;
        
        <span class="coMULTI">/* E262-3 15.6.4.3: Boolean.prototype.valueOf. */</span>
        prototype <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="kw1">this</span> : Boolean<span class="br0">&#41;</span>
            <span class="kw1">this</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 draft ch 19 */</span>
        intrinsic <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="br0">&#41;</span> : Boolean
            <span class="kw1">this</span>;
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>
<!-- SECTION [40100-41631] -->
<a name="number_objects"></a><h1>Number objects</h1>
<div class="level1">
<pre class="code javascript"><span class="kw2">package</span>
<span class="br0">&#123;</span>
    <span class="kw2">use</span> <span class="kw2">namespace</span> intrinsic;
    <span class="kw2">use</span> strict;
&nbsp;
    dynamic <span class="kw2">class</span> Number!
    <span class="br0">&#123;</span>
        <span class="kw2">public</span> static <span class="kw2">const</span> MAX_VALUE : double         = double.<span class="me1">MAX_VALUE</span>;
        <span class="kw2">public</span> static <span class="kw2">const</span> MIN_VALUE : double         = double.<span class="me1">MIN_VALUE</span>;
        <span class="kw2">public</span> static <span class="kw2">const</span> NaN : double               = double.<span class="me1">NaN</span>;
        <span class="kw2">public</span> static <span class="kw2">const</span> NEGATIVE_INFINITY : double = double.<span class="me1">NEGATIVE_INFINITY</span>;
        <span class="kw2">public</span> static <span class="kw2">const</span> POSITIVE_INFINITY : double = double.<span class="me1">POSITIVE_INFINITY</span>;
&nbsp;
        <span class="kw2">const</span> value : double;
&nbsp;
        <span class="coMULTI">/* E262-4 draft */</span>
        intrinsic static <span class="kw2">function</span> to<span class="br0">&#40;</span>x : Numeric<span class="br0">&#41;</span> : Number
            x <span class="kw1">is</span> Number ? x : <span class="kw2">new</span> Number<span class="br0">&#40;</span>ToDouble<span class="br0">&#40;</span>x<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.7.1.1: The Number Constructor Called as a Function */</span>
        intrinsic static <span class="kw2">function</span> invoke<span class="br0">&#40;</span>value<span class="br0">&#41;</span> 
            value === undefined ? <span class="nu0">0</span>.<span class="nu0">0</span> : <span class="kw2">new</span> Number<span class="br0">&#40;</span>value<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.7.2.1: The Number constructor */</span>
        <span class="kw2">public</span> <span class="kw2">function</span> Number<span class="br0">&#40;</span>value<span class="br0">&#41;</span> 
            value = ToDouble<span class="br0">&#40;</span>value<span class="br0">&#41;</span>;
&nbsp;
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span>radix = <span class="nu0">10</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toString</span><span class="br0">&#40;</span>radix<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span>radix = <span class="nu0">10</span><span class="br0">&#41;</span> : string
            value.<span class="me1">toString</span><span class="br0">&#40;</span>radix<span class="br0">&#41;</span>;
        
        prototype <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toLocaleString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            value.<span class="me1">toLocaleString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        prototype <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">valueOf</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="br0">&#41;</span> : Object!
            value.<span class="me1">valueOf</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        prototype <span class="kw2">function</span> toFixed<span class="br0">&#40;</span>fractionDigits<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toFixed</span><span class="br0">&#40;</span>fractionDigits<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toFixed<span class="br0">&#40;</span>fractionDigits:double<span class="br0">&#41;</span> : string 
            value.<span class="me1">toFixed</span><span class="br0">&#40;</span>fractionDigits<span class="br0">&#41;</span>;
&nbsp;
        prototype <span class="kw2">function</span> toExponential<span class="br0">&#40;</span>fractionDigits<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toExponential</span><span class="br0">&#40;</span>fractionDigits<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toExponential<span class="br0">&#40;</span>fractionDigits:double<span class="br0">&#41;</span> : string
            value.<span class="me1">toExponential</span><span class="br0">&#40;</span>fractionDigits<span class="br0">&#41;</span>;
&nbsp;
        prototype <span class="kw2">function</span> toPrecision<span class="br0">&#40;</span>precision<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toPrecision</span><span class="br0">&#40;</span>precision<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toPrecision<span class="br0">&#40;</span>precision:double<span class="br0">&#41;</span> : string
            value.<span class="me1">toPrecision</span><span class="br0">&#40;</span>precision<span class="br0">&#41;</span>;
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>
<!-- SECTION [41632-43790] -->
<a name="math_object"></a><h1>Math object</h1>
<div class="level1">
<pre class="code javascript"><span class="kw2">package</span>
<span class="br0">&#123;</span>
    <span class="co1">// ECMA4 version which allows early-binding.</span>
    ECMA4 final <span class="kw2">class</span> Math <span class="kw2">extends</span> Object
    <span class="br0">&#123;</span>       
        <span class="co1">// 15.8.1 Value Properties of the Math Object</span>
        static <span class="kw2">const</span> E; 
        static <span class="kw2">const</span> LN10;  
        static <span class="kw2">const</span> LN2;   
        static <span class="kw2">const</span> LOG2E; 
        static <span class="kw2">const</span> LOG10E;    
        static <span class="kw2">const</span> PI;    
        static <span class="kw2">const</span> SQRT1_<span class="nu0">2</span>;   
        static <span class="kw2">const</span> SQRT2; 
&nbsp;
        <span class="co1">// 15.8.2 Function Properties of the Math Object</span>
        static native <span class="kw2">function</span> abs<span class="br0">&#40;</span>x:Number<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> acos<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> asin<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> atan<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> atan2<span class="br0">&#40;</span>x,y<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> ceil<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> cos<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> exp<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> floor<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> log<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> max<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> min<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> pow<span class="br0">&#40;</span>x,y<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> random<span class="br0">&#40;</span><span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> round<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> sin<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> sqrt<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
        static native <span class="kw2">function</span> tan<span class="br0">&#40;</span>x<span class="br0">&#41;</span>:Number;
&nbsp;
    <span class="br0">&#125;</span> <span class="co1">// class</span>
    
    <span class="co1">// Math is a singleton object, not a class, but has the type &quot;Math&quot;</span>
    <span class="co1">// which suggests a private Math class that created the singleton.</span>
&nbsp;
    <span class="kw2">var</span> Math = <span class="kw2">new</span> <span class="kw2">private</span>::Math;
&nbsp;
    dynamic <span class="kw2">class</span> Math <span class="kw2">extends</span> Object
    <span class="br0">&#123;</span>       
        <span class="co1">// 15.8.1 Value Properties of the Math Object</span>
        <span class="kw2">const</span> E = ECMA4::Math.<span class="me1">E</span>;    
        <span class="kw2">const</span> LN10 = ECMA4::Math.<span class="me1">LN10</span>;  
        <span class="kw2">const</span> LN2 = ECMA4::Math.<span class="me1">LN2</span>;    
        <span class="kw2">const</span> LOG2E = ECMA4::Math.<span class="me1">LOG2E</span>;    
        <span class="kw2">const</span> LOG10E = ECMA4::Math.<span class="me1">LOG10E</span>;  
        <span class="kw2">const</span> PI = ECMA4::Math.<span class="me1">PI</span>;  
        <span class="kw2">const</span> SQRT1_<span class="nu0">2</span> = ECMA4::Math.<span class="me1">SQRT1_</span><span class="nu0">2</span>;    
        <span class="kw2">const</span> SQRT2 = ECMA4::Math.<span class="me1">SQRT2</span>;    
&nbsp;
        <span class="co1">// 15.8.2 Function Properties of the Math Object</span>
        <span class="kw2">var</span> abs = ECMA4::Math.<span class="me1">abs</span>;
        <span class="kw2">var</span> acos = ECMA4::Math.<span class="me1">acos</span>;
        <span class="kw2">var</span> asin = ECMA4::Math.<span class="me1">asin</span>;
        <span class="kw2">var</span> atan = ECMA4::Math.<span class="me1">atan</span>;
        <span class="kw2">var</span> atan2 = ECMA4::Math.<span class="me1">atan2</span>;
        <span class="kw2">var</span> ceil = ECMA4::Math.<span class="me1">ceil</span>;
        <span class="kw2">var</span> cos = ECMA4::Math.<span class="me1">cos</span>;
        <span class="kw2">var</span> exp = ECMA4::Math.<span class="me1">exp</span>;
        <span class="kw2">var</span> floor = ECMA4::Math.<span class="me1">floor</span>;
        <span class="kw2">var</span> log = ECMA4::Math.<span class="me1">log</span>;
        <span class="kw2">var</span> max = ECMA4::Math.<span class="me1">max</span>;
        <span class="kw2">var</span> min = ECMA4::Math.<span class="me1">min</span>;
        <span class="kw2">var</span> pow = ECMA4::Math.<span class="me1">pow</span>;
        <span class="kw2">var</span> random = ECMA4::Math.<span class="me1">random</span>;
        <span class="kw2">var</span> round = ECMA4::Math.<span class="me1">round</span>;
        <span class="kw2">var</span> sin = ECMA4::Math.<span class="me1">sin</span>;
        <span class="kw2">var</span> sqrt = ECMA4::Math.<span class="me1">sqrt</span>;
        <span class="kw2">var</span> tan = ECMA4::Math.<span class="me1">tan</span>;
&nbsp;
        <span class="co1">// E262 specifies that length=2 for these.</span>
        max.<span class="me1">length</span> = <span class="nu0">2</span>;
        min.<span class="me1">length</span> = <span class="nu0">2</span>;
&nbsp;
    <span class="br0">&#125;</span> <span class="co1">// class</span>
<span class="br0">&#125;</span> <span class="co1">// package</span></pre>
</div>
<!-- SECTION [43791-46660] -->
<a name="date_objects"></a><h1>Date objects</h1>
<div class="level1">
<pre class="code javascript"><span class="kw2">package</span>
<span class="br0">&#123;</span>
    <span class="kw2">use</span> <span class="kw2">namespace</span> intrinsic;  <span class="co1">// Override with &quot;public::&quot; when necessary</span>
&nbsp;
    <span class="coMULTI">/* The Date class is &quot;final dynamic&quot; in ActionScript 3.0, though
       the motivation for that is unclear.  The consequence is anyway
       that the getters for the components of a Date can be
       inlined.  */</span>
&nbsp;
    final dynamic <span class="kw2">class</span> Date <span class="kw2">extends</span> Object
    <span class="br0">&#123;</span>       
        <span class="coMULTI">/* E262-3 15.9.2: The Date Constructor Called as a Function */</span>
        static intrinsic <span class="kw2">function</span> date<span class="br0">&#40;</span>...<span class="me1">args</span><span class="br0">&#41;</span>   <span class="co1">// args are ignored.</span>
            <span class="br0">&#40;</span><span class="kw2">new</span> Date<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>.<span class="kw2">public</span>::toString<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.3: The Date Constructor. */</span>
        <span class="kw2">public</span> <span class="kw2">function</span> Date<span class="br0">&#40;</span>year, month, a, b, c, d, e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let date=<span class="nu0">1</span>, hours=<span class="nu0">0</span>, minutes=<span class="nu0">0</span>, seconds=<span class="nu0">0</span>, ms=<span class="nu0">0</span>;
&nbsp;
            setupNanoAge<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
            <span class="kw1">switch</span> <span class="br0">&#40;</span>arguments.<span class="me1">length</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">case</span> <span class="nu0">0</span>:  <span class="coMULTI">/* 15.9.3.3 */</span>
                timeval = Date.<span class="me1">now</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
                <span class="kw1">return</span>;
            <span class="kw1">case</span> <span class="nu0">1</span>:  <span class="coMULTI">/* 15.9.3.2 */</span>
                let v = ToPrimitive<span class="br0">&#40;</span>year<span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>v <span class="kw1">is</span> string<span class="br0">&#41;</span>
                    <span class="kw1">return</span> parse<span class="br0">&#40;</span>v cast string<span class="br0">&#41;</span>;
&nbsp;
                timeval = TimeClip<span class="br0">&#40;</span>ToDouble<span class="br0">&#40;</span>v<span class="br0">&#41;</span><span class="br0">&#41;</span>;
                <span class="kw1">return</span>;
            <span class="kw2">default</span>:  <span class="coMULTI">/* 15.9.3.1 */</span>
                ms = ToDouble<span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
            <span class="kw1">case</span> <span class="nu0">6</span>:
                seconds = ToDouble<span class="br0">&#40;</span>d<span class="br0">&#41;</span>;
            <span class="kw1">case</span> <span class="nu0">5</span>:
                minutes = ToDouble<span class="br0">&#40;</span>c<span class="br0">&#41;</span>;
            <span class="kw1">case</span> <span class="nu0">4</span>:
                hours = ToDouble<span class="br0">&#40;</span>b<span class="br0">&#41;</span>;
            <span class="kw1">case</span> <span class="nu0">3</span>:
                date = ToDouble<span class="br0">&#40;</span>a<span class="br0">&#41;</span>;
            <span class="kw1">case</span> <span class="nu0">2</span>:
                year = ToDouble<span class="br0">&#40;</span>year<span class="br0">&#41;</span>;
                month = ToDouble<span class="br0">&#40;</span>month<span class="br0">&#41;</span>;
&nbsp;
                let intYear = ToInteger<span class="br0">&#40;</span>year<span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>!isNaN<span class="br0">&#40;</span>year<span class="br0">&#41;</span> &amp;&amp; <span class="nu0">0</span> &lt;= intYear &amp;&amp; intYear &lt;= <span class="nu0">99</span><span class="br0">&#41;</span>
                    intYear += <span class="nu0">1900</span>;
&nbsp;
                timeval = TimeClip<span class="br0">&#40;</span>UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>intYear, month, date<span class="br0">&#41;</span>, 
                                                    MakeTime<span class="br0">&#40;</span>hours, minutes, seconds, ms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
                <span class="kw1">return</span>;
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.4.2: Date.parse
           E262-4 proposals:date_and_time - &quot;ISO Date strings&quot;.
&nbsp;
           Note incompatibilities with ES3, which allowed arbitrary
           extra arguments to Date.parse and ignored them all
           (standard behavior): E262-3 did not include a clause about
           maybe interpreting extra arguments differently in the
           future for Date.parse, unlike for some other methods.  This
           shows that that kind of imprecation either (a) should be
           the default for all library methods or (b) is pointless.
           Take your pick.
        */</span>
        <span class="kw2">public</span> static <span class="kw2">var</span> parse = <span class="kw2">function</span> parse<span class="br0">&#40;</span>string, reference:double=<span class="nu0">0</span>.<span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>arguments.<span class="me1">length</span> &gt; <span class="nu0">2</span><span class="br0">&#41;</span>
                <span class="kw1">throw</span> <span class="kw2">new</span> TypeError<span class="br0">&#40;</span><span class="st0">"Too many arguments to Date.parse"</span><span class="br0">&#41;</span>; 
            <span class="kw1">return</span> Date.<span class="me1">parse</span><span class="br0">&#40;</span>ToString<span class="br0">&#40;</span>string<span class="br0">&#41;</span>, reference<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        static intrinsic <span class="kw2">function</span> parse<span class="br0">&#40;</span>s:string, reference:double=<span class="nu0">0</span>.<span class="nu0">0</span><span class="br0">&#41;</span> : Date! <span class="br0">&#123;</span>
&nbsp;
            <span class="kw2">function</span> fractionToMilliseconds<span class="br0">&#40;</span>frac : string<span class="br0">&#41;</span> : double
                Math.<span class="me1">floor</span><span class="br0">&#40;</span><span class="nu0">1000</span> * <span class="br0">&#40;</span>parseInt<span class="br0">&#40;</span>frac<span class="br0">&#41;</span> / Math.<span class="me1">pow</span><span class="br0">&#40;</span><span class="nu0">10</span>,frac.<span class="me1">length</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
            let isoRes : Object = isoTimestamp.<span class="me1">exec</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
            let defaults : Date! = <span class="kw2">new</span> Date<span class="br0">&#40;</span>reference<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>isoRes !== undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                let year = isoRes.<span class="me1">year</span> !== undefined ? parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">year</span><span class="br0">&#41;</span> : defaults.<span class="me1">UTCYear</span>;
                let month = isoRes.<span class="me1">month</span> !== undefined ? parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">month</span><span class="br0">&#41;</span> : defaults.<span class="me1">UTCMonth</span>;
                let day = isoRes.<span class="me1">day</span> !== undefined ? parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">day</span><span class="br0">&#41;</span> : defaults.<span class="me1">UTCDay</span>;
                let hour = isoRes.<span class="me1">hour</span> !== undefined ? parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">hour</span><span class="br0">&#41;</span> : defaults.<span class="me1">UTCHour</span>;
                let mins = isoRes.<span class="me1">mins</span> !== undefined ? parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">mins</span><span class="br0">&#41;</span> : defaults.<span class="me1">UTCMinutes</span>;
                let secs = isoRes.<span class="me1">secs</span> !== undefined ? parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">secs</span><span class="br0">&#41;</span> : defaults.<span class="me1">UTCSeconds</span>;
                let millisecs = isoRes.<span class="me1">fraction</span> !== undefined ? 
                    fractionToMillisecons<span class="br0">&#40;</span>isoRes.<span class="me1">fraction</span><span class="br0">&#41;</span> : 
                    defaults.<span class="me1">UTCMilliseconds</span>;
                let tzo = defaults.<span class="me1">timezoneOffset</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>isoRes.<span class="me1">zulu</span> !== undefined<span class="br0">&#41;</span>
                    tzo = <span class="nu0">0</span>;
                <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>isoRes.<span class="me1">offs</span> !== undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    tzo = parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">tzhr</span><span class="br0">&#41;</span> * <span class="nu0">60</span>;
                    <span class="kw1">if</span> <span class="br0">&#40;</span>isoRes.<span class="me1">tzmin</span> !== undefined<span class="br0">&#41;</span>
                        tzo += parseInt<span class="br0">&#40;</span>isoRes.<span class="me1">tzmin</span><span class="br0">&#41;</span>;
                    <span class="kw1">if</span> <span class="br0">&#40;</span>isoRes.<span class="me1">tzdir</span> === <span class="st0">"-"</span><span class="br0">&#41;</span>
                        tzo = -tzo;
                <span class="br0">&#125;</span>
                <span class="kw1">return</span> <span class="kw2">new</span> Date<span class="br0">&#40;</span>Date.<span class="me1">UTC</span><span class="br0">&#40;</span>year, month, day, hour, mins, secs, millisecs<span class="br0">&#41;</span>.<span class="me1">time</span> - tzo<span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">else</span>
                <span class="kw1">return</span> fromDateString<span class="br0">&#40;</span>s, reference<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
        
        <span class="coMULTI">/* INFORMATIVE.  
&nbsp;
           Most practical implementations have many heuristics for
           parsing date formats, which are as numerous as the sands of
           the desert, the snowflakes of the arctic, the stars in the
           sky, etc.  Parsing the output of Date.prototype.toString is
           the minimum required by the Standard and we handle that
           here along with the output of Date.prototype.toUTCString.
        */</span>
        static <span class="kw2">function</span> fromDateString<span class="br0">&#40;</span>s : string, reference : double<span class="br0">&#41;</span> : Date <span class="br0">&#123;</span>
&nbsp;
            <span class="kw2">function</span> findMonth<span class="br0">&#40;</span><span class="kw3">name</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">for</span> <span class="br0">&#40;</span> let i:int=<span class="nu0">0</span> ; i &lt; monthNames.<span class="me1">length</span> ; i++ <span class="br0">&#41;</span>
                    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw3">name</span> === monthNames<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>
                        <span class="kw1">return</span> i;
                <span class="kw1">return</span> <span class="nu0">0</span>;  <span class="co1">// implementation bug if this happens...</span>
            <span class="br0">&#125;</span>
&nbsp;
            let res = adhocTimestamp.<span class="me1">exec</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>res === <span class="kw2">null</span><span class="br0">&#41;</span>
                <span class="kw1">return</span> <span class="kw2">new</span> Date<span class="br0">&#40;</span>reference<span class="br0">&#41;</span>;
            let t = Date.<span class="me1">UTC</span><span class="br0">&#40;</span>parseInt<span class="br0">&#40;</span>res.<span class="me1">year</span><span class="br0">&#41;</span>,
                             findMonth<span class="br0">&#40;</span>res.<span class="me1">month</span><span class="br0">&#41;</span>,
                             parseInt<span class="br0">&#40;</span>res.<span class="me1">day</span><span class="br0">&#41;</span>,
                             parseInt<span class="br0">&#40;</span>res.<span class="me1">hour</span><span class="br0">&#41;</span>,
                             parseInt<span class="br0">&#40;</span>res.<span class="me1">minute</span><span class="br0">&#41;</span>,
                             parseInt<span class="br0">&#40;</span>res.<span class="me1">second</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>res.<span class="me1">tz</span> !== undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                let hour = parseInt<span class="br0">&#40;</span>res.<span class="me1">tz</span><span class="br0">&#91;</span><span class="nu0">1</span>:<span class="nu0">3</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
                let min  = parseInt<span class="br0">&#40;</span>res.<span class="me1">tz</span><span class="br0">&#91;</span><span class="nu0">3</span>:<span class="nu0">5</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>res.<span class="me1">tz</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> == <span class="st0">'+'</span><span class="br0">&#41;</span>
                    t -= <span class="br0">&#40;</span>hour*<span class="nu0">60</span> + min<span class="br0">&#41;</span>*<span class="nu0">60</span>*<span class="nu0">1000</span>;
                <span class="kw1">else</span> 
                    t += <span class="br0">&#40;</span>hour*<span class="nu0">60</span> + min<span class="br0">&#41;</span>*<span class="nu0">60</span>*<span class="nu0">1000</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> <span class="kw2">new</span> Date<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-4 proposals:date_and_time - &quot;Current and elapsed times&quot; */</span>
        static intrinsic native <span class="kw2">function</span> now<span class="br0">&#40;</span><span class="br0">&#41;</span> : double;
&nbsp;
        <span class="kw2">public</span> static <span class="kw2">function</span> now<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            Date.<span class="me1">now</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 proposals:date_and_time - &quot;Current and elapsed times&quot; */</span>
        prototype <span class="kw2">function</span> nanoAge<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            <span class="kw1">this</span>.<span class="me1">nanoAge</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> nanoAge<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            <span class="br0">&#40;</span>Date.<span class="me1">now</span><span class="br0">&#40;</span><span class="br0">&#41;</span> - birthtime<span class="br0">&#41;</span> * <span class="nu0">1000</span>;
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        <span class="kw2">function</span> setupNanoAge<span class="br0">&#40;</span><span class="br0">&#41;</span> : <span class="kw1">void</span> <span class="br0">&#123;</span>
            d.<span class="me1">birthtime</span> = Date.<span class="me1">now</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.4.3: Date.UTC */</span>
        <span class="kw2">public</span> static <span class="kw2">var</span> UTC = 
            <span class="kw2">function</span> UTC<span class="br0">&#40;</span>year, month, date, hours, minutes, seconds, ms<span class="br0">&#41;</span>
            let <span class="br0">&#40;</span>argc:uint = arguments.<span class="me1">length</span><span class="br0">&#41;</span>
                Date.<span class="me1">UTC</span><span class="br0">&#40;</span>ToDouble<span class="br0">&#40;</span>year<span class="br0">&#41;</span>, 
                         ToDouble<span class="br0">&#40;</span>month<span class="br0">&#41;</span>, 
                         argc &gt;= <span class="nu0">3</span> ? ToDouble<span class="br0">&#40;</span>date<span class="br0">&#41;</span> : <span class="nu0">1</span>,
                         argc &gt;= <span class="nu0">4</span> ? ToDouble<span class="br0">&#40;</span>hours<span class="br0">&#41;</span> : <span class="nu0">0</span>,
                         argc &gt;= <span class="nu0">5</span> ? ToDouble<span class="br0">&#40;</span>minutes<span class="br0">&#41;</span> : <span class="nu0">0</span>,
                         argc &gt;= <span class="nu0">6</span> ? ToDouble<span class="br0">&#40;</span>seconds<span class="br0">&#41;</span> : <span class="nu0">0</span>,
                         argc &gt;= <span class="nu0">7</span> ? ToDouble<span class="br0">&#40;</span>ms<span class="br0">&#41;</span> : <span class="nu0">0</span><span class="br0">&#41;</span>;
&nbsp;
        static instrinsic <span class="kw2">function</span> UTC<span class="br0">&#40;</span>year : double, month : double, 
                                       date : double=<span class="nu0">1</span>, hours : double?=<span class="nu0">0</span>, minutes : double?=<span class="nu0">0</span>,
                                       seconds : double=<span class="nu0">0</span>, ms : double?=<span class="nu0">0</span><span class="br0">&#41;</span> : double <span class="br0">&#123;</span>
            let intYear:double = Integer<span class="br0">&#40;</span>year<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>!isNaN<span class="br0">&#40;</span>year<span class="br0">&#41;</span> &amp;&amp; <span class="nu0">0</span> &lt;= intYear &amp;&amp; intYear &lt;= <span class="nu0">99</span><span class="br0">&#41;</span>
                intYear += <span class="nu0">1900</span>;
            <span class="kw1">return</span> TimeClip<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>intYear, month, date<span class="br0">&#41;</span>, 
                                     MakeTime<span class="br0">&#40;</span>hours, minutes, seconds, ms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        static <span class="kw2">const</span> dayNames = <span class="br0">&#91;</span><span class="st0">"Mon"</span>, <span class="st0">"Tue"</span>, <span class="st0">"Wed"</span>, <span class="st0">"Thu"</span>, <span class="st0">"Fri"</span>, <span class="st0">"Sat"</span>, <span class="st0">"Sun"</span><span class="br0">&#93;</span>;
        static <span class="kw2">const</span> monthNames = <span class="br0">&#91;</span><span class="st0">"Jan"</span>, <span class="st0">"Feb"</span>, <span class="st0">"Mar"</span>, <span class="st0">"Apr"</span>, <span class="st0">"May"</span>, <span class="st0">"Jun"</span>, 
                                   <span class="st0">"Jul"</span>, <span class="st0">"Aug"</span>, <span class="st0">"Sep"</span>, <span class="st0">"Oct"</span>, <span class="st0">"Nov"</span>, <span class="st0">"Dec"</span><span class="br0">&#93;</span>;
&nbsp;
        <span class="coMULTI">/* Format of string produced by Date.toString, recognized by Date.parse */</span>
        <span class="coMULTI">/* e.g., &quot;Fri, 15 Dec 2006 23:45:09 GMT-0800&quot; */</span>
        <span class="kw2">const</span> adhocTimestamp : RegExp! = 
            /<span class="br0">&#40;</span>?: Mon|Tue|Wed|Thu|Fri|Sat|Sun <span class="br0">&#41;</span>\s+
             <span class="br0">&#40;</span>?P&lt;day&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span>+ <span class="br0">&#41;</span>\s+
             <span class="br0">&#40;</span>?P&lt;month&gt; Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec <span class="br0">&#41;</span>\s+
             <span class="br0">&#40;</span>?P&lt;year&gt; -? <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span>+ <span class="br0">&#41;</span>\s+
             <span class="br0">&#40;</span>?P&lt;hour&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>:
             <span class="br0">&#40;</span>?P&lt;minute&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>:
             <span class="br0">&#40;</span>?P&lt;second&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>\s+
             GMT
             <span class="br0">&#40;</span>?P&lt;tz&gt; <span class="br0">&#40;</span>?: \\+ | - <span class="br0">&#41;</span> <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">4</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>?/x;
&nbsp;
        <span class="coMULTI">/* Format of string produced by Date.toISOString, recognized by Date.parse */</span>
        <span class="coMULTI">/* e.g, &quot;2006-12-15T23:45:09.33-08:00&quot; */</span>
        <span class="kw2">const</span> isoTimestamp : RegExp! =
            /^
            # Date, optional
            <span class="br0">&#40;</span>?: <span class="br0">&#40;</span>?P&lt;year&gt; - <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span>+ | <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">4</span><span class="br0">&#125;</span> <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span>* <span class="br0">&#41;</span>
             <span class="br0">&#40;</span>?: - <span class="br0">&#40;</span>?P&lt;month&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>
              <span class="br0">&#40;</span>?: - <span class="br0">&#40;</span>?P&lt;day&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span> <span class="br0">&#41;</span>? <span class="br0">&#41;</span>? <span class="br0">&#41;</span>?
            T
            # Time, optional
            <span class="br0">&#40;</span>?: <span class="br0">&#40;</span>?P&lt;hour&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>
             <span class="br0">&#40;</span>?: : <span class="br0">&#40;</span>?P&lt;minutes&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>
              <span class="br0">&#40;</span>?: : <span class="br0">&#40;</span>?P&lt;seconds&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>
               <span class="br0">&#40;</span>?: \. <span class="br0">&#40;</span>?P&lt;fraction&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span>+ <span class="br0">&#41;</span> <span class="br0">&#41;</span>? <span class="br0">&#41;</span>? <span class="br0">&#41;</span>? <span class="br0">&#41;</span>?
            # Timezone, optional
            <span class="br0">&#40;</span>?: <span class="br0">&#40;</span>?P&lt;zulu&gt; Z <span class="br0">&#41;</span>
             | <span class="br0">&#40;</span>?P&lt;offs&gt; 
                <span class="br0">&#40;</span>?P&lt;tzdir&gt; \\+ | - <span class="br0">&#41;</span>
                <span class="br0">&#40;</span>?P&lt;tzhr&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span>
                <span class="br0">&#40;</span>?: : <span class="br0">&#40;</span>?P&lt;tzmin&gt; <span class="br0">&#91;</span><span class="nu0">0</span>-<span class="nu0">9</span><span class="br0">&#93;</span><span class="br0">&#123;</span><span class="nu0">2</span><span class="br0">&#125;</span> <span class="br0">&#41;</span> <span class="br0">&#41;</span>? <span class="br0">&#41;</span> <span class="br0">&#41;</span>?
            $/x;
&nbsp;
        <span class="coMULTI">/* E262-4 proposals:date_and_time - &quot;ISO Date strings&quot; */</span>
        prototype <span class="kw2">function</span> toISOString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toISOString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> toISOString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string <span class="br0">&#123;</span>
&nbsp;
            <span class="kw2">function</span> years<span class="br0">&#40;</span>n : double<span class="br0">&#41;</span> : String <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>n &gt;= <span class="nu0">0</span> &amp;&amp; n &lt;= <span class="nu0">9999</span><span class="br0">&#41;</span>
                    <span class="kw1">return</span> <span class="br0">&#40;</span>n+<span class="nu0">10000</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">substring</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>;
                <span class="kw1">else</span>
                    <span class="kw1">return</span> n.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
&nbsp;
            <span class="kw2">function</span> fraction<span class="br0">&#40;</span>n : int<span class="br0">&#41;</span> : string <span class="br0">&#123;</span>
                <span class="kw1">while</span> <span class="br0">&#40;</span>n &gt; <span class="nu0">0</span> &amp;&amp; n % <span class="nu0">10</span> === <span class="nu0">0</span><span class="br0">&#41;</span>
                    n /= <span class="nu0">10</span>;
                <span class="kw1">return</span> n.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
&nbsp;
            let tz:double = timezoneOffset;
            let atz:double = Math.<span class="me1">abs</span><span class="br0">&#40;</span>tz<span class="br0">&#41;</span>;
            <span class="kw1">return</span> <span class="st0">""</span> + years<span class="br0">&#40;</span>fullYear<span class="br0">&#41;</span> + <span class="st0">"-"</span> + twoDigit<span class="br0">&#40;</span>month<span class="br0">&#41;</span> + <span class="st0">"-"</span> + twoDigit<span class="br0">&#40;</span>day<span class="br0">&#41;</span> +
                <span class="st0">"T"</span> + twoDigit<span class="br0">&#40;</span>hours<span class="br0">&#41;</span> + <span class="st0">":"</span> + twoDigit<span class="br0">&#40;</span>minutes<span class="br0">&#41;</span> + <span class="st0">":"</span> + twoDigit<span class="br0">&#40;</span>seconds<span class="br0">&#41;</span> +
                <span class="st0">"."</span> + fraction<span class="br0">&#40;</span>int<span class="br0">&#40;</span>milliseconds<span class="br0">&#41;</span><span class="br0">&#41;</span> + sign<span class="br0">&#40;</span>tz<span class="br0">&#41;</span> +
                twoDigit<span class="br0">&#40;</span>Math.<span class="me1">floor</span><span class="br0">&#40;</span>atz / <span class="nu0">60</span><span class="br0">&#41;</span><span class="br0">&#41;</span> + <span class="st0">":"</span> + twoDigit<span class="br0">&#40;</span>atz % <span class="nu0">60</span><span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.2: Date.prototype.toString */</span>
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            <span class="coMULTI">/* &quot;Fri, 15 Dec 2006 23:45:09 GMT-0800&quot; */</span>
            let <span class="br0">&#40;</span>tz:double = timezoneOffset<span class="br0">&#41;</span>
                let <span class="br0">&#40;</span>atz:double = Math.<span class="me1">abs</span><span class="br0">&#40;</span>tz<span class="br0">&#41;</span><span class="br0">&#41;</span>
                    dayNames<span class="br0">&#91;</span>date<span class="br0">&#93;</span> + <span class="st0">", "</span> + twoDigit<span class="br0">&#40;</span>day<span class="br0">&#41;</span> + <span class="st0">" "</span> + monthNames<span class="br0">&#91;</span>month<span class="br0">&#93;</span> + <span class="st0">" "</span> fullYear +
                    <span class="st0">" "</span> + twoDigit<span class="br0">&#40;</span>hours<span class="br0">&#41;</span> + <span class="st0">":"</span> + twoDigit<span class="br0">&#40;</span>minutes<span class="br0">&#41;</span> + <span class="st0">":"</span> + twoDigit<span class="br0">&#40;</span>seconds<span class="br0">&#41;</span> +
                    <span class="st0">" GMT"</span> + sign<span class="br0">&#40;</span>tz<span class="br0">&#41;</span> + twoDigit<span class="br0">&#40;</span>Math.<span class="me1">floor</span><span class="br0">&#40;</span>atz / <span class="nu0">60</span><span class="br0">&#41;</span><span class="br0">&#41;</span> + twoDigit<span class="br0">&#40;</span>atz % <span class="nu0">60</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.42: Date.prototype.toUTCString */</span>
        prototype <span class="kw2">function</span> toUTCString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toUTCString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> toUTCString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            <span class="coMULTI">/* &quot;Sat, 16 Dec 2006 08:06:21 GMT&quot; */</span>
            dayNames<span class="br0">&#91;</span>UTCdate<span class="br0">&#93;</span> + <span class="st0">", "</span> + 
            twoDigit<span class="br0">&#40;</span>UTCday<span class="br0">&#41;</span> + <span class="st0">" "</span> + 
            monthNames<span class="br0">&#91;</span>UTCmonth<span class="br0">&#93;</span> + <span class="st0">" "</span> +
            UTCFullYear + <span class="st0">" "</span> + 
            twoDigit<span class="br0">&#40;</span>UTCHours<span class="br0">&#41;</span> + <span class="st0">":"</span> + 
            twoDigit<span class="br0">&#40;</span>UTCMinutes<span class="br0">&#41;</span> + <span class="st0">":"</span> + 
            twoDigit<span class="br0">&#40;</span>UTCSeconds<span class="br0">&#41;</span> + <span class="st0">" GMT"</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.3: Date.prototype.toDateString */</span>
        prototype <span class="kw2">function</span> toDateString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toDateString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> toDateString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            <span class="coMULTI">/* &quot;Sat, 16 Dec 2006&quot; */</span>
            dayNames<span class="br0">&#91;</span>date<span class="br0">&#93;</span> + <span class="st0">", "</span> + twoDigit<span class="br0">&#40;</span>day<span class="br0">&#41;</span> + <span class="st0">" "</span> + monthNames<span class="br0">&#91;</span>month<span class="br0">&#93;</span> + <span class="st0">" "</span> fullYear;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.4: Date.prototype.toTimeString */</span>
        prototype <span class="kw2">function</span> toTimeString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toTimeString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> toTimeString<span class="br0">&#40;</span><span class="br0">&#41;</span>:string
            <span class="coMULTI">/* &quot;00:13:29 GMT-0800&quot; */</span>
            let <span class="br0">&#40;</span>tz:double = timezoneOffset<span class="br0">&#41;</span>
                let <span class="br0">&#40;</span>atz:double = Math.<span class="me1">abs</span><span class="br0">&#40;</span>tz<span class="br0">&#41;</span><span class="br0">&#41;</span>
                    twoDigit<span class="br0">&#40;</span>hours<span class="br0">&#41;</span> + <span class="st0">":"</span> + twoDigit<span class="br0">&#40;</span>minutes<span class="br0">&#41;</span> + <span class="st0">":"</span> + twoDigit<span class="br0">&#40;</span>seconds<span class="br0">&#41;</span> +
                    <span class="st0">" GMT"</span> + sign<span class="br0">&#40;</span>tz<span class="br0">&#41;</span> + twoDigit<span class="br0">&#40;</span>Math.<span class="me1">floor</span><span class="br0">&#40;</span>atz / <span class="nu0">60</span><span class="br0">&#41;</span><span class="br0">&#41;</span> + twoDigit<span class="br0">&#40;</span>atz % <span class="nu0">60</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.5: Date.prototype.toLocaleString */</span>
        prototype <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toLocaleString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> toLocaleString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            toString<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.6: Date.prototype.toLocaleDateString */</span>
        prototype <span class="kw2">function</span> toLocaleDateString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toLocaleDateString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> toLocaleDateString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            toDateString<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.7: Date.prototype.toLocaleTimeString */</span>
        prototype <span class="kw2">function</span> toLocaleTimeString<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toLocaleTimeString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        intrinsic <span class="kw2">function</span> toLocaleTimeString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            toTimeString<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.8: Date.prototype.valueOf */</span>
        prototype <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">valueOf</span><span class="br0">&#40;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> valueOf<span class="br0">&#40;</span><span class="br0">&#41;</span> : Object
            getTime<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 proposals:date_and_time: the logical components of
           date values are gettable and settable through properties
           naming those components, and everything else is implemented
           in terms of those components.
&nbsp;
           Brendan and Lars agreed (2006-12-15) that these getters and
           setters are not overridable by assignment, ie, they're on
           the Date instances, not properties on the prototype.
&nbsp;
           As the Date class is final the getters and setters can be
           inlined. */</span>
&nbsp;
        <span class="kw2">public</span> <span class="kw2">function</span> get time<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                     getTime<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set time<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double         setTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get fullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                 getFullYear<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set fullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double     setFullYear<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCFullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double              getUTCFullYear<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCFullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double  setUTCFullYear<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get month<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                    getMonth<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set month<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double        setMonth<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCMonth<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                 getUTCMonth<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCMonth<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double     setUTCMonth<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get date<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                     getDate<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set date<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double         setDate<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCDate<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                  getUTCDate<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCDate<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double      setUTCDate<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get day<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                      getDay<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set day<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double          setDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCDay<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                   getUTCDay<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCDay<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double       setUTCDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get hours<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                    getHours<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set hours<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double        setHours<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCHours<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                 getUTCHours<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCHours<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double     setUTCHours<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get minutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                  getMinutes<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set minutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double      setMinutes<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCMinutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double               getUTCMinutes<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCMinutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double   setUTCMinutes<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get seconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double                  getSeconds<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set seconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double      setSeconds<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCSeconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double               getUTCSeconds<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCSeconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double   setUTCSeconds<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get milliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double             getMilliseconds<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set milliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double setMilliseconds<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get UTCMilliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double          getUTCMilliseconds<span class="br0">&#40;</span><span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> set UTCMilliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t : double<span class="br0">&#41;</span> : double setUTCMilliseconds<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        <span class="kw2">public</span> <span class="kw2">function</span> get timezoneOffset<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span> : double            getTimezoneOffset<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
&nbsp;
        <span class="coMULTI">/* Mandated aliases for the canonical getters and setters */</span>
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.9: Date.prototype.getTime */</span>
        prototype <span class="kw2">function</span> getTime<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>   
            <span class="kw1">this</span>.<span class="me1">getTime</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getTime<span class="br0">&#40;</span><span class="br0">&#41;</span> : double   
            timeval;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.10: Date.prototype.getFullYear */</span>
        prototype <span class="kw2">function</span> getFullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getFullYear</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getFullYear<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span> 
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : YearFromTime<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.11: Date.prototype.getUTCFullYear */</span>
        prototype <span class="kw2">function</span> getUTCFullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCFullYear</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCFullYear<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span> 
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : YearFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.12: Date.prototype.getMonth */</span>
        prototype <span class="kw2">function</span> getMonth<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getMonth</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getMonth<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : MonthFromTime<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* E262-3 15.9.5.13: Date.prototype.getUTCMonth */</span>
        prototype <span class="kw2">function</span> getUTCMonth<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCMonth</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCMonth<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : MonthFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.14: Date.prototype.getDate */</span>
        prototype <span class="kw2">function</span> getDate<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getDate</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getDate<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : DateFromTime<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.15: Date.prototype.getUTCDate */</span>
        prototype <span class="kw2">function</span> getUTCDate<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCDate</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCDate<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : DateFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.16: Date.prototype.getDay */</span>
        prototype <span class="kw2">function</span> getDay<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getDay</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getDay<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : WeekDay<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.17: Date.prototype.getUTCDay */</span>
        prototype <span class="kw2">function</span> getUTCDay<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCDay</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCDay<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : WeekDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.18: Date.prototype.getHours */</span>
        prototype <span class="kw2">function</span> getHours<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getHours</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getHours<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : HourFromTime<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.19: Date.prototype.getUTCHours */</span>
        prototype <span class="kw2">function</span> getUTCHours<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCHours</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCHours<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : HourFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.20: Date.prototype.getMinutes */</span>
        prototype <span class="kw2">function</span> getMinutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getMinutes</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getMinutes<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : MinFromTime<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* E262-3 15.9.5.21: Date.prototype.getUTCMinutes */</span>
        prototype <span class="kw2">function</span> getUTCMinutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCMinutes</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCMinutes<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : MinFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.22: Date.prototype.getSeconds */</span>
        prototype <span class="kw2">function</span> getSeconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getSeconds</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getSeconds<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : SecFromTime<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.23: Date.prototype.getUTCSeconds */</span>
        prototype <span class="kw2">function</span> getUTCSeconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCSeconds</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCSeconds<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : SecFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.24: Date.prototype.getMilliseconds */</span>
        prototype <span class="kw2">function</span> getMilliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getMilliseconds</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getMilliseconds<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : msFromTime<span class="br0">&#40;</span>LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* E262-3 15.9.5.25: Date.prototype.getUTCMilliseconds */</span>
        prototype <span class="kw2">function</span> getUTCMilliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getUTCMilliseconds</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getUTCMilliseconds<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : msFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
        
        <span class="coMULTI">/* E262-3 15.9.5.26: Date.prototype.getTimezoneOffset */</span>
        prototype <span class="kw2">function</span> getTimezoneOffset<span class="br0">&#40;</span><span class="kw1">this</span>:Date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">getTimezoneOffset</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> getTimezoneOffset<span class="br0">&#40;</span><span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span> 
                isNaN<span class="br0">&#40;</span>t<span class="br0">&#41;</span> ? t : <span class="br0">&#40;</span>t - LocalTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span> / msPerMinute;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.27: Date.prototype.setTime */</span>
        prototype <span class="kw2">function</span> setTime<span class="br0">&#40;</span><span class="kw1">this</span>:Date, t<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setTime</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> setTime<span class="br0">&#40;</span>t:double<span class="br0">&#41;</span> : double
            timeval = TimeClip<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.28:  Date.prototype.setMilliseconds (ms) */</span>
        prototype <span class="kw2">function</span> setMilliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, ms<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setMilliseconds</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
        intrinsic <span class="kw2">function</span> setMilliseconds<span class="br0">&#40;</span>ms:double<span class="br0">&#41;</span> : double
            timeval = let <span class="br0">&#40;</span>t : double = LocalTime<span class="br0">&#40;</span>timeval<span class="br0">&#41;</span><span class="br0">&#41;</span>
                          UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>HourFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                            MinFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                            SecFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                            ms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.29 Date.prototype.setUTCMilliseconds (ms)</span>
        prototype <span class="kw2">function</span> setUTCMilliseconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, ms<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setUTCMilliseconds</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> setUTCMilliseconds<span class="br0">&#40;</span>ms:double<span class="br0">&#41;</span> : double
            timeval = let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                          MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>HourFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                    MinFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                    SecFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                    ms<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.30 Date.prototype.setSeconds (sec [, ms ] )</span>
        prototype <span class="kw2">function</span> setSeconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, sec, ms<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setSeconds</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>sec<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setSeconds<span class="br0">&#40;</span>sec:double, ms:double = milliseconds<span class="br0">&#41;</span> : double
            timeval = let <span class="br0">&#40;</span>t : double = LocalTime<span class="br0">&#40;</span>timeval<span class="br0">&#41;</span><span class="br0">&#41;</span>
                          UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>HourFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                            MinFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                            sec, 
                                                            ms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.31 Date.prototype.setUTCSeconds (sec [, ms ] )</span>
        prototype <span class="kw2">function</span> setUTCSeconds<span class="br0">&#40;</span><span class="kw1">this</span>:Date, sec, ms<span class="br0">&#41;</span> 
            <span class="kw1">this</span>.<span class="me1">setUTCSeconds</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>sec<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setUTCSeconds<span class="br0">&#40;</span>sec:double, ms:double = milliseconds<span class="br0">&#41;</span> : double
            timeval = let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                          MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>HourFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                    MinFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                    sec, 
                                                    ms<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.33 Date.prototype.setMinutes (min [, sec [, ms ] ] )</span>
        prototype <span class="kw2">function</span> setMinutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date, min, sec, ms<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setMinutes</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>min<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>sec<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setMinutes<span class="br0">&#40;</span>min:double, 
                                      sec:double = seconds, 
                                      ms:double = milliseconds<span class="br0">&#41;</span> : double 
            timeval = let <span class="br0">&#40;</span>t : double = LocalTime<span class="br0">&#40;</span>timeval<span class="br0">&#41;</span><span class="br0">&#41;</span>
                          UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>HourFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                            min, 
                                                            sec, 
                                                            ms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.34 Date.prototype.setUTCMinutes (min [, sec [, ms ] ] )</span>
        prototype <span class="kw2">function</span> setUTCMinutes<span class="br0">&#40;</span><span class="kw1">this</span>:Date, min, sec, ms<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setUTCMinutes</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>min<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>sec<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setUTCMinutes<span class="br0">&#40;</span>min:double, 
                                         sec:double = seconds,
                                         ms:double = milliseconds<span class="br0">&#41;</span> : double 
            timeval = let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                          MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>HourFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, 
                                                    min, 
                                                    sec, 
                                                    ms<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.35 Date.prototype.setHours (hour [, min [, sec [, ms ] ] ] )</span>
        prototype <span class="kw2">function</span> setHours<span class="br0">&#40;</span><span class="kw1">this</span>:Date, hour, min, sec, ms<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setHours</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>hour<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>min<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>sec<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> setHours<span class="br0">&#40;</span>hour:double, 
                                    min:double = minutes,
                                    sec:double = seconds,
                                    ms:double = milliseconds<span class="br0">&#41;</span> : double 
            timeval = let <span class="br0">&#40;</span>t : double = LocalTime<span class="br0">&#40;</span>timeval<span class="br0">&#41;</span><span class="br0">&#41;</span>
                          UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>hour, 
                                                            min, 
                                                            sec, 
                                                            ms<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.36 Date.prototype.setUTCHours (hour [, min [, sec [, ms ] ] ] )</span>
        prototype <span class="kw2">function</span> setUTCHours<span class="br0">&#40;</span><span class="kw1">this</span>:Date, hour, min, sec, ms<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setUTCHours</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>hour<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>min<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>sec<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> setUTCHours<span class="br0">&#40;</span>hour:double, 
                                       min:double = minutes,
                                       sec:double = seconds,
                                       ms:double = milliseconds<span class="br0">&#41;</span> : double 
            timeval = let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                          MakeDate<span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MakeTime<span class="br0">&#40;</span>hour, 
                                                    min, 
                                                    sec, 
                                                    ms<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="co1">// 15.9.5.36 Date.prototype.setDate (date)</span>
        prototype <span class="kw2">function</span> setDate<span class="br0">&#40;</span><span class="kw1">this</span>:Date, date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setDate</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>date<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setDate<span class="br0">&#40;</span>date:double<span class="br0">&#41;</span>:double
            timeval = let <span class="br0">&#40;</span>t : double = LocalTime<span class="br0">&#40;</span>timeval<span class="br0">&#41;</span><span class="br0">&#41;</span>
                          UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>YearFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MonthFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, date<span class="br0">&#41;</span>, 
                                           TimeWithinDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
            
&nbsp;
        <span class="co1">// 15.9.5.37 Date.prototype.setUTCDate (date)</span>
        prototype <span class="kw2">function</span> setUTCDate<span class="br0">&#40;</span><span class="kw1">this</span>:Date, date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setUTCDate</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>date<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setUTCDate<span class="br0">&#40;</span>date:double<span class="br0">&#41;</span>:double 
            timeval = let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                          MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>YearFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, MonthFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, date<span class="br0">&#41;</span>, 
                                   TimeWithinDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
&nbsp;
        <span class="co1">// 15.9.5.38 Date.prototype.setMonth (month [, date ] )</span>
        prototype <span class="kw2">function</span> setMonth<span class="br0">&#40;</span><span class="kw1">this</span>:Date, month, date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setMonth</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>month<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>date<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setMonth<span class="br0">&#40;</span>month:double, date:double = date<span class="br0">&#41;</span>:double
            timeval = let <span class="br0">&#40;</span>t : double = LocalTime<span class="br0">&#40;</span>timeval<span class="br0">&#41;</span><span class="br0">&#41;</span>
                          UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>YearFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, month, date<span class="br0">&#41;</span>, 
                                           TimeWithinDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.39: Date.prototype.setUTCMonth */</span>
        prototype <span class="kw2">function</span> setUTCMonth<span class="br0">&#40;</span><span class="kw1">this</span>:Date, month, date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setUTCMonth</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>month<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>date<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setUTCMonth<span class="br0">&#40;</span>month:double, date:double = date<span class="br0">&#41;</span>:double
            timeval = let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                          MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>YearFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>, month, date<span class="br0">&#41;</span>, 
                                   TimeWithinDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.40: Date.prototype.setFullYear */</span>
        prototype <span class="kw2">function</span> setFullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date, year, month, date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setFullYear</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>year<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>month<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>date<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setFullYear<span class="br0">&#40;</span>year:double, 
                                       month:double = month, 
                                       date:double = date<span class="br0">&#41;</span> : double 
            timeval = let <span class="br0">&#40;</span>t : double = LocalTime<span class="br0">&#40;</span>timeval<span class="br0">&#41;</span><span class="br0">&#41;</span>
                          UTCTime<span class="br0">&#40;</span>MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>year, month, date<span class="br0">&#41;</span>, 
                                           TimeWithinDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.9.5.41: Date.prototype.setUTCFullYear */</span>
        prototype <span class="kw2">function</span> setUTCFullYear<span class="br0">&#40;</span><span class="kw1">this</span>:Date, year, month, date<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">setUTCFullYear</span><span class="br0">&#40;</span>double<span class="br0">&#40;</span>year<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>month<span class="br0">&#41;</span>, double<span class="br0">&#40;</span>date<span class="br0">&#41;</span><span class="br0">&#41;</span>; 
&nbsp;
        intrinsic <span class="kw2">function</span> setUTCFullYear<span class="br0">&#40;</span>year:double, 
                                          month:double = month, 
                                          date:double = date<span class="br0">&#41;</span> : double 
            timeval = let <span class="br0">&#40;</span>t : double = timeval<span class="br0">&#41;</span>
                          MakeDate<span class="br0">&#40;</span>MakeDay<span class="br0">&#40;</span>year, month, date<span class="br0">&#41;</span>, 
                                   TimeWithinDay<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
&nbsp;
        <span class="coMULTI">/* Utilities */</span>
&nbsp;
        <span class="kw2">function</span> twoDigit<span class="br0">&#40;</span>n : double<span class="br0">&#41;</span>
            <span class="br0">&#40;</span>n + <span class="nu0">100</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">substring</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> sign<span class="br0">&#40;</span>n : double<span class="br0">&#41;</span>
            n &lt; <span class="nu0">0</span> ? <span class="st0">"-"</span> : <span class="st0">"+"</span>;
&nbsp;
        <span class="coMULTI">/* Primitives from E262-3 */</span>
&nbsp;
        <span class="kw2">var</span> timeval : double;    <span class="co1">// This object's time value</span>
        <span class="kw2">var</span> birthtime : double;  <span class="co1">// INFORMATIVE.  For use by nanoAge</span>
&nbsp;
        static <span class="kw2">const</span> msPerDay : double = <span class="nu0">86400000</span>;
        static <span class="kw2">const</span> hoursPerDay : double = <span class="nu0">24</span>;
        static <span class="kw2">const</span> minutesPerHour : double = <span class="nu0">60</span>;
        static <span class="kw2">const</span> secondsPerMinute : double = <span class="nu0">60</span>;
        static <span class="kw2">const</span> msPerSecond : double = <span class="nu0">1000</span>;
        static <span class="kw2">const</span> msPerMinute : double = msPerSecond * secondsPerMinute;
        static <span class="kw2">const</span> msPerHour : double = msPerMinute * minutesPerHour;
        static <span class="kw2">const</span> monthOffsets : <span class="br0">&#91;</span>double<span class="br0">&#93;</span> 
            = <span class="br0">&#91;</span><span class="nu0">0</span>, <span class="nu0">31</span>, <span class="nu0">59</span>, <span class="nu0">90</span>, <span class="nu0">120</span>, <span class="nu0">151</span>, <span class="nu0">181</span>, <span class="nu0">212</span>, <span class="nu0">243</span>, <span class="nu0">273</span>, <span class="nu0">304</span>, <span class="nu0">334</span><span class="br0">&#93;</span> : <span class="br0">&#91;</span>double<span class="br0">&#93;</span>;
&nbsp;
        <span class="kw2">function</span> MakeTime<span class="br0">&#40;</span>hour:double, min:double, sec:double, ms:double <span class="br0">&#41;</span>:double <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>!isFinite<span class="br0">&#40;</span>hour<span class="br0">&#41;</span> || !isFinite<span class="br0">&#40;</span>min<span class="br0">&#41;</span> || !isFinite<span class="br0">&#40;</span>sec<span class="br0">&#41;</span> || !isFinite<span class="br0">&#40;</span>ms<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">return</span> NaN;
&nbsp;
            <span class="kw1">return</span> Integer<span class="br0">&#40;</span>hour<span class="br0">&#41;</span> * msPerHour +
                Integer<span class="br0">&#40;</span>min<span class="br0">&#41;</span> * msPerMinute +
                Integer<span class="br0">&#40;</span>sec<span class="br0">&#41;</span> * msPerSecond +
                Integer<span class="br0">&#40;</span>ms<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">function</span> MakeDay<span class="br0">&#40;</span>year : double, month : double, date : double<span class="br0">&#41;</span> : double <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>!isFinite<span class="br0">&#40;</span>year<span class="br0">&#41;</span> || !isFinite<span class="br0">&#40;</span>month<span class="br0">&#41;</span> || !isFinite<span class="br0">&#40;</span>date<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">return</span> NaN;
&nbsp;
            year = Integer<span class="br0">&#40;</span>year<span class="br0">&#41;</span>;
            month = Integer<span class="br0">&#40;</span>month<span class="br0">&#41;</span>;
            date = Integer<span class="br0">&#40;</span>date<span class="br0">&#41;</span>;
&nbsp;
            <span class="coMULTI">/* INFORMATIVE, the spec is non-operational. */</span>
            year += Math.<span class="me1">floor</span><span class="br0">&#40;</span>month / <span class="nu0">12</span><span class="br0">&#41;</span>;
&nbsp;
            month = month % <span class="nu0">12</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>month &lt; <span class="nu0">0</span><span class="br0">&#41;</span>
                month += <span class="nu0">12</span>;
&nbsp;
            let leap = <span class="br0">&#40;</span>DaysInYear<span class="br0">&#40;</span>year<span class="br0">&#41;</span> == <span class="nu0">366</span><span class="br0">&#41;</span>;
&nbsp;
            let yearday = Math.<span class="me1">floor</span><span class="br0">&#40;</span>TimeFromYear<span class="br0">&#40;</span>year<span class="br0">&#41;</span> / msPerDay<span class="br0">&#41;</span>;
            let monthday = DayFromMonth<span class="br0">&#40;</span>month, leap<span class="br0">&#41;</span>;
&nbsp;
            <span class="kw1">return</span> yearday + monthday + date - <span class="nu0">1</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">function</span> MakeDate<span class="br0">&#40;</span>day : double, time : double<span class="br0">&#41;</span> : double <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>!isFinite<span class="br0">&#40;</span>day<span class="br0">&#41;</span> || !isFinite<span class="br0">&#40;</span>time<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="kw1">return</span> NaN;
&nbsp;
            <span class="kw1">return</span> day * msPerDay + time;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">function</span> Day<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            Math.<span class="me1">floor</span><span class="br0">&#40;</span>t / msPerDay<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> TimeWithinDay<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            t % msPerDay;
&nbsp;
        <span class="kw2">function</span> HoursFromTime<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            Math.<span class="me1">floor</span><span class="br0">&#40;</span>t / msPerHour<span class="br0">&#41;</span> % hoursPerDay;
        
        <span class="kw2">function</span> DaysInYear<span class="br0">&#40;</span>y : double<span class="br0">&#41;</span> : double <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>y % <span class="nu0">4</span> !== <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="nu0">365</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>y % <span class="nu0">100</span> !== <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="nu0">366</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>y % <span class="nu0">400</span> !== <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">return</span> <span class="nu0">365</span>;
            <span class="kw1">return</span> <span class="nu0">366</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">function</span> DayFromYear<span class="br0">&#40;</span>y : double<span class="br0">&#41;</span> : double 
            <span class="nu0">365</span>*<span class="br0">&#40;</span>y-<span class="nu0">1970</span><span class="br0">&#41;</span> + Math.<span class="me1">floor</span><span class="br0">&#40;</span><span class="br0">&#40;</span>y-<span class="nu0">1969</span><span class="br0">&#41;</span><span class="re0">/<span class="nu0">4</span><span class="br0">&#41;</span> - Math.<span class="me1">floor</span><span class="br0">&#40;</span><span class="br0">&#40;</span>y-<span class="nu0">1901</span><span class="br0">&#41;</span>/<span class="nu0">100</span><span class="br0">&#41;</span> + Math.<span class="me1">floor</span><span class="br0">&#40;</span><span class="br0">&#40;</span>y-<span class="nu0">1601</span><span class="br0">&#41;</span>/</span><span class="nu0">400</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> TimeFromYear<span class="br0">&#40;</span>y : double<span class="br0">&#41;</span> : double
            msPerDay * DayFromYear<span class="br0">&#40;</span>y<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> InLeapYear<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            DaysInYear<span class="br0">&#40;</span>YearFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span> ? <span class="nu0">1</span> : <span class="nu0">0</span>;
&nbsp;
        <span class="kw2">function</span> MonthFromTime<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double <span class="br0">&#123;</span>
            let dwy : double = DayWithinYear<span class="br0">&#40;</span>t<span class="br0">&#41;</span>,
                ily : double = InLeapYear<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span> let i : int=<span class="nu0">0</span> ; i &lt; monthOffsets.<span class="me1">length</span>-<span class="nu0">1</span> ; i++ <span class="br0">&#41;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>dwy &gt; monthOffsets<span class="br0">&#91;</span>i<span class="br0">&#93;</span> + <span class="br0">&#40;</span>i &gt;= <span class="nu0">2</span> ? ily : <span class="nu0">0</span><span class="br0">&#41;</span> &amp;&amp; 
                    dwy &lt; monthOffsets<span class="br0">&#91;</span>i+<span class="nu0">1</span><span class="br0">&#93;</span> + <span class="br0">&#40;</span>i+<span class="nu0">1</span> &gt;= <span class="nu0">2</span> ? ily : <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="kw1">return</span> i;
            <span class="coMULTI">/*NOTREACHED*/</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw2">function</span> DayWithinYear<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span> - DayFromYear<span class="br0">&#40;</span>YearFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> DayFromMonth<span class="br0">&#40;</span>m : double, leap : boolean<span class="br0">&#41;</span> : double 
            <span class="br0">&#40;</span>monthOffsets<span class="br0">&#91;</span>m<span class="br0">&#93;</span> - <span class="nu0">1</span><span class="br0">&#41;</span> + <span class="br0">&#40;</span>leap &amp;&amp; m &gt;= <span class="nu0">2</span> ? <span class="nu0">1</span> : <span class="nu0">0</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> DateFromTime<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            let <span class="br0">&#40;</span>dwy : double = DayWithinYear<span class="br0">&#40;</span>t<span class="br0">&#41;</span>,
                 mft : double = MonthFromTime<span class="br0">&#40;</span>t<span class="br0">&#41;</span>,
                 ily : double = InLeapYear<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="br0">&#41;</span>
                dwy - <span class="br0">&#40;</span>monthOffsets<span class="br0">&#91;</span>mft<span class="br0">&#93;</span> - <span class="nu0">1</span><span class="br0">&#41;</span> - <span class="br0">&#40;</span>mft &gt;= <span class="nu0">2</span> ? ily : <span class="nu0">0</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> WeekDay<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            <span class="br0">&#40;</span>Day<span class="br0">&#40;</span>t<span class="br0">&#41;</span> + <span class="nu0">4</span><span class="br0">&#41;</span> % <span class="nu0">7</span>;
&nbsp;
        <span class="kw2">function</span> LocalTime<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            t + LocalTZA<span class="br0">&#40;</span><span class="br0">&#41;</span> + DaylightSavingTA<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> UTCTime<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double
            t - LocalTZA<span class="br0">&#40;</span><span class="br0">&#41;</span> - DaylighSavingsTA<span class="br0">&#40;</span>t - LocalTZA<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="kw2">function</span> TimeClip<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double 
            <span class="br0">&#40;</span>!isFinite<span class="br0">&#40;</span>t<span class="br0">&#41;</span> || Math.<span class="me1">abs</span><span class="br0">&#40;</span>t<span class="br0">&#41;</span> &gt; <span class="nu0">8</span>.64e15<span class="br0">&#41;</span> ? NaN : Integer<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* INFORMATIVE */</span>
        <span class="kw2">function</span> YearFromTime<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double <span class="br0">&#123;</span>
            let y : double = t / <span class="br0">&#40;</span>msPerDay * <span class="nu0">365</span><span class="br0">&#41;</span>;
            <span class="kw1">while</span> <span class="br0">&#40;</span>TimeFromYear<span class="br0">&#40;</span>y<span class="br0">&#41;</span> &lt; t<span class="br0">&#41;</span>
                y += <span class="nu0">1</span>;
            <span class="kw1">while</span> <span class="br0">&#40;</span>TimeFromYear<span class="br0">&#40;</span>y<span class="br0">&#41;</span> &gt; t<span class="br0">&#41;</span>
                y -= <span class="nu0">1</span>;
            <span class="kw1">return</span> y;
        <span class="br0">&#125;</span>
&nbsp;
        native <span class="kw2">function</span> LocalTZA<span class="br0">&#40;</span><span class="br0">&#41;</span> : double;
        native <span class="kw2">function</span> DaylightSavingsTA<span class="br0">&#40;</span>t : double<span class="br0">&#41;</span> : double;
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
<p>
<strong>PROPOSAL</strong> &ndash; See <a href="doku.php%3Fid=proposals:date_and_time.html" class="wikilink1" title="proposals:date_and_time" onclick="return svchk()" onkeypress="return svchk()">date_and time</a> for information on <code>Date.toISOString</code>, <code>Date.now</code>, <code>Date.nanoAge</code>, changes to <code>Date.parse</code> to handle <acronym title="International Organization for Standardization">ISO</acronym> timestamps, and all the new <code>Date</code> component properties, as well as on the <acronym title="International Organization for Standardization">ISO</acronym> subset format produced by <code>Date.toISOString</code> and accepted by <code>Date.parse</code>.
</p>

</div>
<!-- SECTION [46661-82651] -->
<a name="error_objects"></a><h1>Error objects</h1>
<div class="level1">
<table class="inline">
	<tr>
		<th> Error object </th>
	</tr>
	<tr>
		<td class="leftalign"><code>Error</code>                       </td>
	</tr>
	<tr>
		<td class="leftalign"><code>Error.prototype</code>             </td>
	</tr>
	<tr>
		<td><code>Error.prototype.constructor</code></td>
	</tr>
	<tr>
		<td class="leftalign"><code>Error.prototype.name</code>        </td>
	</tr>
	<tr>
		<td class="leftalign"><code>Error.prototype.message</code>     </td>
	</tr>
	<tr>
		<td class="leftalign"><code>Error.prototype.toString</code>    </td>
	</tr>
</table>
<br />

</div>
<!-- SECTION [82652-82914] -->
<a name="meta-objects"></a><h1>Meta-objects</h1>
<div class="level1">

<p>
 <strong>PROPOSAL</strong> &mdash; Please see the <a href="doku.php%3Fid=proposals:meta_objects.html" class="wikilink1" title="proposals:meta_objects" onclick="return svchk()" onkeypress="return svchk()">Meta-objects proposal page</a> for more information.
</p>

<p>
This proposal adds a reflection mechanism comprising a normative set of meta-objects which provide runtime type information about an object.
</p>

</div>
<!-- SECTION [82915-83193] -->
<a name="regexp_objects"></a><h1>RegExp objects</h1>
<div class="level1">
<pre class="code javascript"><span class="kw2">package</span> RegExp
<span class="br0">&#123;</span>
    <span class="kw2">import</span> Unicode.*;
    <span class="kw2">use</span> <span class="kw2">namespace</span> intrinsic;
    <span class="kw2">use</span> strict;
&nbsp;
    <span class="coMULTI">/* E262-3 15.10: Regular expression object */</span>
    <span class="kw2">public</span> dynamic <span class="kw2">class</span> RegExp
    <span class="br0">&#123;</span>
        <span class="coMULTI">/* E262-3 15.10.3.1: The RegExp constructor called as a function */</span>
        static intrinsic <span class="kw2">function</span> invoke<span class="br0">&#40;</span> pattern, flags <span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>pattern <span class="kw1">is</span> RegExp &amp;&amp; flags === undefined<span class="br0">&#41;</span>
                <span class="kw1">return</span> pattern;
            <span class="kw1">else</span>
                <span class="kw1">return</span> <span class="kw2">new</span> RegExp<span class="br0">&#40;</span>pattern, flags<span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-3 15.10.4.1: The RegExp constructor */</span>
        <span class="kw2">public</span> <span class="kw2">function</span> RegExp<span class="br0">&#40;</span> pattern, flags <span class="br0">&#41;</span> <span class="br0">&#123;</span>
            let source : string = <span class="st0">""</span>;
&nbsp;
            <span class="kw1">if</span> <span class="br0">&#40;</span>pattern <span class="kw1">is</span> RegExp<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>flags === undefined<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    source = pattern.<span class="me1">source</span>;
                    flags = pattern.<span class="me1">flags</span>;
                <span class="br0">&#125;</span>
                <span class="kw1">else</span> 
                    <span class="kw1">throw</span> <span class="kw2">new</span> TypeError<span class="br0">&#40;</span><span class="st0">"Illegal construction of regular expression"</span><span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
            <span class="kw1">else</span> <span class="br0">&#123;</span>
                source = pattern === undefined ? <span class="st0">""</span> : ToString<span class="br0">&#40;</span>pattern<span class="br0">&#41;</span>;
                flags = flags === undefined ? <span class="st0">""</span> : ToString<span class="br0">&#40;</span>flags<span class="br0">&#41;</span>;
            <span class="br0">&#125;</span>
&nbsp;
            let usedflags : Object! = <span class="br0">&#123;</span> m: <span class="kw2">false</span>, i: <span class="kw2">false</span>, g: <span class="kw2">false</span>, x: <span class="kw2">false</span>, y: <span class="kw2">false</span> <span class="br0">&#125;</span>;
&nbsp;
            <span class="kw1">for</span> each <span class="br0">&#40;</span> let f : string <span class="kw1">in</span> flags.<span class="me1">split</span><span class="br0">&#40;</span><span class="st0">""</span><span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>!<span class="br0">&#40;</span>f <span class="kw1">in</span> usedflags<span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="kw1">throw</span> <span class="kw2">new</span> SyntaxError<span class="br0">&#40;</span><span class="st0">"Invalid flag: "</span> + f<span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>usedflags.<span class="me1">f</span><span class="br0">&#41;</span>
                    <span class="kw1">throw</span> <span class="kw2">new</span> SyntaxError<span class="br0">&#40;</span><span class="st0">"Duplicated flag: "</span> + f<span class="br0">&#41;</span>;
                usedflags<span class="br0">&#91;</span>f<span class="br0">&#93;</span> = <span class="kw2">true</span>;
            <span class="br0">&#125;</span>
&nbsp;
            matcher = <span class="br0">&#40;</span><span class="kw2">new</span> RegExpCompiler<span class="br0">&#40;</span>source, flags<span class="br0">&#41;</span><span class="br0">&#41;</span>.<span class="me1">compile</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
            multiline = usedflags.<span class="me1">m</span>;
            ignoreCase = usedflags.<span class="me1">i</span>;
            global = usedflags.<span class="me1">g</span>;
            extended = usedflags.<span class="me1">x</span>;
            sticky = usedflags.<span class="me1">y</span>;
            lastIndex = <span class="nu0">0</span>;
            source = source;
        <span class="br0">&#125;</span>
&nbsp;
        <span class="coMULTI">/* E262-4 proposals:extend_regexps: RegExp instances are
           callable, and a call to an instance is equivalent to
           calling its exec() method.
        */</span>
        <span class="kw2">public</span> <span class="kw2">function</span> invoke<span class="br0">&#40;</span>s<span class="br0">&#41;</span> : Array
            <span class="kw1">this</span>.<span class="me1">exec</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
&nbsp;
        intrinsic <span class="kw2">function</span> invoke<span class="br0">&#40;</span>s : string<span class="br0">&#41;</span> : Array
            exec<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.10.6.2: RegExp.prototype.exec */</span>
        intrinsic <span class="kw2">function</span> exec<span class="br0">&#40;</span>s : string<span class="br0">&#41;</span> : Array <span class="br0">&#123;</span>
            let S : string = ToString<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
            let length : uint = S.<span class="me1">length</span>;
            let i : double = ToInteger<span class="br0">&#40;</span>lastIndex<span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>!global<span class="br0">&#41;</span>
                i = <span class="nu0">0</span>;
            let res : MatchResult = failure;
            <span class="kw1">while</span> <span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">if</span> <span class="br0">&#40;</span>i &lt; <span class="nu0">0</span> || i &gt; length<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    lastIndex = <span class="nu0">0</span>;
                    <span class="kw1">return</span> <span class="kw2">null</span>;
                <span class="br0">&#125;</span>
                res = matcher.<span class="me1">match</span><span class="br0">&#40;</span>s, i<span class="br0">&#41;</span>;
                <span class="kw1">if</span> <span class="br0">&#40;</span>res !== failure<span class="br0">&#41;</span>
                    <span class="kw1">break</span>;
                ++i;
            <span class="br0">&#125;</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>global<span class="br0">&#41;</span>
                lastIndex = res.<span class="me1">endIndex</span>;
            let a : Array = <span class="kw2">new</span> Array<span class="br0">&#40;</span>res.<span class="me1">cap</span>.<span class="me1">length</span>+<span class="nu0">1</span><span class="br0">&#41;</span>;
            a.<span class="me1">index</span> = i;
            a.<span class="me1">input</span> = S;
            a.<span class="me1">length</span> = res.<span class="me1">cap</span>.<span class="me1">length</span>+<span class="nu0">1</span>;
            a<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> = S.<span class="me1">substring</span><span class="br0">&#40;</span>i,res.<span class="me1">endIndex</span><span class="br0">&#41;</span>;
            <span class="kw1">for</span> <span class="br0">&#40;</span> <span class="kw2">var</span> j=<span class="nu0">1</span> ; j &lt;= res.<span class="me1">cap</span>.<span class="me1">length</span> ; j++ <span class="br0">&#41;</span>
                a<span class="br0">&#91;</span>j<span class="br0">&#93;</span> = res.<span class="me1">cap</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
            <span class="kw1">return</span> a;
        <span class="br0">&#125;</span>
&nbsp;
        prototype <span class="kw2">function</span> exec<span class="br0">&#40;</span>s<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">exec</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.10.6.3: RegExp.prototype.test */</span>
        intrinsic <span class="kw2">function</span> test<span class="br0">&#40;</span>s : string<span class="br0">&#41;</span> : Boolean
            exec<span class="br0">&#40;</span>s<span class="br0">&#41;</span> !== <span class="kw2">null</span>;
&nbsp;
        prototype <span class="kw2">function</span> test<span class="br0">&#40;</span>s<span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">test</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.10.6.4: RegExp.prototype.toString */</span>
        intrinsic <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span> : string
            <span class="st0">"/"</span> + <span class="br0">&#40;</span>source.<span class="me1">length</span> == <span class="nu0">0</span> ? <span class="st0">"(?:)"</span> : source<span class="br0">&#41;</span> + <span class="st0">"/"</span> + flags;
&nbsp;
        prototype <span class="kw2">function</span> toString<span class="br0">&#40;</span><span class="br0">&#41;</span>
            <span class="kw1">this</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-3 15.10.7: properties of regexp instances */</span>
        <span class="kw2">public</span> <span class="kw2">const</span> multiline  : Boolean;
        <span class="kw2">public</span> <span class="kw2">const</span> ignoreCase : Boolean;
        <span class="kw2">public</span> <span class="kw2">const</span> global     : Boolean;
        <span class="kw2">public</span> <span class="kw2">const</span> extended   : Boolean;  <span class="co1">// E262-4 proposals:extend_regexps</span>
        <span class="kw2">public</span> <span class="kw2">const</span> sticky     : Boolean;  <span class="co1">// E262-4 proposals:extend_regexps</span>
        <span class="kw2">public</span> <span class="kw2">const</span> source     : string;
        <span class="kw2">public</span> <span class="kw2">var</span>   lastIndex  : double;
&nbsp;
        <span class="coMULTI">/* E262-4 - [[Match]] may not *have* to be public, but String
           uses it, and if we want to model the language in the
           language we should expose it -- it's benign. 
        */</span>
        intrinsic <span class="kw2">function</span> match<span class="br0">&#40;</span>s : string, i : uint<span class="br0">&#41;</span> : MatchResult
            matcher.<span class="me1">match</span><span class="br0">&#40;</span>s, i<span class="br0">&#41;</span>;
&nbsp;
        <span class="coMULTI">/* E262-4 - nCapturingParens used by String.prototype.replace 
         */</span>
        intrinsic <span class="kw2">function</span> get nCapturingParens<span class="br0">&#40;</span><span class="br0">&#41;</span> : uint
            matcher.<span class="me1">nCapturingParens</span>;
&nbsp;
        <span class="coMULTI">/* Internal */</span>
        <span class="kw2">const</span> matcher : RegExpMatcher;      <span class="co1">// The [[Match]] property</span>
&nbsp;
        <span class="kw2">function</span> get flags<span class="br0">&#40;</span><span class="br0">&#41;</span> : string <span class="br0">&#123;</span>
            <span class="kw1">return</span> <span class="br0">&#40;</span>multiline ? <span class="st0">"m"</span> : <span class="st0">""</span><span class="br0">&#41;</span> +
                   <span class="br0">&#40;</span>ignoreCase ? <span class="st0">"i"</span> : <span class="st0">""</span><span class="br0">&#41;</span> +
                   <span class="br0">&#40;</span>global ? <span class="st0">"g"</span> : <span class="st0">""</span><span class="br0">&#41;</span> +
                   <span class="br0">&#40;</span>extended ? <span class="st0">"x"</span> : <span class="st0">""</span><span class="br0">&#41;</span> +
                   <span class="br0">&#40;</span>sticky ? <span class="st0">"y"</span> : <span class="st0">""</span><span class="br0">&#41;</span>;
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;</pre>
<p>
<strong>PROPOSAL</strong> &mdash; Please see the <a href="doku.php%3Fid=proposals:extend_regexps.html" class="wikilink1" title="proposals:extend_regexps" onclick="return svchk()" onkeypress="return svchk()">Extended regular expressions proposal page</a> for more information. 
</p>

</div>
<!-- SECTION [83194-] -->
<!-- cachefile /usr/local/www/es-lang.org/wiki/data/cache/c/ccdb8635bd33aad5834d79a7287057ab.xhtml used -->
</body>
</html>
