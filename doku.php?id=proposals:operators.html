<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <title>proposals:operators [ES Wiki]</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=proposals:operators&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=proposals" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=proposals:operators&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=proposals:operators&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="date" content="2009-05-15T17:33:18+0000" />
  <meta name="robots" content="index,follow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />

  <link rel="shortcut icon" href="lib/images/favicon.ico" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/layout.css" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/design.css" />

  
  <link rel="stylesheet" media="print" type="text/css" href="lib/tpl/default/print.css" />

  <!--[if gte IE 5]>
  <style type="text/css">
    /* that IE 5+ conditional comment makes this only visible in IE 5+ */
    /* IE bugfix for transparent PNGs */
    //DISABLED   img { behavior: url("/lib/scripts/pngbehavior.htc"); }
  </style>
  <![endif]-->

  </head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="doku.php%3Fid=proposals:operators&amp;do=backlink.html" onclick="return svchk()" onkeypress="return svchk()">proposals:operators</a>]]
      </div>
      <div class="logo">
        <a href="doku.php%3Fid=.html" onclick="return svchk()" onkeypress="return svchk()" name="top" accesskey="h" title="[ALT+H]">ES Wiki</a>      </div>
    </div>
  
    
    <div class="bar" id="bar_top">
      <div class="bar-left" id="bar_topleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="proposals:operators" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="proposals:operators" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
  
      <div class="bar-right" id="bar_topright">
        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="recent" /><input type="hidden" name="id" value="" /><input type="submit" value="Recent changes" class="button" title="ALT+R" accesskey="r" /></form>        <form action="doku.php%3Fid=.html" accept-charset="utf-8" class="search" name="search" onsubmit="return svchk()"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch_in" accesskey="f" name="id" class="edit" onkeyup="ajax_qsearch.call('qsearch_in','qsearch_out')" /><input type="submit" value="Search" class="button" /><div id="qsearch_out" class="ajax_qsearch" onclick="this.style.display='none'"></div></form>&nbsp;
      </div>
    </div>

        <div class="breadcrumbs">
      Trace: <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:maintenance_of_es3.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:maintenance_of_es3">maintenance_of_es3</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:bound_this.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:bound_this">bound_this</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:self_type.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:self_type">self_type</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:oopkoolaid.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:oopkoolaid">oopkoolaid</a> <span class="bcsep">&raquo;</span> <span class="curid"><a href="doku.php%3Fid=proposals:operators.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:operators">operators</a></span>          </div>
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#class-defined_operators" class="toc">Class-Defined Operators</a></span><ul class="toc">
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#syntax" class="toc">Syntax</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#dispatch" class="toc">Dispatch</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#result" class="toc">Result</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#type_checking" class="toc">Type checking</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#operator_substitution" class="toc">Operator substitution</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#default_behavior" class="toc">Default behavior</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#inheritence_and_overriding" class="toc">Inheritence and overriding</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:operators.html#examples" class="toc">Examples</a></span></li>
</ul>
</li>
</ul>
</div>
</div>

<a name="class-defined_operators"></a><h1>Class-Defined Operators</h1>
<div class="level1">

<p>
 NOTE: this proposal is superseded by <a href="doku.php%3Fid=proposals:generic_functions.html" class="wikilink1" title="proposals:generic_functions" onclick="return svchk()" onkeypress="return svchk()">generic functions</a>. It is no longer linked from <a href="doku.php%3Fid=proposals:proposals.html" class="wikilink1" title="proposals:proposals" onclick="return svchk()" onkeypress="return svchk()">proposals</a>.
</p>

<p>
(Also see the <a href="doku.php%3Fid=discussion:operators.html" class="wikilink1" title="discussion:operators" onclick="return svchk()" onkeypress="return svchk()">discussion page</a> for this proposal)
</p>

<p>
The proposal is based on <a href="http://www.mozilla.org/js/language/js20-2002-04/core/operators.html" class="urlextern" target="_blank" title="http://www.mozilla.org/js/language/js20-2002-04/core/operators.html" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">Waldemar Horwat's proposal</a>. Argument type based function dispatch has not been selected because this concept has not yet been introduced to ECMAScript in general. 
</p>

</div>

<a name="syntax"></a><h2>Syntax</h2>
<div class="level2">

<p>
 A class definition may contain static methods that define how to interpret primitive operators applied to instances of the class.  Such a method is defined using the following syntax:
</p>
<pre class="code javascript">  <span class="kw2">public</span> static <span class="kw2">function</span> &lt;operator&gt; <span class="br0">&#40;</span>lhs : *, rhs : *<span class="br0">&#41;</span> : *</pre>
<p>
where the term <em>operator</em> defines the operator to be redefined; it is a standard operator token from the list below, eg, <code>+</code>.
</p>

<p>
The following operators are overridable:
</p>

<p>
Unary operators:
</p>
<pre class="code">+ - ~</pre>

<p>
 Binary operators:
</p>
<pre class="code">+ - * / % ^ &lt; &gt; &lt;= &gt;= == &lt;&lt; &gt;&gt; &gt;&gt;&gt; &amp; | === != !==</pre>

<p>
 Compound assignment operators:
</p>
<pre class="code">+= -= *= /= %= ^= &lt;&lt;= &gt;&gt;= &gt;&gt;&gt;= &amp;= |=</pre>

<p>
 No other operators are overridable.
</p>

<p>
Operator methods must be <code>public</code> and <code>static</code>.
</p>

<p>
Both argument types and result type can be defined more narrowly than <code>*</code>.
</p>

</div>

<a name="dispatch"></a><h2>Dispatch</h2>
<div class="level2">

<p>
 The dispatch rule for <code>E1 op E2</code>:
</p>
<ul>
<li class="level1"><div class="li"> Evaluate E1 yielding a non-reference value V1</div>
</li>
<li class="level1"><div class="li"> Evaluate E2 yielding a non-reference value V2</div>
</li>
<li class="level1"><div class="li"> If the concrete class of V1 has a static operator function <code>op</code>, call it on V1 and V2.</div>
</li>
<li class="level1"><div class="li"> Else if the concrete class of V2 has a static operator function <code>op</code>, call it on V1 and V2.</div>
</li>
<li class="level1"><div class="li"> Else call <code>intrinsic::op(V1,V2)</code></div>
</li>
</ul>

<p>
 The dispatch rule for <code>E1 op= E2</code> is:
</p>
<ul>
<li class="level1"><div class="li"> Evaluate E1 yielding a reference value R1</div>
</li>
<li class="level1"><div class="li"> Read the reference of R1 yielding a non-reference value V1</div>
</li>
<li class="level1"><div class="li"> Evaluate E2 yielding a non-reference value V2</div>
</li>
<li class="level1"><div class="li"> If the concrete class of V1 has a static operator function <code>op=</code>, call it on V1 and V2, yielding a value V</div>
</li>
<li class="level1"><div class="li"> Else call <code>intrinsic::op(V1,V2)</code> yielding a value V</div>
</li>
<li class="level1"><div class="li"> Write the reference R1 with the value V</div>
</li>
</ul>

<p>
 The dispatch rule for <code>op E</code> is:
</p>
<ul>
<li class="level1"><div class="li"> Evaluate E yielding a non-reference value V</div>
</li>
<li class="level1"><div class="li"> If the concrete class of V has a static operator function <code>op</code>, call it on V and null</div>
</li>
<li class="level1"><div class="li"> Else call <code>intrinsic::op(V,null)</code></div>
</li>
</ul>

</div>

<a name="result"></a><h2>Result</h2>
<div class="level2">

<p>
 The return value from the operator method becomes the result of the operation.
</p>

</div>

<a name="type_checking"></a><h2>Type checking</h2>
<div class="level2">

<p>
 The arguments and result types are subject to static and dynamic type checking, as appropriate.
</p>

<p>
<em>Note</em>: This can sometimes lead to surprising results; this program will fail:
</p>
<pre class="code">
    class C {
        public static operator +(a:C, b:Number): Number { ... }
    }
    + new C;
</pre>

<p>
The application of unary <code>+</code> to an instance of <code>C</code> will call the operator function with <code>null</code> for the second argument; however, Number is a non-nullable type, so this is a type error.  One would wish to use <code>Number?</code> for the type of the second argument.
</p>

</div>

<a name="operator_substitution"></a><h2>Operator substitution</h2>
<div class="level2">

<p>
 It is possible to perform a partial override of comparison operators &lt;, &gt;, &lt;=, &gt;=, ==, ===, !=, and !==.  If it is possible to substitute the override of a comparison operator with the Boolean negation of the result of an overridden operator, this operation will be performed. 
</p>
<table class="inline">
	<tr>
		<th> If this operator is not defined </th><th> But this operator is defined </th><th> Perform this operation </th>
	</tr>
	<tr>
		<td> &lt; </td><td> &gt;= </td><td> ! &gt;= </td>
	</tr>
	<tr>
		<td> &gt; </td><td>&lt;=</td><td> ! &lt;=</td>
	</tr>
	<tr>
		<td>&lt;=</td><td> &gt; </td><td> ! &gt; </td>
	</tr>
	<tr>
		<td> &gt;= </td><td> &lt; </td><td> ! &lt; </td>
	</tr>
	<tr>
		<td> != </td><td> == </td><td> ! == </td>
	</tr>
	<tr>
		<td> !== </td><td> === </td><td> ! === </td>
	</tr>
	<tr>
		<td> == </td><td> != </td><td> ! != </td>
	</tr>
	<tr>
		<td> === </td><td> !== </td><td> ! !== </td>
	</tr>
</table>
<br />

</div>

<a name="default_behavior"></a><h2>Default behavior</h2>
<div class="level2">

<p>
 If the override function decides not to implement functionality for certain argument types, default behavior can be invoked by calling the predefined operator override in the <a href="doku.php%3Fid=proposals:intrinsic_namespace.html" class="wikilink1" title="proposals:intrinsic_namespace" onclick="return svchk()" onkeypress="return svchk()">intrinsic namespace</a>.
</p>

</div>

<a name="inheritence_and_overriding"></a><h2>Inheritence and overriding</h2>
<div class="level2">

<p>
 User-defined operators are not inheritable along the nominal type hierarchy. There is only the simple dispatch rule above. If an operator is not declared on the concrete types involved in an expression, the intrinsic operator is called.
</p>

</div>

<a name="examples"></a><h2>Examples</h2>
<div class="level2">
<pre class="code">class A 
{
  public static function +(lhs: Object, rhs: Object):Object { ... }
  public static function /(lhs: Object, rhs: Object):Object { ... }
}
var a:A = new A()
a / 5  //   A::/ (a, 5)
5 / a  //   A::/ (5, a)
a + 5  //   A::+ (a, 5)
+a     //   A::+ (a, null)</pre>

</div>

<!-- no cachefile used, but created -->
    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
      <div class="doc">
        proposals/operators.txt &middot; Last modified: 2009/05/15 17:33 by brendan      </div>
    </div>

   
    <div class="bar" id="bar_bottom">
      <div class="bar-left" id="bar_bottomleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="proposals:operators" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="proposals:operators" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
      <div class="bar-right" id="bar_bottomright">
                        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="login" /><input type="hidden" name="id" value="proposals:operators" /><input type="submit" value="Login" class="button" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="index" /><input type="hidden" name="id" value="proposals:operators" /><input type="submit" value="Index" class="button" title="ALT+X" accesskey="x" /></form>        <a href="doku.php%3Fid=proposals:operators.html#top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" /></a>&nbsp;
      </div>
    </div>

  </div>

</div>

<div align="center" class="footerinc">
  <a target="_blank" href="feed.php" title="Recent changes RSS feed"><img src="lib/tpl/default/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="license" title="Creative Commons License"><img src="lib/tpl/default/images/button-cc.gif" width="80" height="15" alt="Creative Commons License" border="0" /></a>

  <a target="_blank" href="https://www.paypal.com/xclick/business=andi%40splitbrain.org&amp;item_name=DokuWiki+Donation&amp;no_shipping=1&amp;no_note=1&amp;tax=0&amp;currency_code=EUR&amp;lc=US" title="Donate"><img src="lib/tpl/default/images/button-donate.gif" alt="Donate" border="0" /></a>

  <a target="_blank" href="http://www.php.net" title="Powered by PHP"><img src="lib/tpl/default/images/button-php.gif" width="80" height="15" alt="Powered by PHP" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="lib/tpl/default/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="lib/tpl/default/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="lib/tpl/default/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>



<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->
</div>

<img src="lib/exe/indexer.php%3Fid=proposals%253Aoperators&amp;1454276553" width="1" height="1" alt=""  /></body>
</html>
