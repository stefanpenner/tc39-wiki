<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <title>proposals:type_parameters [ES Wiki]</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=proposals:type_parameters&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=proposals" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=proposals:type_parameters&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=proposals:type_parameters&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="date" content="2008-07-14T18:28:32+0000" />
  <meta name="robots" content="index,follow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />

  <link rel="shortcut icon" href="lib/images/favicon.ico" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/layout.css" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/design.css" />

  
  <link rel="stylesheet" media="print" type="text/css" href="lib/tpl/default/print.css" />

  <!--[if gte IE 5]>
  <style type="text/css">
    /* that IE 5+ conditional comment makes this only visible in IE 5+ */
    /* IE bugfix for transparent PNGs */
    //DISABLED   img { behavior: url("/lib/scripts/pngbehavior.htc"); }
  </style>
  <![endif]-->

  </head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="doku.php%3Fid=proposals:type_parameters&amp;do=backlink.html" onclick="return svchk()" onkeypress="return svchk()">proposals:type_parameters</a>]]
      </div>
      <div class="logo">
        <a href="doku.php%3Fid=.html" onclick="return svchk()" onkeypress="return svchk()" name="top" accesskey="h" title="[ALT+H]">ES Wiki</a>      </div>
    </div>
  
    
    <div class="bar" id="bar_top">
      <div class="bar-left" id="bar_topleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="proposals:type_parameters" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="proposals:type_parameters" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
  
      <div class="bar-right" id="bar_topright">
        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="recent" /><input type="hidden" name="id" value="" /><input type="submit" value="Recent changes" class="button" title="ALT+R" accesskey="r" /></form>        <form action="doku.php%3Fid=.html" accept-charset="utf-8" class="search" name="search" onsubmit="return svchk()"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch_in" accesskey="f" name="id" class="edit" onkeyup="ajax_qsearch.call('qsearch_in','qsearch_out')" /><input type="submit" value="Search" class="button" /><div id="qsearch_out" class="ajax_qsearch" onclick="this.style.display='none'"></div></form>&nbsp;
      </div>
    </div>

        <div class="breadcrumbs">
      Trace: <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:grammar.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:grammar">grammar</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:semantics.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:semantics">semantics</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:built-in_objects.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:built-in_objects">built-in_objects</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=proposals:descriptive_prose.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:descriptive_prose">descriptive_prose</a> <span class="bcsep">&raquo;</span> <span class="curid"><a href="doku.php%3Fid=proposals:type_parameters.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="proposals:type_parameters">type_parameters</a></span>          </div>
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="doku.php%3Fid=proposals:type_parameters.html#type_parameters" class="toc">Type parameters</a></span><ul class="toc">
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:type_parameters.html#type_parameter_lists" class="toc">Type parameter lists</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:type_parameters.html#type_argument_lists" class="toc">Type argument lists</a></span><ul class="toc">
<li class="level3"><span class="li"><a href="doku.php%3Fid=proposals:type_parameters.html#missing_type_arguments" class="toc">Missing type arguments</a></span></li>
</ul>
</li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:type_parameters.html#extended_example" class="toc">Extended example</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=proposals:type_parameters.html#variance_roadmap" class="toc">Variance roadmap</a></span></li>
</ul>
</li>
</ul>
</div>
</div>

<a name="type_parameters"></a><h1>Type parameters</h1>
<div class="level1">

<p>
 (Also see the <a href="doku.php%3Fid=discussion:type_parameters.html" class="wikilink1" title="discussion:type_parameters" onclick="return svchk()" onkeypress="return svchk()">discussion page</a> for this proposal)
</p>

<p>
This proposal introduces basic named type parameters into type definitions, and extends type expressions with an argument position. In other words, a mechanism for constructing some families of generic types. The proposed type parameters are opaque beyond equality, carry no bounds, and have no variance annotations.
</p>

<p>
The aim of this proposal is to introduce the minimum machinery necessary to provide typesafe collections. It is a hypothesis of the proposal that many of the mechanisms that might rely on type bounds and variance annotations are either uncommon cases, or can be simulated with user-provided first class functions. This hypothesis may be explored in some detail below.
</p>

</div>

<a name="type_parameter_lists"></a><h2>Type parameter lists</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> A type <em>parameter list</em> is a comma-separated list of identifiers enclosed in angle-brackets, with a leading dot. For example, the parameter list with three parameters <code>A</code>, <code>B</code>, and <code>C</code> is denoted <code>.&lt;A,B,C&gt;</code></div>
</li>
<li class="level1"><div class="li"> Type parameter lists are valid in the following contexts:</div>
<ul>
<li class="level2"><div class="li"> Following the name of a nominal type. The type parameters in this context can be used in the scope of the nominal type declaration. The following examples illustrate:</div>
<ul>
<li class="level3"><div class="li"> <code>class List.&lt;Elt&gt; { var head:Elt; ... }</code></div>
</li>
<li class="level3"><div class="li"> <code>interface Map.&lt;Key,Value&gt; { function get(Key):Value; ... }</code></div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Following the name of a function at the site of a named function definition. The type parameters in this context can be used in the function parameter list and function body. The following example illustrates:</div>
<ul>
<li class="level3"><div class="li"> <code>function sort.&lt;T&gt;(a: List.&lt;T&gt;) { var tmp:T; ...}</code></div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Following the name of a <em>named</em> structural type. The type parameters in this context can be used in the right-hand-side of a structural type definition. The following examples illustrate:</div>
<ul>
<li class="level3"><div class="li"> <code>type pair.&lt;T&gt; = [T,T];</code></div>
</li>
<li class="level3"><div class="li"> <code>type coord3d.&lt;N&gt; = {x:N, y:N, z:N};</code></div>
</li>
<li class="level3"><div class="li"> <code>type either.&lt;A,B&gt; = (A,B);</code></div>
</li>
<li class="level3"><div class="li"> <code>type hashfn.&lt;T&gt; = function(T):uint;</code></div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Following the optional name of a function in a function expression. The type parameters in this context can be used in the function parameter list and function body. The following examples illustrate:</div>
<ul>
<li class="level3"><div class="li"> <code>function sort.&lt;T&gt;(a: List.&lt;T&gt;) { var tmp:T; ...}</code></div>
</li>
<li class="level3"><div class="li"> <code>function.&lt;T&gt;(a: T):T { return a }</code></div>
</li>
<li class="level3"><div class="li"> <code>function.&lt;T&gt;(a: T):T a</code></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

<a name="type_argument_lists"></a><h2>Type argument lists</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> A type <em>argument list</em> is a comma-separated list of type expressions enclosed in angle brackets, with a leading dot. </div>
</li>
<li class="level1"><div class="li"> Type expressions provided in the type argument list are bound to the type parameters in the corresponding parametric type&rsquo;s type parameter list.</div>
</li>
<li class="level1"><div class="li"> Type expressions can contain any type names in scope, including parameter names in an enclosing type parameter scope.</div>
</li>
<li class="level1"><div class="li"> Type argument lists are syntactically valid in the following contexts:</div>
<ul>
<li class="level2"><div class="li"> Following any type name in a type expression. This includes type expressions used as variable and function-parameter annotations, and type sub-expressions <em>within</em> such type expressions. The following examples illustrate: </div>
<ul>
<li class="level3"><div class="li"> <code>var x : List.&lt;int&gt; = ...</code></div>
</li>
<li class="level3"><div class="li"> <code>var y : List.&lt;Map.&lt;pair.&lt;int&gt;, coord3d.&lt;double&gt; &gt; &gt; = ...</code></div>
</li>
<li class="level3"><div class="li"> <code>function histogram(x: List.&lt;int&gt;): List.&lt;pair.&lt;int&gt; &gt; { ... }</code></div>
</li>
<li class="level3"><div class="li"> <code>class Hashtable.&lt;K,V&gt; { var x : function(k:K):uint; { ... } ... }</code></div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Following any function name in function-call, or any class name in constructor-call context. The following examples illustrate:</div>
<ul>
<li class="level3"><div class="li"> <code>sort.&lt;int&gt;(x)</code></div>
</li>
<li class="level3"><div class="li"> <code>new Map.&lt;string,int&gt;()</code></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

<a name="missing_type_arguments"></a><h3>Missing type arguments</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> It is a semantic error for a type argument list to have a different length than its corresponding type parameter list</div>
</li>
</ul>

</div>

<a name="extended_example"></a><h2>Extended example</h2>
<div class="level2">

<p>
 Here is an example of some parametric types implementing hashtables, to give a flavour of the proposal:
</p>
<pre class="code">

type hashfn.&lt;T&gt; = function(T):uint;

class Hashtable.&lt;K,V&gt;
{
  var hash_func : hashfn.&lt;K&gt;;
  var store : [ [K,V] ];

  function fetch(k:K) : V
  {
    var ix : uint = hash_func(k);
    while (store[ix][0] != k)
      ix = ... // some probe sequence
    return store[ix][1];
  }

  function Hashtable(hf:hashfn.&lt;K&gt;) 
  {
    hash_func = hf;
  }
}

function mk_identity.&lt;T&gt;():(function(T):T)
{
  return function(t:T):T { return t; };
}

var id : hashfn.&lt;uint&gt; = mk_identity.&lt;uint&gt;();
var h : Hashtable.&lt;uint,string&gt; = new Hashtable.&lt;uint,string&gt;(id);

</pre>

</div>

<a name="variance_roadmap"></a><h2>Variance roadmap</h2>
<div class="level2">

<p>
 Future versions of the language may wish to incorporate variance-annotations, such as those proposed <a href="http://www.daimi.au.dk/~plesner/variance/" class="urlextern" target="_blank" title="http://www.daimi.au.dk/~plesner/variance/" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">here</a>, or better yet <a href="http://www.sato.kuis.kyoto-u.ac.jp/~igarashi/papers/variance.html" class="urlextern" target="_blank" title="http://www.sato.kuis.kyoto-u.ac.jp/~igarashi/papers/variance.html" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">here</a>. Annotations of this sort are present in several languages as an extension of their &ldquo;generics&rdquo; mechanism. If in the future we adopt such annotations, the un-annotated identifiers of this proposal shall implicitly be interpreted as carrying the &ldquo;invariant&rdquo; (<code>=</code>) annotation. There should be no syntactic difficulty with adopting full variance annotations, if desired.
</p>

<p>
However, we might not need to assume that variance annotations will ever be necessary in future ES editions. It seems that the need for them is somewhat mitigated by the presence of first class functions with a subtyping rule on functions. For example, we can expect that if <a href="doku.php%3Fid=proposals:iterators_and_generators.html" class="wikilink1" title="proposals:iterators_and_generators" onclick="return svchk()" onkeypress="return svchk()">iterators and generators</a> is accepted, then we can imagine a container type like this:
</p>
<pre class="code javascript"><span class="kw2">class</span> Container.&lt;T&gt; 
<span class="br0">&#123;</span>
  <span class="kw2">var</span> contents : <span class="br0">&#91;</span>T<span class="br0">&#93;</span>;
  <span class="co1">// ...</span>
  <span class="kw2">function</span> items<span class="br0">&#40;</span><span class="br0">&#41;</span> : <span class="br0">&#40;</span><span class="kw2">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> : GeneratorType.&lt;T&gt;<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="co1">// return a generator yielding values in contents:</span>
    <span class="kw1">return</span> <span class="kw2">function</span> <span class="br0">&#40;</span><span class="br0">&#41;</span>
           <span class="br0">&#123;</span>
             <span class="kw1">for</span> <span class="br0">&#40;</span>let i : uint = <span class="nu0">0</span>; i &lt; contents.<span class="me1">length</span>; i++<span class="br0">&#41;</span>
               yield contents<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
           <span class="br0">&#125;</span>;
  <span class="br0">&#125;</span> 
<span class="br0">&#125;</span></pre>
<p>
This sort of iterator function is essentially a &ldquo;<code>T</code> reader&rdquo; function, which ought to be usable in contexts where a &ldquo;<code>U</code> reader&rdquo; is required, and <code>T &lt;: U</code>. This is permitted under the subtyping rules of functions, but is exactly the use case which variance-annotation exists to help with: you can give a Rectangle-reader to a function that specifies that it wants only a Shape-reader. The opposite direction works the same way: you can give a Shape-consumer first class function to a function that expects a Rectangle-consumer, because <code>function(Shape) &lt;: function(Rectangle)</code>, due to the contravariant argument-subtyping rule. 
</p>

</div>

<!-- no cachefile used, but created -->
    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
      <div class="doc">
        proposals/type_parameters.txt &middot; Last modified: 2008/07/14 18:28 by jodyer      </div>
    </div>

   
    <div class="bar" id="bar_bottom">
      <div class="bar-left" id="bar_bottomleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="proposals:type_parameters" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="proposals:type_parameters" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
      <div class="bar-right" id="bar_bottomright">
                        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="login" /><input type="hidden" name="id" value="proposals:type_parameters" /><input type="submit" value="Login" class="button" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="index" /><input type="hidden" name="id" value="proposals:type_parameters" /><input type="submit" value="Index" class="button" title="ALT+X" accesskey="x" /></form>        <a href="doku.php%3Fid=proposals:type_parameters.html#top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" /></a>&nbsp;
      </div>
    </div>

  </div>

</div>

<div align="center" class="footerinc">
  <a target="_blank" href="feed.php" title="Recent changes RSS feed"><img src="lib/tpl/default/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="license" title="Creative Commons License"><img src="lib/tpl/default/images/button-cc.gif" width="80" height="15" alt="Creative Commons License" border="0" /></a>

  <a target="_blank" href="https://www.paypal.com/xclick/business=andi%40splitbrain.org&amp;item_name=DokuWiki+Donation&amp;no_shipping=1&amp;no_note=1&amp;tax=0&amp;currency_code=EUR&amp;lc=US" title="Donate"><img src="lib/tpl/default/images/button-donate.gif" alt="Donate" border="0" /></a>

  <a target="_blank" href="http://www.php.net" title="Powered by PHP"><img src="lib/tpl/default/images/button-php.gif" width="80" height="15" alt="Powered by PHP" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="lib/tpl/default/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="lib/tpl/default/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="lib/tpl/default/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>



<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->
</div>

<img src="lib/exe/indexer.php%3Fid=proposals%253Atype_parameters&amp;1454275564" width="1" height="1" alt=""  /></body>
</html>
