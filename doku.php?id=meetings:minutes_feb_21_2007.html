<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
 lang="en" dir="ltr">
<head>
  <title>meetings:minutes_feb_21_2007 [ES Wiki]</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <meta name="generator" content="DokuWiki Release 2005-09-22e" />
  <link rel="start" href="index.html" />
  <link rel="contents" href="doku.php%3Fid=meetings:minutes_feb_21_2007&amp;do=index.html" title="" />
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="feed.php" />
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="feed.php%3Fmode=list&amp;ns=meetings" />
  <link rel="alternate" type="text/html" title="Plain HTML" href="doku.php%3Fid=meetings:minutes_feb_21_2007&amp;do=export_html.html" />
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="doku.php%3Fid=meetings:minutes_feb_21_2007&amp;do=export_raw" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/styles/style.css" />
  <meta name="date" content="2007-03-13T21:44:03+0000" />
  <meta name="robots" content="index,follow" />
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = 'Please enter the text you want to format.\nIt will be appended to the end of the document.'
    var notSavedYet = 'Unsaved changes will be lost.\nReally continue?'
    var DOKU_BASE   = '/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="lib/scripts/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/plugins/plugin/style.css" />

  <link rel="shortcut icon" href="lib/images/favicon.ico" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/layout.css" />
  <link rel="stylesheet" media="screen" type="text/css" href="lib/tpl/default/design.css" />

  
  <link rel="stylesheet" media="print" type="text/css" href="lib/tpl/default/print.css" />

  <!--[if gte IE 5]>
  <style type="text/css">
    /* that IE 5+ conditional comment makes this only visible in IE 5+ */
    /* IE bugfix for transparent PNGs */
    //DISABLED   img { behavior: url("/lib/scripts/pngbehavior.htc"); }
  </style>
  <![endif]-->

  </head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="doku.php%3Fid=meetings:minutes_feb_21_2007&amp;do=backlink.html" onclick="return svchk()" onkeypress="return svchk()">meetings:minutes_feb_21_2007</a>]]
      </div>
      <div class="logo">
        <a href="doku.php%3Fid=.html" onclick="return svchk()" onkeypress="return svchk()" name="top" accesskey="h" title="[ALT+H]">ES Wiki</a>      </div>
    </div>
  
    
    <div class="bar" id="bar_top">
      <div class="bar-left" id="bar_topleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="meetings:minutes_feb_21_2007" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="meetings:minutes_feb_21_2007" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
  
      <div class="bar-right" id="bar_topright">
        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="recent" /><input type="hidden" name="id" value="" /><input type="submit" value="Recent changes" class="button" title="ALT+R" accesskey="r" /></form>        <form action="doku.php%3Fid=.html" accept-charset="utf-8" class="search" name="search" onsubmit="return svchk()"><input type="hidden" name="do" value="search" /><input type="text" id="qsearch_in" accesskey="f" name="id" class="edit" onkeyup="ajax_qsearch.call('qsearch_in','qsearch_out')" /><input type="submit" value="Search" class="button" /><div id="qsearch_out" class="ajax_qsearch" onclick="this.style.display='none'"></div></form>&nbsp;
      </div>
    </div>

        <div class="breadcrumbs">
      Trace: <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_mar_21_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_mar_21_2007">minutes_mar_21_2007</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_mar_13_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_mar_13_2007">minutes_mar_13_2007</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_mar_06_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_mar_06_2007">minutes_mar_06_2007</a> <span class="bcsep">&raquo;</span> <a href="doku.php%3Fid=meetings:minutes_feb_27_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_feb_27_2007">minutes_feb_27_2007</a> <span class="bcsep">&raquo;</span> <span class="curid"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="meetings:minutes_feb_21_2007">minutes_feb_21_2007</a></span>          </div>
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script>Table of Contents</div>
<div id="tocinside">
<ul class="toc">
<li class="clear"><ul class="toc">
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#location" class="toc">Location</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#times" class="toc">Times</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#attendees" class="toc">Attendees</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#agenda" class="toc">Agenda</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#reference_implementation" class="toc">Reference Implementation</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#function_types_with_initializers" class="toc">Function types with initializers</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#parameterized_typedefs" class="toc">Parameterized typedefs</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#primitives_yet_again" class="toc">Primitives, Yet Again</a></span></li>
<li class="level2"><span class="li"><a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#alpha-renaming" class="toc">Alpha-renaming</a></span></li>
</ul>
</li>
</ul>
</div>
</div>

<a name="location"></a><h2>Location</h2>
<div class="level2">

<p>
 Adobe San Francisco and Newton offices
</p>

</div>

<a name="times"></a><h2>Times</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Feb. 21: 10pm-5pm PDT</div>
</li>
<li class="level1"><div class="li"> Feb. 22: 10pm-5pm PDT</div>
</li>
<li class="level1"><div class="li"> Feb. 23: 10am-5pm PDT</div>
</li>
</ul>

</div>

<a name="attendees"></a><h2>Attendees</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Francis Cheng, Adobe</div>
</li>
<li class="level1"><div class="li"> Jeff Dyer, Adobe</div>
</li>
<li class="level1"><div class="li"> Dan Smith, Adobe</div>
</li>
<li class="level1"><div class="li"> Pratap Lakshman, Microsoft</div>
</li>
<li class="level1"><div class="li"> Brendan Eich, Mozilla</div>
</li>
<li class="level1"><div class="li"> Brian Crowder, Mozilla</div>
</li>
<li class="level1"><div class="li"> Graydon Hoare, Mozilla</div>
</li>
<li class="level1"><div class="li"> Dave Herman, Northeastern</div>
</li>
<li class="level1"><div class="li"> Douglas Crockford, Yahoo!</div>
</li>
<li class="level1"><div class="li"> Cormac Flanagan, UCSC</div>
</li>
</ul>

</div>

<a name="agenda"></a><h2>Agenda</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> Pratap&rsquo;s <a href="doku.php%3Fid=discussion:browser_profile.html" class="wikilink1" title="discussion:browser_profile" onclick="return svchk()" onkeypress="return svchk()">Browser Profile</a> proposal.</div>
</li>
<li class="level1"><div class="li"> Outstanding items from past meetings and phone conferences.</div>
<ul>
<li class="level2"><div class="li"> The late-breaking <a href="doku.php%3Fid=proposals:enumeration_type.html" class="wikilink1" title="proposals:enumeration_type" onclick="return svchk()" onkeypress="return svchk()">enum</a> proposal.</div>
</li>
<li class="level2"><div class="li"> The <code>&amp;&amp;=</code> and <code>||=</code> operators need to be included in the spec.</div>
</li>
<li class="level2"><div class="li"> We should re-export the wiki this week, or by the weekend.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Don&rsquo;t forget these issues raised during discussion:</div>
<ul>
<li class="level2"><div class="li"> Should package initialization be atomic, in the sense that a throw from package code rolls back all effects?</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Reference implementation work.</div>
<ul>
<li class="level2"><div class="li"> How do we express types in the verifier / evaluator</div>
</li>
<li class="level2"><div class="li"> Resolved: <code>function to C!(v) {...}</code> is allowed in nullable class <code>C</code>, and return type annotation on <code>function to</code> declarations are not allowed.</div>
</li>
<li class="level2"><div class="li"> Resolved: type parameters are invariant and you can&rsquo;t do anything with them in generic classes or functions except:</div>
<ul>
<li class="level3"><div class="li"> annotate declarations with them;</div>
</li>
<li class="level3"><div class="li"> reflect them into runtime with <code>(type T)</code>, e.g.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>

<a name="reference_implementation"></a><h2>Reference Implementation</h2>
<div class="level2">

<p>
 Changes to <code>TYPE_EXPR</code>: 
</p>
<ul>
<li class="level1"><div class="li"> <code>NominalType</code> is changed to <code>TypeName</code>, which represents any unresolved type name</div>
</li>
<li class="level1"><div class="li"> <code>FunctionType</code> is now a collection of type expressions rather than having extra irrelevant details</div>
</li>
<li class="level1"><div class="li"> <code>InstanceType</code> is new</div>
<ul>
<li class="level2"><div class="li"> represents class or interface types</div>
</li>
<li class="level2"><div class="li"> possibly parameterized</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <code>TypeName</code>s get resolved into either structural types or <code>InstanceType</code>s</div>
<ul>
<li class="level2"><div class="li"> could potentially be forward references</div>
</li>
<li class="level2"><div class="li"> definition phase can&rsquo;t resolve forward references</div>
</li>
<li class="level2"><div class="li"> so <code>TypeName</code>s are resolved in the verifier</div>
</li>
</ul>
</li>
</ul>

<p>
  &mdash; <em><a href="mailto:%26%23x64%3B%26%23x68%3B%26%23x65%3B%26%23x72%3B%26%23x6d%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x63%3B%26%23x63%3B%26%23x73%3B%26%23x2e%3B%26%23x6e%3B%26%23x65%3B%26%23x75%3B%26%23x2e%3B%26%23x65%3B%26%23x64%3B%26%23x75%3B" class="mail" title="&#x64;&#x68;&#x65;&#x72;&#x6d;&#x61;&#x6e;&#x40;&#x63;&#x63;&#x73;&#x2e;&#x6e;&#x65;&#x75;&#x2e;&#x65;&#x64;&#x75;">Dave Herman</a> 2007/02/22 10:25</em>
</p>

</div>

<a name="function_types_with_initializers"></a><h2>Function types with initializers</h2>
<div class="level2">

<p>
 Function arguments may have default values. So we need a syntax for type expressions to denote this. 
</p>
<ul>
<li class="level1"><div class="li"> Dave&rsquo;s wacky GNU-man-page-inspired idea: <code>function(int [, string, boolean]) : void</code></div>
<ul>
<li class="level2"><div class="li"> blech. one character-transpose and you&rsquo;ve got <code>function(int,[string,boolean]) : void</code></div>
</li>
<li class="level2"><div class="li"> absurd in the base case of all args having default values: <code>function([, int, string, boolean]) : void</code></div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> nullability? no, doesn&rsquo;t work</div>
</li>
<li class="level1"><div class="li"> Brendan&rsquo;s idea: <code>function(int, string= , boolean= ) : void</code></div>
<ul>
<li class="level2"><div class="li"> follows the principle of type syntax reflecting expression syntax</div>
</li>
<li class="level2"><div class="li"> no new special funky Unicode sigils (heh heh heh)</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> allow a placeholder like <code>?</code> or <code>_</code> after the <code>=</code> sign? nah, it&rsquo;s dead wood.</div>
</li>
</ul>

<p>
 Resolved: Brendan&rsquo;s idea is good.
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x64%3B%26%23x68%3B%26%23x65%3B%26%23x72%3B%26%23x6d%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x63%3B%26%23x63%3B%26%23x73%3B%26%23x2e%3B%26%23x6e%3B%26%23x65%3B%26%23x75%3B%26%23x2e%3B%26%23x65%3B%26%23x64%3B%26%23x75%3B" class="mail" title="&#x64;&#x68;&#x65;&#x72;&#x6d;&#x61;&#x6e;&#x40;&#x63;&#x63;&#x73;&#x2e;&#x6e;&#x65;&#x75;&#x2e;&#x65;&#x64;&#x75;">Dave Herman</a> 2007/02/22 15:23</em>
</p>

<p>
Further resolved: function types must not include formal parameter names. We had been thinking of allowing them optionally, for <a href="doku.php%3Fid=proposals:documentation.html" class="wikilink1" title="proposals:documentation" onclick="return svchk()" onkeypress="return svchk()">documentation</a> reasons. And the reference implementation required them, but it will be fixed to forbid them.
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2007/02/22 15:51</em>
</p>

</div>

<a name="parameterized_typedefs"></a><h2>Parameterized typedefs</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> we had said we didn&rsquo;t want to have to close type definitions over their type parameters</div>
</li>
<li class="level1"><div class="li"> but now we can&rsquo;t express the <code>IteratorType</code></div>
</li>
<li class="level1"><div class="li"> we have (roughly) the following type, which is more or less nonsensical:</div>
</li>
</ul>
<pre class="code javascript">type IteratorType = <span class="br0">&#123;</span>
    next: <span class="kw2">function</span>.&lt;T&gt;<span class="br0">&#40;</span><span class="br0">&#41;</span>:T;
<span class="br0">&#125;</span></pre><ul>
<li class="level1"><div class="li"> the type we need is:</div>
</li>
</ul>
<pre class="code javascript">type IteratorType.&lt;T&gt; = <span class="br0">&#123;</span>
    next: <span class="kw2">function</span> <span class="br0">&#40;</span><span class="br0">&#41;</span>:T;
<span class="br0">&#125;</span></pre><ul>
<li class="level1"><div class="li"> but now it appears we can&rsquo;t express this type</div>
</li>
<li class="level1"><div class="li"> Graydon: just go to an interface instead?</div>
<ul>
<li class="level2"><div class="li"> Brendan: long-standing decision to avoid imposing nominal type system on iteration protocol;</div>
</li>
<li class="level2"><div class="li"> Lots of existing ES3 objects can be iterators already, expensive to wrap in <code>class</code> clothing.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Dave: or allow parameterized typedefs?</div>
</li>
<li class="level1"><div class="li"> Dave: or allow parameterized record types?</div>
</li>
<li class="level1"><div class="li"> Brendan: we have function, class, and interface closures &ndash; is the problem with record, array, and union closures due to a difference in kind, or just because we got tired <img src="lib/images/smileys/icon_wink.gif" align="middle" alt=";-)" />?</div>
</li>
</ul>

<p>
  &mdash; <em><a href="mailto:%26%23x64%3B%26%23x68%3B%26%23x65%3B%26%23x72%3B%26%23x6d%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x63%3B%26%23x63%3B%26%23x73%3B%26%23x2e%3B%26%23x6e%3B%26%23x65%3B%26%23x75%3B%26%23x2e%3B%26%23x65%3B%26%23x64%3B%26%23x75%3B" class="mail" title="&#x64;&#x68;&#x65;&#x72;&#x6d;&#x61;&#x6e;&#x40;&#x63;&#x63;&#x73;&#x2e;&#x6e;&#x65;&#x75;&#x2e;&#x65;&#x64;&#x75;">Dave Herman</a> 2007/02/22 16:45</em>
</p>

</div>

<a name="primitives_yet_again"></a><h2>Primitives, Yet Again</h2>
<div class="level2">
<ul>
<li class="level1"><div class="li"> See <a href="doku.php%3Fid=meetings:minutes_jan_24_2007.html#primitive_types_day_2" class="wikilink1" title="meetings:minutes_jan_24_2007" onclick="return svchk()" onkeypress="return svchk()">primitive_types_day_2</a>, the updates from Brendan.</div>
</li>
<li class="level1"><div class="li"> Due to web script extending <code>String.prototype</code> and expecting the added methods to work on primitive strings, we probably want <code>string &lt;: String</code>. Can it work?</div>
</li>
<li class="level1"><div class="li"> Same for <code>boolean &lt;: Boolean</code>.</div>
</li>
<li class="level1"><div class="li"> For <code>Number.prototype</code> extensions, we have problems: <code>0, 1, ... 42, ...</code> are all <code>int</code>, so <code>(42).myNewNumberProtoMethod()</code> won&rsquo;t work as before (but the other way of writing it, <code>42..myNewNumberProtoMethod()</code>, will). <acronym title="If I remember correctly">IIRC</acronym> we agreed that the numeric types are not related, they are all direct subclasses of <code>Object</code>. But what breaks if we make <code>{int, uint, double, decimal} &lt;: Number</code>?</div>
</li>
<li class="level1"><div class="li"> Subtyping isn&rsquo;t right anyway, unless we make the lowercase-named class hide its methods in <code>intrinsic</code></div>
<ul>
<li class="level2"><div class="li"> so that unqualified method calls go up to the capitalized-name class&rsquo;s <code>prototype</code>;</div>
</li>
<li class="level2"><div class="li"> in which case we still have incompatibility due to lack of &ldquo;wrapping&rdquo;: <code>let s = &ldquo;&ldquo;; s.foo = 42; assert(s.foo === undefined)</code>;</div>
</li>
<li class="level2"><div class="li"> but this may be a compatibility constraint we can keep, as Jeff suggested, via catchalls.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> On reflection, the &ldquo;Day 1&rdquo; <a href="doku.php%3Fid=meetings:minutes_jan_24_2007.html" class="wikilink1" title="meetings:minutes_jan_24_2007" onclick="return svchk()" onkeypress="return svchk()">minutes_jan_24_2007</a> proposal to unify <code>string</code> into <code>String</code>, likewise for <code>Boolean</code>, looks better again.</div>
<ul>
<li class="level2"><div class="li"> It does require optimizations at least as involved as today&rsquo;s ES3 implementations have to do to avoid doing <code>new String(&rdquo;&ldquo;)</code> for every <code>&ldquo;&ldquo;</code> literal.</div>
</li>
<li class="level2"><div class="li"> But that&rsquo;s not so bad &ndash; question is, what further optimizations (e.g. such as AS3 does) are &ldquo;hard&rdquo;.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> <code>Number</code> is still a problem, and (without detailed memories) I believe there are use-cases for AOP on <code>Number.prototype</code>.</div>
</li>
<li class="level1"><div class="li"> UPDATE: to be precise, what ES1-3 specify are primitive types that get wrapped by every <code>ToObject</code>, but what &ldquo;Day 1&rdquo; proposed was only ever (the appearance of) a <code>new String</code> instance for every literal or concatenation result.</div>
<ul>
<li class="level2"><div class="li"> Not fully backward compatible as noted above (<code>let s = &ldquo;&ldquo;; s.foo = 42; assert(s.foo === 42)</code> &ndash; unlike ES1-3, it&rsquo;s as if the primitive empty string &ldquo;becomes&rdquo; in the Smalltalk sense a <code>new String</code>).</div>
</li>
<li class="level2"><div class="li"> Suppose we support primitive types via <code>final class string!</code>, etc., and model wrapping as follows:</div>
<ul>
<li class="level3"><div class="li"> <code>class string! extends String</code>.</div>
</li>
<li class="level3"><div class="li"> The fixed methods of the final primitive class are all <code>intrinsic</code>.</div>
</li>
<li class="level3"><div class="li"> Which implies that the standard methods of <code>String</code> are <strong>only</strong> <code>prototype</code>.</div>
</li>
<li class="level3"><div class="li"> Thus we split intrinsic functionality from <code>String</code> and push it down into <code>string</code>.</div>
</li>
<li class="level3"><div class="li"> <code>&ldquo;hi&rdquo;.charAt(0)</code> therefore invokes <code>String.prototype.charAt</code> on the <code>string</code> <code>&ldquo;hi&rdquo;</code>.</div>
</li>
<li class="level3"><div class="li"> If you want speed and not AOP, <code>use namespace intrinsic</code> or call <code>&ldquo;hi&rdquo;.intrinsic::charAt(0)</code> (or in this case, use <a href="doku.php%3Fid=proposals:slice_syntax.html" class="wikilink1" title="proposals:slice_syntax" onclick="return svchk()" onkeypress="return svchk()">indexing</a>).</div>
</li>
<li class="level3"><div class="li"> To support <code>&ldquo;hi&rdquo;.nosuch === undefined</code> and <code>&ldquo;hi&rdquo;.foo = 42</code>, we use Jeff&rsquo;s <a href="doku.php%3Fid=proposals:catchalls.html" class="wikilink1" title="proposals:catchalls" onclick="return svchk()" onkeypress="return svchk()">catchalls</a> suggestion, which simulates ES1-3&rsquo;s wrapping under <code>ToObject</code></div>
</li>
<li class="level3"><div class="li"> Code may freely use <code>string</code> and unless it explicitly uses <code>intrinsic</code>, AOP via <code>String.prototype</code> still works.</div>
</li>
<li class="level3"><div class="li"> And (thanks to the catchalls) generic get-and-test-against-<code>undefined</code> (or equivalent) and useless sets still work.</div>
</li>
</ul>
</li>
<li class="level2"><div class="li"> Please poke holes in this.</div>
</li>
</ul>
</li>
</ul>

<p>
  &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2007/02/23 10:12</em>
</p>

</div>

<a name="alpha-renaming"></a><h2>Alpha-renaming</h2>
<div class="level2">

<p>
 There appear to be places in the language where we can&rsquo;t avoid the need for doing <a href="http://foldoc.org/index.cgi?query=alpha+conversion" class="urlextern" target="_blank" title="http://foldoc.org/index.cgi?query=alpha+conversion" onclick="return svchk()" onkeypress="return svchk()" rel="nofollow">alpha renaming</a>.
</p>

<p>
<strong>Example 1:</strong>
</p>
<pre class="code javascript"><span class="kw2">class</span> C.&lt;T&gt; <span class="br0">&#123;</span>
    type A = T
    <span class="kw2">function</span> f.&lt;T&gt;<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw2">var</span> x : A = ... <span class="co1">// x has outer type T</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre><ul>
<li class="level1"><div class="li"> the verifier needs to associate <code>x</code> with the type of the outer <code>T</code>, so it must rename the inner binding of type parameter <code>T</code> (the type argument of <code>f</code>) to prevent it from capturing the outer <code>T</code></div>
</li>
<li class="level1"><div class="li"> could we forbid nested <code>type</code> declarations?</div>
</li>
<li class="level1"><div class="li"> there are some useful type declarations we then wouldn&rsquo;t be able to express</div>
</li>
<li class="level1"><div class="li"> for example, the <code>type A = T</code> can&rsquo;t be lifted out to top-level, because it refers to the type parameter <code>T</code> which isn&rsquo;t in scope outside the class declaration</div>
</li>
</ul>

<p>
 <strong>Example 2:</strong>
</p>
<pre class="code javascript"><span class="kw2">function</span> f.&lt;T&gt;<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="br0">&#40;</span><span class="kw2">function</span> &lt;U&gt;<span class="br0">&#40;</span><span class="br0">&#41;</span>:<span class="br0">&#91;</span>T,U<span class="br0">&#93;</span> <span class="br0">&#123;</span> ... <span class="br0">&#125;</span><span class="br0">&#41;</span>;
<span class="br0">&#125;</span>
&nbsp;
<span class="kw2">class</span> C.&lt;U&gt; <span class="br0">&#123;</span>
    f.&lt;U&gt;<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="co1">// has type function.&lt;U'&gt;():[U,U']</span>
<span class="br0">&#125;</span></pre><ul>
<li class="level1"><div class="li"> here, the application of f to the type <code>U</code> inside class <code>C</code> requires that we alpha-rename the returned function&rsquo;s type parameter <code>U</code> to prevent it from capturing the other <code>U</code> (the argument to class <code>C</code>)</div>
</li>
</ul>

<p>
 This latter example is especially hard to avoid. No clear restriction that we could impose on the language to prevent it. 
</p>
<ul>
<li class="level1"><div class="li"> Graydon: optimize for parameterize classes; most important use case</div>
</li>
<li class="level1"><div class="li"> Cormac: but without parameterized functions/methods, can&rsquo;t do things like <code>List.map</code></div>
</li>
<li class="level1"><div class="li"> decision between complexity budget vs. unuseful toy implementation of generics</div>
</li>
<li class="level1"><div class="li"> Dave: reflection concern &ndash; let&rsquo;s just prevent uninstantiated parameterized types from being exposed</div>
</li>
<li class="level1"><div class="li"> Brendan: we know how to implement it, generics are vital, let&rsquo;s do it</div>
<ul>
<li class="level2"><div class="li"> Just for the record in detail, I argued that generics types (structural as well as nominal, and not just function types) are vital for retro-fitting and future-proofing via structural compatibility rather than nominal subtyping.  &mdash; <em><a href="mailto:%26%23x62%3B%26%23x72%3B%26%23x65%3B%26%23x6e%3B%26%23x64%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x6f%3B%26%23x72%3B%26%23x67%3B" class="mail" title="&#x62;&#x72;&#x65;&#x6e;&#x64;&#x61;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x6f;&#x72;&#x67;">Brendan Eich</a> 2007/02/23 12:13</em></div>
</li>
</ul>
</li>
</ul>

<p>
 Resolved: alpha-conversion is a must.
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x64%3B%26%23x68%3B%26%23x65%3B%26%23x72%3B%26%23x6d%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x63%3B%26%23x63%3B%26%23x73%3B%26%23x2e%3B%26%23x6e%3B%26%23x65%3B%26%23x75%3B%26%23x2e%3B%26%23x65%3B%26%23x64%3B%26%23x75%3B" class="mail" title="&#x64;&#x68;&#x65;&#x72;&#x6d;&#x61;&#x6e;&#x40;&#x63;&#x63;&#x73;&#x2e;&#x6e;&#x65;&#x75;&#x2e;&#x65;&#x64;&#x75;">Dave Herman</a> 2007/02/23 11:37</em>
</p>

<p>
Another example:
</p>

<p>
<strong>Example 3:</strong>
</p>
<pre class="code javascript">type A.&lt;X&gt; = <span class="kw2">function</span>.&lt;T&gt;<span class="br0">&#40;</span><span class="br0">&#41;</span>:<span class="br0">&#91;</span>X,T<span class="br0">&#93;</span>
<span class="kw2">class</span> C.&lt;T&gt; <span class="br0">&#123;</span>
   <span class="kw2">var</span> a : A.&lt;T&gt; = ... <span class="co1">// should be function.&lt;T'&gt;:[T,T']</span>
<span class="br0">&#125;</span></pre>
<p>
Dave notes that example 1 is an example of what&rsquo;s known in the hygienic macro community as &ldquo;referential transparency&rdquo; (an unfortunate choice of terminology, not unrelated to the general concept but not exactly the same thing, either), and example 3 is an example of the &ldquo;hygiene condition&rdquo;.
</p>

<p>
 &mdash; <em><a href="mailto:%26%23x64%3B%26%23x68%3B%26%23x65%3B%26%23x72%3B%26%23x6d%3B%26%23x61%3B%26%23x6e%3B%26%23x40%3B%26%23x63%3B%26%23x63%3B%26%23x73%3B%26%23x2e%3B%26%23x6e%3B%26%23x65%3B%26%23x75%3B%26%23x2e%3B%26%23x65%3B%26%23x64%3B%26%23x75%3B" class="mail" title="&#x64;&#x68;&#x65;&#x72;&#x6d;&#x61;&#x6e;&#x40;&#x63;&#x63;&#x73;&#x2e;&#x6e;&#x65;&#x75;&#x2e;&#x65;&#x64;&#x75;">Dave Herman</a> 2007/02/25 04:58</em>
</p>

<p>
Further resolved: adopt the &ldquo;more general and composable&rdquo; form of type parameters: a &lsquo;TyLam([&rdquo;X&rdquo;], tyexpr)&rsquo; constructor for type expressions that generally represents parametric types.
</p>

<p>
Fallout:
</p>
<ul>
<li class="level1"><div class="li"> Parametric function, class and interface closures lose their type-parameter list and &ldquo;isApplied&rdquo; flags</div>
</li>
<li class="level1"><div class="li"> They gain, instead, a &lsquo;type&rsquo; field that begins with &lsquo;TyLam&rsquo;</div>
</li>
<li class="level1"><div class="li"> As before, operator &lsquo;new&rsquo; refuses to work on a class closure with a &lsquo;TyLam&rsquo; in its type.</div>
</li>
<li class="level1"><div class="li"> As before, function-call refuses to work on a function closure with a &lsquo;TyLam&rsquo; in its type.</div>
</li>
<li class="level1"><div class="li"> The &lsquo;type-apply&rsquo; operator &lsquo;.&lt;tyExpr&gt;&rsquo; at runtime strips one level of &lsquo;TyLam&rsquo; off its operand (closure) and returns a new closure with the stripped type and a new &lsquo;TypeFixture&rsquo; binding in the closure.</div>
</li>
<li class="level1"><div class="li"> All type definitions can be parametric. If you say &lsquo;type T.&lt;X&gt; = Z.&lt;X&gt;&rsquo; you have produced binding for &lsquo;T&rsquo; with type &lsquo;TyLam ([&rdquo;X&rdquo;], TyApp(TyName(&rdquo;Z&rdquo;), TyName(&rdquo;X&rdquo;)))&rsquo;</div>
</li>
<li class="level1"><div class="li"> The verifier will have to alpha-rename type terms in order to compare them.</div>
</li>
<li class="level1"><div class="li"> The interface between the evaluator and verifier will need to provide type environments for any type-compatibility questions it wants answered.</div>
</li>
</ul>

<p>
 Some further concern was raised about the visibility of types defined <em>inside</em> classes. The consensus view of this is the following: 
</p>
<ul>
<li class="level1"><div class="li"> Types defined inside classes cannot be seen outside classes. There is no &lsquo;TyMember&rsquo; constructor for type expressions. &lsquo;C.T&rsquo; is not meaningful when &lsquo;T&rsquo; is a type.</div>
</li>
<li class="level1"><div class="li"> Types defined inside classes may refer to type parameters of the class, but all types defined inside classes are <em>invisible</em> to static initialization code for the class. If you want a type to be visible to static initialization code, you must move the type out of the class.</div>
</li>
</ul>

<p>
  &mdash; <em><a href="mailto:%26%23x67%3B%26%23x72%3B%26%23x61%3B%26%23x79%3B%26%23x64%3B%26%23x6f%3B%26%23x6e%3B%26%23x40%3B%26%23x6d%3B%26%23x6f%3B%26%23x7a%3B%26%23x69%3B%26%23x6c%3B%26%23x6c%3B%26%23x61%3B%26%23x2e%3B%26%23x63%3B%26%23x6f%3B%26%23x6d%3B" class="mail" title="&#x67;&#x72;&#x61;&#x79;&#x64;&#x6f;&#x6e;&#x40;&#x6d;&#x6f;&#x7a;&#x69;&#x6c;&#x6c;&#x61;&#x2e;&#x63;&#x6f;&#x6d;">graydon</a> 2007/02/23 14:23</em> 
</p>

</div>

<!-- no cachefile used, but created -->
    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
              </div>
      <div class="doc">
        meetings/minutes_feb_21_2007.txt &middot; Last modified: 2007/03/13 21:44 by graydon      </div>
    </div>

   
    <div class="bar" id="bar_bottom">
      <div class="bar-left" id="bar_bottomleft">
        <form class="button" method="post" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="edit" /><input type="hidden" name="rev" value="" /><input type="hidden" name="id" value="meetings:minutes_feb_21_2007" /><input type="submit" value="Show pagesource" class="button" title="ALT+V" accesskey="v" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="revisions" /><input type="hidden" name="id" value="meetings:minutes_feb_21_2007" /><input type="submit" value="Old revisions" class="button" title="ALT+O" accesskey="o" /></form>      </div>
      <div class="bar-right" id="bar_bottomright">
                        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="login" /><input type="hidden" name="id" value="meetings:minutes_feb_21_2007" /><input type="submit" value="Login" class="button" /></form>        <form class="button" method="get" action="index.html" onsubmit="return svchk()"><input type="hidden" name="do" value="index" /><input type="hidden" name="id" value="meetings:minutes_feb_21_2007" /><input type="submit" value="Index" class="button" title="ALT+X" accesskey="x" /></form>        <a href="doku.php%3Fid=meetings:minutes_feb_21_2007.html#top"><input type="button" class="button" value="Back to top" onclick="window.scrollTo(0, 0)" /></a>&nbsp;
      </div>
    </div>

  </div>

</div>

<div align="center" class="footerinc">
  <a target="_blank" href="feed.php" title="Recent changes RSS feed"><img src="lib/tpl/default/images/button-rss.png" width="80" height="15" alt="Recent changes RSS feed" border="0" /></a>

  <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="license" title="Creative Commons License"><img src="lib/tpl/default/images/button-cc.gif" width="80" height="15" alt="Creative Commons License" border="0" /></a>

  <a target="_blank" href="https://www.paypal.com/xclick/business=andi%40splitbrain.org&amp;item_name=DokuWiki+Donation&amp;no_shipping=1&amp;no_note=1&amp;tax=0&amp;currency_code=EUR&amp;lc=US" title="Donate"><img src="lib/tpl/default/images/button-donate.gif" alt="Donate" border="0" /></a>

  <a target="_blank" href="http://www.php.net" title="Powered by PHP"><img src="lib/tpl/default/images/button-php.gif" width="80" height="15" alt="Powered by PHP" border="0" /></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="lib/tpl/default/images/button-xhtml.png" width="80" height="15" alt="Valid XHTML 1.0" border="0" /></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="lib/tpl/default/images/button-css.png" width="80" height="15" alt="Valid CSS" border="0" /></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="lib/tpl/default/images/button-dw.png" width="80" height="15" alt="Driven by DokuWiki" border="0" /></a>



<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->
</div>

<img src="lib/exe/indexer.php%3Fid=meetings%253Aminutes_feb_21_2007&amp;1454275526" width="1" height="1" alt=""  /></body>
</html>
